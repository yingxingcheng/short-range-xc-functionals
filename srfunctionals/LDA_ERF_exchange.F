C SOURCES:
C    Simone Paziani, Saverio Moroni, Paola Gori-Giorgi, and Giovanni B. Bachelet.
C    Local-spin-densityfunctional for multideterminant density functional theory.
C    Physical Review B, 73(15), apr 2006.



C*****************************************************************************
      pure subroutine ESRX_LDA_ERF_case_1(rho, mu, Ea)
C*****************************************************************************
C   Implemented by YingXing Cheng.
C
C   Subroutine generated using Sympy 1.4
C   Generated: January 16, 2022
C*****************************************************************************
      implicit none
      real*8, intent(in) :: rho, mu
      real*8, intent(out) :: Ea
      Ea = 0.0d0
      Ea = -0.738558766382022d0*rho**0.333333333333333d0
      end subroutine


C*****************************************************************************
      pure subroutine ESRX_LDA_ERF_case_2(rho, mu, Ea)
C*****************************************************************************
C   Implemented by YingXing Cheng.
C
C   Subroutine generated using Sympy 1.4
C   Generated: January 16, 2022
C*****************************************************************************
      implicit none
      real*8, intent(in) :: rho, mu
      real*8, intent(out) :: Ea
      real*8 :: x0, x1, x2, x3, x4, x5
      Ea = 0.0d0
      x0 = rho**0.333333333333333d0
      x1 = 2.14502939711103d0
      x2 = 1/(x0*x1)
      x3 = mu*x2
      x4 = 0.0168868639403896d0*1d0/rho
      x5 = mu**2
      Ea = 1.96949004368539d0*x0*(0.346680637175317d0*x3*(mu**3*x4 - mu*
     &( -0.693361274350635d0*x2 + x4*x5)*exp(-9.5707800006273031d0*rho**
     & 0.66666666666666663d0/x5) - 1.04004191152595d0*x3 + 1.77245385090
     &552d0*erf(1.4422495703074083d0*x0*x1/mu)) - 0.375d0)
      end subroutine


C*****************************************************************************
      pure subroutine ESRX_LDA_ERF_case_3(rho, mu, Ea)
C*****************************************************************************
C   Implemented by YingXing Cheng.
C
C   Subroutine generated using Sympy 1.4
C   Generated: January 16, 2022
C*****************************************************************************
      implicit none
      real*8, intent(in) :: rho, mu
      real*8, intent(out) :: Ea
      Ea = 0.0d0
      Ea = -0.785398163397448d0*rho**1.0d0/mu**2
      end subroutine


C*****************************************************************************
      pure subroutine D1ESRX_LDA_ERF_case_1(rho, mu, Ea, d1Ea)
C*****************************************************************************
C   Implemented by YingXing Cheng.
C
C   Subroutine generated using Sympy 1.4
C   Generated: January 16, 2022
C*****************************************************************************
      implicit none
      real*8, intent(in) :: rho, mu
      real*8, intent(out) :: Ea, d1Ea(4)
      real*8 :: x0
      Ea = 0.0d0
      d1Ea(:) = 0.0d0
      x0 = 0.682784063255296d0
      Ea = -1.08168717773056d0*rho**0.333333333333333d0*x0
      d1Ea(1) = -1.44224957030741d0*rho**0.333333333333333d0*x0
      end subroutine


C*****************************************************************************
      pure subroutine D1ESRX_LDA_ERF_case_2(rho, mu, Ea, d1Ea)
C*****************************************************************************
C   Implemented by YingXing Cheng.
C
C   Subroutine generated using Sympy 1.4
C   Generated: January 16, 2022
C*****************************************************************************
      implicit none
      real*8, intent(in) :: rho, mu
      real*8, intent(out) :: Ea, d1Ea(4)
      real*8 :: x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x
     &13, x14, x15, x16, x17, x18, x19, x20, x21, x22, x23, x24, x25, x2
     &6
      Ea = 0.0d0
      d1Ea(:) = 0.0d0
      x0 = 0.682784063255296d0
      x1 = rho**0.333333333333333d0
      x2 = 2.14502939711103d0
      x3 = 1d0/x2
      x4 = 1d0/x1
      x5 = x3*x4
      x6 = 0.693361274350635d0*x5
      x7 = mu**2
      x8 = 0.0168868639403896d0
      x9 = 1d0/rho*x8
      x10 = x7*x9
      x11 = x10 - x6
      x12 = 4.60115111447049d0
      x13 = rho**0.666666666666667d0*x12/x7
      x14 = exp(-2.0800838230519036d0*x13)
      x15 = mu*x14
      x16 = 1d0/mu
      x17 = x16*x2
      x18 = mu**3
      x19 = mu*x5
      x20 = x18*x9 - 1.04004191152595d0*x19 + 1.77245385090552d0*erf( 1.
     &4422495703074083d0*x1*x17)
      x21 = -x11*x15 + x20
      x22 = 0.346680637175317d0*x19
      x23 = rho**1.33333333333333d0
      x24 = 1d0/x23
      x25 = x24*x3
      x26 = rho**(-2.0d0)*x8
      Ea = 2.88449914061482d0*x0*x1*(x21*x22 - 0.375d0)
      d1Ea(1) = -0.918164593146344d0*mu*x23*(0.115560212391772d0*x21*x24
     & - 0.346680637175317d0*x4*(0.346680637175317d0*mu*x25 + 0.96149971
     &3538272d0*rho**(-0.666666666666667d0)*x17*exp( -2.0800838230519041
     &d0*x13) + 1.38672254870127d0*rho**( -0.333333333333333d0)*x11*x12*
     &x14*x16 + x15*(-0.231120424783545d0 *x25 + x26*x7) - x18*x26)) + 3
     &.84599885415309d0*rho** 0.333333333333333d0*x0*(x22*(x15*(-x10 + x
     &6) + x20) - 0.375d0)
      end subroutine


C*****************************************************************************
      pure subroutine D1ESRX_LDA_ERF_case_3(rho, mu, Ea, d1Ea)
C*****************************************************************************
C   Implemented by YingXing Cheng.
C
C   Subroutine generated using Sympy 1.4
C   Generated: January 16, 2022
C*****************************************************************************
      implicit none
      real*8, intent(in) :: rho, mu
      real*8, intent(out) :: Ea, d1Ea(4)
      real*8 :: x0
      Ea = 0.0d0
      d1Ea(:) = 0.0d0
      x0 = 3.14159265358979d0*rho**1.0d0/mu**2
      Ea = -0.25d0*x0
      d1Ea(1) = -0.5d0*x0
      end subroutine


C*****************************************************************************
      pure subroutine D2ESRX_LDA_ERF_case_1(rho, mu, Ea, d1Ea, d2Ea)
C*****************************************************************************
C   Implemented by YingXing Cheng.
C
C   Subroutine generated using Sympy 1.4
C   Generated: January 16, 2022
C*****************************************************************************
      implicit none
      real*8, intent(in) :: rho, mu
      real*8, intent(out) :: Ea, d1Ea(4), d2Ea(10)
      real*8 :: x0
      Ea = 0.0d0
      d1Ea(:) = 0.0d0
      d2Ea(:) = 0.0d0
      x0 = 0.682784063255296d0
      Ea = -1.08168717773056d0*rho**0.333333333333333d0*x0
      d1Ea(1) = -1.44224957030741d0*rho**0.333333333333333d0*x0
      d2Ea(1) = -0.480749856769136d0*rho**(-0.666666666666667d0)*x0
      end subroutine


C*****************************************************************************
      pure subroutine D2ESRX_LDA_ERF_case_2(rho, mu, Ea, d1Ea, d2Ea)
C*****************************************************************************
C   Implemented by YingXing Cheng.
C
C   Subroutine generated using Sympy 1.4
C   Generated: January 16, 2022
C*****************************************************************************
      implicit none
      real*8, intent(in) :: rho, mu
      real*8, intent(out) :: Ea, d1Ea(4), d2Ea(10)
      real*8 :: x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x
     &13, x14, x15, x16, x17, x18, x19, x20, x21, x22, x23, x24, x25, x2
     &6, x27, x28, x29, x30, x31, x32, x33, x34, x35, x36, x37, x38, x39
     &, x40, x41, x42, x43, x44, x45, x46, x47, x48, x49
      Ea = 0.0d0
      d1Ea(:) = 0.0d0
      d2Ea(:) = 0.0d0
      x0 = 0.682784063255296d0
      x1 = rho**0.333333333333333d0
      x2 = 2.14502939711103d0
      x3 = 1d0/x2
      x4 = 1d0/x1
      x5 = x3*x4
      x6 = 0.693361274350635d0*x5
      x7 = mu**2
      x8 = 1d0/rho
      x9 = 9.86960440108936d0
      x10 = 1d0/x9
      x11 = 0.166666666666667d0*x10
      x12 = x11*x8
      x13 = x12*x7
      x14 = x13 - x6
      x15 = 4.60115111447049d0
      x16 = rho**0.666666666666667d0*x15/x7
      x17 = exp(-2.0800838230519036d0*x16)
      x18 = mu*x17
      x19 = 1d0/mu
      x20 = x19*x2
      x21 = mu**3
      x22 = mu*x5
      x23 = x12*x21 - 1.04004191152595d0*x22 + 1.77245385090552d0*erf( 1
     &.4422495703074083d0*x1*x20)
      x24 = -x14*x18 + x23
      x25 = 0.346680637175317d0*x22
      x26 = rho**0.333333333333333d0
      x27 = -x13 + x6
      x28 = x18*x27 + x23
      x29 = x0*(x25*x28 - 0.375d0)
      x30 = 0.318309886183791d0
      x31 = rho**1.33333333333333d0
      x32 = 1d0/x31
      x33 = x15*x17*x19
      x34 = rho**(-0.333333333333333d0)*x33
      x35 = 1.38672254870127d0*x34
      x36 = 0.231120424783545d0*x32
      x37 = rho**(-2.0d0)*x11
      x38 = -x3*x36 + x37*x7
      x39 = rho**(-0.666666666666667d0)
      x40 = exp(-2.0800838230519041d0*x16)
      x41 = x20*x40
      x42 = 0.346680637175317d0*mu*x3*x32 + x18*x38 - x21*x37 + 0.961499
     &713538272d0* x39*x41
      x43 = 0.346680637175317d0*x4
      x44 = mu*x30*(0.115560212391772d0*x24*x32 - x43*(x14*x35 + x42))
      x45 = 2.88449914061482d0*x31
      x46 = rho**(-2.33333333333333d0)
      x47 = x3*x46
      x48 = 0.333333333333333d0*rho**(-3.0d0)*x10
      x49 = 1d0/x21
      Ea = 2.88449914061482d0*x0*x1*(x24*x25 - 0.375d0)
      d1Ea(1) = 3.84599885415309d0*x26*x29 - x44*x45
      d2Ea(1) = mu*x30*x45*(0.15408028318903d0*x28*x46 - x36*(-x27*x35 +
     & x42) + x43*( -0.46224084956709d0*mu*x47 - 0.640999809025515d0*rho
     &**( -1.66666666666667d0)*x41 + 0.46224084956709d0*rho**( -1.333333
     &33333333d0)*x27*x33 + 40.7110354757367d0*x17*x27*x39*x49 + x18*(0.
     &30816056637806d0*x47 - x48*x7) + x21*x48 - 2.77344509740254d0*x34*
     &x38 - 1.33333333333333d0*x40*x49*x8*x9)) - 7.69199770830618d0*x26*
     &x44 + 1.28199961805103d0*x29*x39
      end subroutine


C*****************************************************************************
      pure subroutine D2ESRX_LDA_ERF_case_3(rho, mu, Ea, d1Ea, d2Ea)
C*****************************************************************************
C   Implemented by YingXing Cheng.
C
C   Subroutine generated using Sympy 1.4
C   Generated: January 16, 2022
C*****************************************************************************
      implicit none
      real*8, intent(in) :: rho, mu
      real*8, intent(out) :: Ea, d1Ea(4), d2Ea(10)
      real*8 :: x0, x1, x2
      Ea = 0.0d0
      d1Ea(:) = 0.0d0
      d2Ea(:) = 0.0d0
      x0 = rho**1.0d0
      x1 = 3.14159265358979d0/mu**2
      x2 = 0.5d0*x1
      Ea = -0.25d0*x0*x1
      d1Ea(1) = -x0*x2
      d2Ea(1) = -x2
      end subroutine


C*****************************************************************************
      pure subroutine ESRX_SPIN_LDA_ERF_case_1(rho_a, rho_b, mu, E)
C*****************************************************************************
C   Implemented by YingXing Cheng.
C
C   Subroutine generated using Sympy 1.4
C   Generated: January 16, 2022
C*****************************************************************************
      implicit none
      real*8, intent(in) :: rho_a, rho_b, mu
      real*8, intent(out) :: E
      E = 0.0d0
      E = -0.9305257363491d0*(rho_a**1.33333333333333d0 + rho_b** 1.3333
     &3333333333d0)/(rho_a + rho_b)
      end subroutine


C*****************************************************************************
      pure subroutine ESRX_SPIN_LDA_ERF_case_2(rho_a, rho_b, mu, E)
C*****************************************************************************
C   Implemented by YingXing Cheng.
C
C   Subroutine generated using Sympy 1.4
C   Generated: January 16, 2022
C*****************************************************************************
      implicit none
      real*8, intent(in) :: rho_a, rho_b, mu
      real*8, intent(out) :: E
      real*8 :: x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x
     &13, x14, x15, x16, x17
      E = 0.0d0
      x0 = rho_a**0.333333333333333d0
      x1 = 1d0/x0
      x2 = 2.14502939711103d0
      x3 = 1d0/x2
      x4 = mu*x3
      x5 = 0.825481812223657d0*x4
      x6 = mu**3
      x7 = 0.00844343197019481d0
      x8 = 1d0/rho_a*x7
      x9 = 1.77245385090552d0
      x10 = 1.81712059283214d0*x2/mu
      x11 = mu**2
      x12 = 15.192666241152d0/x11
      x13 = 0.550321208149104d0*x3
      x14 = 0.275160604074552d0*x4
      x15 = rho_b**0.333333333333333d0
      x16 = 1d0/x15
      x17 = 1d0/rho_b*x7
      E = 2.4814019635976d0*(rho_a**1.33333333333333d0*(x1*x14*(mu*(x1*x
     &13 - x11* x8)*exp(-rho_a**0.66666666666666663d0*x12) - x1*x5 + x6*
     &x8 + x9* erf(x0*x10)) - 0.375d0) + rho_b**1.33333333333333d0*(x14*
     &x16*(mu* (-x11*x17 + x13*x16)*exp(-rho_b**0.66666666666666663d0*x1
     &2) - x16 *x5 + x17*x6 + x9*erf(x10*x15)) - 0.375d0))/(rho_a + rho_
     &b)
      end subroutine


C*****************************************************************************
      pure subroutine ESRX_SPIN_LDA_ERF_case_3(rho_a, rho_b, mu, E)
C*****************************************************************************
C   Implemented by YingXing Cheng.
C
C   Subroutine generated using Sympy 1.4
C   Generated: January 16, 2022
C*****************************************************************************
      implicit none
      real*8, intent(in) :: rho_a, rho_b, mu
      real*8, intent(out) :: E
      E = 0.0d0
      E = -1.5707963267949d0*(rho_a**2.0d0 + rho_b**2.0d0)/(mu**2*(rho_a
     & + rho_b))
      end subroutine


C*****************************************************************************
      pure subroutine D1ESRX_SPIN_LDA_ERF_case_1(rho_a, rho_b, mu, E, d1
     &E)
C*****************************************************************************
C   Implemented by YingXing Cheng.
C
C   Subroutine generated using Sympy 1.4
C   Generated: January 16, 2022
C*****************************************************************************
      implicit none
      real*8, intent(in) :: rho_a, rho_b, mu
      real*8, intent(out) :: E, d1E(9)
      real*8 :: x0, x1
      E = 0.0d0
      d1E(:) = 0.0d0
      x0 = 0.682784063255296d0
      x1 = 1.81712059283214d0*x0
      E = -1.3628404446241d0*x0*(rho_a**1.33333333333333d0 + rho_b** 1.3
     &3333333333333d0)/(rho_a + rho_b)
      d1E(1) = -rho_a**0.333333333333333d0*x1
      d1E(2) = -rho_b**0.333333333333333d0*x1
      end subroutine


C*****************************************************************************
      pure subroutine D1ESRX_SPIN_LDA_ERF_case_2(rho_a, rho_b, mu, E, d1
     &E)
C*****************************************************************************
C   Implemented by YingXing Cheng.
C
C   Subroutine generated using Sympy 1.4
C   Generated: January 16, 2022
C*****************************************************************************
      implicit none
      real*8, intent(in) :: rho_a, rho_b, mu
      real*8, intent(out) :: E, d1E(9)
      real*8 :: x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x
     &13, x14, x15, x16, x17, x18, x19, x20, x21, x22, x23, x24, x25, x2
     &6, x27, x28, x29, x30, x31, x32, x33, x34, x35, x36, x37, x38, x39
     &, x40, x41, x42, x43, x44, x45, x46, x47, x48
      E = 0.0d0
      d1E(:) = 0.0d0
      x0 = 0.682784063255296d0
      x1 = rho_a**1.33333333333333d0
      x2 = rho_a**0.333333333333333d0
      x3 = 1d0/x2
      x4 = 2.14502939711103d0
      x5 = 1d0/x4
      x6 = 0.550321208149104d0*x5
      x7 = x3*x6
      x8 = mu**2
      x9 = 0.00844343197019481d0
      x10 = 1d0/rho_a*x9
      x11 = x10*x8
      x12 = 4.60115111447049d0
      x13 = 3.30192724889463d0*x12/x8
      x14 = exp(-rho_a**0.66666666666666663d0*x13)
      x15 = mu*x14
      x16 = 1.77245385090552d0
      x17 = 1d0/mu
      x18 = x17*x4
      x19 = 1.81712059283214d0*x18
      x20 = mu**3
      x21 = mu*x5
      x22 = 0.825481812223657d0*x21
      x23 = x10*x20 + x16*erf(x19*x2) - x22*x3
      x24 = 0.275160604074552d0*x3
      x25 = x21*x24*(x15*(-x11 + x7) + x23) - 0.375d0
      x26 = rho_b**1.33333333333333d0
      x27 = rho_b**0.333333333333333d0
      x28 = 1d0/x27
      x29 = x28*x6
      x30 = 1d0/rho_b*x9
      x31 = x30*x8
      x32 = exp(-rho_b**0.66666666666666663d0*x13)
      x33 = mu*x32
      x34 = x16*erf(x19*x27) + x20*x30 - x22*x28
      x35 = 0.275160604074552d0*x28
      x36 = x21*x35*(x33*(x29 - x31) + x34) - 0.375d0
      x37 = 4.84565491421904d0*x0
      x38 = 1d0/x1
      x39 = x11 - x7
      x40 = 0.275160604074552d0*x21
      x41 = rho_a**(-2.0d0)*x9
      x42 = 1.21141372855476d0*x18
      x43 = 0.183440402716368d0*x5
      x44 = 2.20128483259642d0*x12*x17
      x45 = 1.15681489817324d0*mu
      x46 = 1d0/x26
      x47 = -x29 + x31
      x48 = rho_b**(-2.0d0)*x9
      E = 3.63424118566428d0*x0*(x1*x25 + x26*x36)/(rho_a + rho_b)
      d1E(1) = rho_a**0.333333333333333d0*x25*x37 - x1*x45*(-x24*(rho_a*
     &*( -0.666666666666667d0)*x14*x42 + rho_a**(-0.333333333333333d0)*x
     &14 *x39*x44 + x15*(-x38*x43 + x41*x8) - x20*x41 + x38*x40) + 0.091
     &7202013581841d0*x38*(-x15*x39 + x23))
      d1E(2) = rho_b**0.333333333333333d0*x36*x37 - x26*x45*(-x35*(rho_b
     &**( -0.666666666666667d0)*x32*x42 + rho_b**(-0.333333333333333d0)*
     &x32 *x44*x47 - x20*x48 + x33*(-x43*x46 + x48*x8) + x40*x46) + 0.09
     &17202013581841d0*x46*(-x33*x47 + x34))
      end subroutine


C*****************************************************************************
      pure subroutine D1ESRX_SPIN_LDA_ERF_case_3(rho_a, rho_b, mu, E, d1
     &E)
C*****************************************************************************
C   Implemented by YingXing Cheng.
C
C   Subroutine generated using Sympy 1.4
C   Generated: January 16, 2022
C*****************************************************************************
      implicit none
      real*8, intent(in) :: rho_a, rho_b, mu
      real*8, intent(out) :: E, d1E(9)
      real*8 :: x0, x1
      E = 0.0d0
      d1E(:) = 0.0d0
      x0 = 3.14159265358979d0/mu**2
      x1 = 1.0d0*x0
      E = -0.5d0*x0*(rho_a**2.0d0 + rho_b**2.0d0)/(rho_a + rho_b)
      d1E(1) = -rho_a**1.0d0*x1
      d1E(2) = -rho_b**1.0d0*x1
      end subroutine


C*****************************************************************************
      pure subroutine D2ESRX_SPIN_LDA_ERF_case_1(rho_a, rho_b, mu, E, d1
     &E, d2E)
C*****************************************************************************
C   Implemented by YingXing Cheng.
C
C   Subroutine generated using Sympy 1.4
C   Generated: January 16, 2022
C*****************************************************************************
      implicit none
      real*8, intent(in) :: rho_a, rho_b, mu
      real*8, intent(out) :: E, d1E(9), d2E(45)
      real*8 :: x0, x1, x2
      E = 0.0d0
      d1E(:) = 0.0d0
      d2E(:) = 0.0d0
      x0 = 0.682784063255296d0
      x1 = 1.81712059283214d0*x0
      x2 = 0.60570686427738d0*x0
      E = -1.3628404446241d0*x0*(rho_a**1.33333333333333d0 + rho_b** 1.3
     &3333333333333d0)/(rho_a + rho_b)
      d1E(1) = -rho_a**0.333333333333333d0*x1
      d1E(2) = -rho_b**0.333333333333333d0*x1
      d2E(1) = -rho_a**(-0.666666666666667d0)*x2
      d2E(2) = 0
      d2E(3) = -rho_b**(-0.666666666666667d0)*x2
      end subroutine


C*****************************************************************************
      pure subroutine D2ESRX_SPIN_LDA_ERF_case_2(rho_a, rho_b, mu, E, d1
     &E, d2E)
C*****************************************************************************
C   Implemented by YingXing Cheng.
C
C   Subroutine generated using Sympy 1.4
C   Generated: January 16, 2022
C*****************************************************************************
      implicit none
      real*8, intent(in) :: rho_a, rho_b, mu
      real*8, intent(out) :: E, d1E(9), d2E(45)
      real*8 :: x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x
     &13, x14, x15, x16, x17, x18, x19, x20, x21, x22, x23, x24, x25, x2
     &6, x27, x28, x29, x30, x31, x32, x33, x34, x35, x36, x37, x38, x39
     &, x40, x41, x42, x43, x44, x45, x46, x47, x48, x49, x50, x51, x52,
     & x53, x54, x55, x56, x57, x58, x59, x60, x61, x62, x63, x64, x65, 
     &x66, x67, x68, x69, x70, x71, x72, x73, x74, x75, x76, x77, x78, x
     &79, x80, x81, x82, x83, x84, x85, x86, x87, x88, x89, x90, x91
      E = 0.0d0
      d1E(:) = 0.0d0
      d2E(:) = 0.0d0
      x0 = 0.682784063255296d0
      x1 = rho_a**1.33333333333333d0
      x2 = rho_a**0.333333333333333d0
      x3 = 1d0/x2
      x4 = 2.14502939711103d0
      x5 = 1d0/x4
      x6 = 0.550321208149104d0*x5
      x7 = x3*x6
      x8 = mu**2
      x9 = 1d0/rho_a
      x10 = 9.86960440108936d0
      x11 = 1d0/x10
      x12 = 0.0833333333333333d0*x11
      x13 = x12*x9
      x14 = x13*x8
      x15 = -x14 + x7
      x16 = 4.60115111447049d0
      x17 = 3.30192724889463d0*x16/x8
      x18 = exp(-rho_a**0.66666666666666663d0*x17)
      x19 = mu*x18
      x20 = 1.77245385090552d0
      x21 = 1d0/mu
      x22 = x21*x4
      x23 = 1.81712059283214d0*x22
      x24 = mu**3
      x25 = mu*x5
      x26 = 0.825481812223657d0*x25
      x27 = x13*x24 + x20*erf(x2*x23) - x26*x3
      x28 = x15*x19 + x27
      x29 = 0.275160604074552d0*x3
      x30 = x25*x28*x29 - 0.375d0
      x31 = rho_b**1.33333333333333d0
      x32 = rho_b**0.333333333333333d0
      x33 = 1d0/x32
      x34 = x33*x6
      x35 = 1d0/rho_b
      x36 = x12*x35
      x37 = x36*x8
      x38 = x34 - x37
      x39 = exp(-rho_b**0.66666666666666663d0*x17)
      x40 = mu*x39
      x41 = x20*erf(x23*x32) + x24*x36 - x26*x33
      x42 = x38*x40 + x41
      x43 = 0.275160604074552d0*x33
      x44 = x25*x42*x43 - 0.375d0
      x45 = rho_a**0.333333333333333d0
      x46 = 4.84565491421904d0*x0
      x47 = 1d0/x1
      x48 = x14 - x7
      x49 = x16*x21
      x50 = 2.20128483259642d0*x49
      x51 = rho_a**(-0.333333333333333d0)*x18
      x52 = x50*x51
      x53 = 0.183440402716368d0*x5
      x54 = rho_a**(-2.0d0)*x12
      x55 = -x47*x53 + x54*x8
      x56 = 0.275160604074552d0*x25
      x57 = 1.21141372855476d0*x22
      x58 = rho_a**(-0.666666666666667d0)
      x59 = x18*x58
      x60 = x19*x55 - x24*x54 + x47*x56 + x57*x59
      x61 = -x29*(x48*x52 + x60) + 0.0917202013581841d0*x47*(-x19*x48 + 
     &x27)
      x62 = 0.318309886183791d0*mu
      x63 = 3.63424118566428d0*x62
      x64 = x1*x63
      x65 = rho_b**0.333333333333333d0
      x66 = 1d0/x31
      x67 = -x34 + x37
      x68 = rho_b**(-0.333333333333333d0)*x39
      x69 = x50*x68
      x70 = rho_b**(-2.0d0)*x12
      x71 = -x53*x66 + x70*x8
      x72 = rho_b**(-0.666666666666667d0)
      x73 = x39*x72
      x74 = -x24*x70 + x40*x71 + x56*x66 + x57*x73
      x75 = -x43*(x67*x69 + x74) + 0.0917202013581841d0*x66*(-x40*x67 + 
     &x41)
      x76 = x31*x63
      x77 = 1.61521830473968d0*x0
      x78 = 9.69130982843808d0*x62
      x79 = rho_a**(-2.33333333333333d0)
      x80 = 0.366880805432736d0*x25
      x81 = 0.166666666666667d0*x11
      x82 = rho_a**(-3.0d0)*x81
      x83 = 0.80760915236984d0*x22
      x84 = 1d0/x24
      x85 = 2.66666666666667d0*x10*x84
      x86 = 0.244587203621824d0*x5
      x87 = 0.733761610865473d0*x49
      x88 = 4.40256966519284d0*x49
      x89 = 102.585381117795d0*x84
      x90 = rho_b**(-2.33333333333333d0)
      x91 = rho_b**(-3.0d0)*x81
      E = 3.63424118566428d0*x0*(x1*x30 + x31*x44)/(rho_a + rho_b)
      d1E(1) = x30*x45*x46 - x61*x64
      d1E(2) = x44*x46*x65 - x75*x76
      d2E(1) = x30*x58*x77 - x45*x61*x78 + x64*(0.122293601810912d0*x28*
     &x79 + x29*( -rho_a**(-1.66666666666667d0)*x18*x83 + rho_a**( -1.33
     &333333333333d0)*x15*x18*x87 + x15*x59*x89 - x18*x85*x9 + x19 *(x79
     &*x86 - x8*x82) + x24*x82 - x51*x55*x88 - x79*x80) - 0.183440402716
     &368d0*x47*(-x15*x52 + x60))
      d2E(2) = 0
      d2E(3) = x44*x72*x77 - x65*x75*x78 + x76*(0.122293601810912d0*x42*
     &x90 + x43*( -rho_b**(-1.66666666666667d0)*x39*x83 + rho_b**( -1.33
     &333333333333d0)*x38*x39*x87 + x24*x91 - x35*x39*x85 + x38* x73*x89
     & + x40*(-x8*x91 + x86*x90) - x68*x71*x88 - x80*x90) - 0.1834404027
     &16368d0*x66*(-x38*x69 + x74))
      end subroutine


C*****************************************************************************
      pure subroutine D2ESRX_SPIN_LDA_ERF_case_3(rho_a, rho_b, mu, E, d1
     &E, d2E)
C*****************************************************************************
C   Implemented by YingXing Cheng.
C
C   Subroutine generated using Sympy 1.4
C   Generated: January 16, 2022
C*****************************************************************************
      implicit none
      real*8, intent(in) :: rho_a, rho_b, mu
      real*8, intent(out) :: E, d1E(9), d2E(45)
      real*8 :: x0, x1, x2
      E = 0.0d0
      d1E(:) = 0.0d0
      d2E(:) = 0.0d0
      x0 = 3.14159265358979d0/mu**2
      x1 = 1.0d0*x0
      x2 = -x1
      E = -0.5d0*x0*(rho_a**2.0d0 + rho_b**2.0d0)/(rho_a + rho_b)
      d1E(1) = -rho_a**1.0d0*x1
      d1E(2) = -rho_b**1.0d0*x1
      d2E(1) = x2
      d2E(2) = 0
      d2E(3) = x2
      end subroutine
