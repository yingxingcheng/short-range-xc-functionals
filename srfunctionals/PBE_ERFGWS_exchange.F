C SOURCES:
C    Erich Goll,  Hans-Joachim Werner, and Hermann Stoll.
C    A short-range gradient-corrected densityfunctional in long-range coupled-cluster calculations for rare gas dimers.
C    Physical Chemistry Chemical Physics, 7(23):3917, 2005.

C    Erich Goll, Hans-Joachim Werner, Hermann Stoll, Thierry Leininger, Paola Gori-Giorgi, and Andreas Savin.
C    A short-range gradient-corrected spin density functional in combination with long-range coupled-cluster methods:  Application to alkali-metal rare-gas dimers.
C    Chemical Physics,329(1-3):276-282, oct 2006.



C*****************************************************************************
      pure subroutine ESRX_PBE_GWS_ERF_case_1(rho, sigma, mu, Ea)
C*****************************************************************************
C   Implemented by YingXing Cheng.
C
C   Subroutine generated using Sympy 1.4
C   Generated: January 16, 2022
C*****************************************************************************
      implicit none
      real*8, intent(in) :: rho, sigma, mu
      real*8, intent(out) :: Ea
      real*8 :: x0, x1, x2
      Ea = 0.0d0
      x0 = rho**0.333333333333333d0
      x1 = 0.217336917462899d0
      x2 = mu**2*rho**(-0.666666666666667d0)*x1
      Ea = -0.738558766382022d0*x0*(1.804d0 - 0.804d0/(0.379714494541392
     &d0*rho**( -2.66666666666667d0)*sigma*x1*(8.65349742184445d0*x2 - 7
     &.0d0)*exp (-2.2835618196533969d0*x2)/(0.589520745899566d0*mu**4*rh
     &o**( -1.33333333333333d0) + 61.8763981250073d0*mu/x0 - 77.88147679
     &66001d0*x2 - 81.0d0) + 1.0d0))
      end subroutine


C*****************************************************************************
      pure subroutine ESRX_PBE_GWS_ERF_case_2_1(rho, sigma, mu, Ea)
C*****************************************************************************
C   Implemented by YingXing Cheng.
C
C   Subroutine generated using Sympy 1.4
C   Generated: January 16, 2022
C*****************************************************************************
      implicit none
      real*8, intent(in) :: rho, sigma, mu
      real*8, intent(out) :: Ea
      real*8 :: x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10
      Ea = 0.0d0
      x0 = rho**0.333333333333333d0
      x1 = 4.60115111447049d0
      x2 = 1d0/x1
      x3 = mu**2
      x4 = rho**0.666666666666667d0
      x5 = x2*x3/x4
      x6 = 1d0/x0
      x7 = 2.14502939711103d0
      x8 = x6/x7
      x9 = mu*x8
      x10 = 0.0168868639403896d0*1d0/rho
      Ea = 1.96949004368539d0*x0*(1.804d0 - 0.804d0/(0.379714494541392d0
     &*rho**( -2.66666666666667d0)*sigma*x2*(8.65349742184445d0*x5 - 7.0
     &d0)*exp (-2.2835618196533969d0*x5)/(0.589520745899566d0*mu**4*rho*
     &*( -1.33333333333333d0) + 61.8763981250073d0*mu*x6 - 77.8814767966
     &001d0*x5 - 81.0d0) + 1.0d0))*(0.346680637175317d0*x9 *(mu**3*x10 -
     & mu*(x10*x3 - 0.693361274350635d0*x8)*exp( -2.0800838230519036d0*x
     &1*x4/x3) - 1.04004191152595d0*x9 + 1.77245385090552d0*erf(1.442249
     &5703074083d0*x0*x7/mu)) - 0.375d0)
      end subroutine


C*****************************************************************************
      pure subroutine ESRX_PBE_GWS_ERF_case_2_2(rho, sigma, mu, Ea)
C*****************************************************************************
C   Implemented by YingXing Cheng.
C
C   Subroutine generated using Sympy 1.4
C   Generated: January 16, 2022
C*****************************************************************************
      implicit none
      real*8, intent(in) :: rho, sigma, mu
      real*8, intent(out) :: Ea
      real*8 :: x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10
      Ea = 0.0d0
      x0 = rho**0.333333333333333d0
      x1 = 4.60115111447049d0
      x2 = 1d0/x1
      x3 = mu**2
      x4 = 1d0/x3
      x5 = rho**0.666666666666667d0
      x6 = x1*x5
      x7 = 2.14502939711103d0
      x8 = 1/(x0*x7)
      x9 = mu*x8
      x10 = 0.0168868639403896d0*1d0/rho
      Ea = 1.96949004368539d0*x0*(1.804d0 + 0.804d0/(0.379714494541392d0
     &*rho**( -2.66666666666667d0)*sigma*x2*x4*(0.0848146572411181d0*rho
     &** 1.33333333333333d0*x4 - 0.115560212391772d0*x6 + 3.600657472149
     &73d0*rho**2.0d0/mu**4)*exp(-2.2835618196533969d0*x2 *x3/x5) - 1.0d
     &0))*(0.346680637175317d0*x9*(mu**3*x10 - mu*(x10*x3 - 0.6933612743
     &50635d0*x8)*exp(-2.0800838230519036d0*x4*x6) - 1.04004191152595d0*
     &x9 + 1.77245385090552d0*erf( 1.4422495703074083d0*x0*x7/mu)) - 0.3
     &75d0)
      end subroutine


C*****************************************************************************
      pure subroutine ESRX_PBE_GWS_ERF_case_2_3(rho, sigma, mu, Ea)
C*****************************************************************************
C   Implemented by YingXing Cheng.
C
C   Subroutine generated using Sympy 1.4
C   Generated: January 16, 2022
C*****************************************************************************
      implicit none
      real*8, intent(in) :: rho, sigma, mu
      real*8, intent(out) :: Ea
      real*8 :: x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x
     &13, x14
      Ea = 0.0d0
      x0 = rho**0.333333333333333d0
      x1 = 2.14502939711103d0
      x2 = 1/(x0*x1)
      x3 = mu*x2
      x4 = 0.0168868639403896d0*1d0/rho
      x5 = erf(1.4422495703074083d0*x0*x1/mu)
      x6 = 4.60115111447049d0
      x7 = mu**2
      x8 = 1d0/x7
      x9 = rho**0.666666666666667d0
      x10 = 2.0800838230519d0*x6*x8*x9
      x11 = x7/(x6*x9)
      x12 = exp(x10)
      x13 = 0.0472353356922751d0*mu**4*rho**(-1.33333333333333d0)*(x12 -
     & 1.0d0)
      x14 = 3.0d0*x12
      Ea = 1.96949004368539d0*x0*(1.804d0 - 0.804d0/(-3.15935190989552d0
     &*rho**( -2.0d0)*sigma*x8*(0.00445138756267719d0*x11*(7.0d0*x12 + 1
     &1.0d0) - 0.0385200707972575d0*x13 + 0.0185185185185185d0)*exp( -2.
     &2835618196533969d0*x11)/(-0.961499713538272d0*x11*(x14 - 2.0d0 ) +
     & 4.91580344316615d0*x12*x3*x5 + 0.46224084956709d0*x13 - x14) + 1.
     &0d0))*(0.346680637175317d0*x3*(mu**3*x4 - mu*( -0.693361274350635d
     &0*x2 + x4*x7)*exp(-x10) - 1.04004191152595d0* x3 + 1.7724538509055
     &2d0*x5) - 0.375d0)
      end subroutine


C*****************************************************************************
      pure subroutine ESRX_PBE_GWS_ERF_case_3(rho, sigma, mu, Ea)
C*****************************************************************************
C   Implemented by YingXing Cheng.
C
C   Subroutine generated using Sympy 1.4
C   Generated: January 16, 2022
C*****************************************************************************
      implicit none
      real*8, intent(in) :: rho, sigma, mu
      real*8, intent(out) :: Ea
      real*8 :: x0, x1, x2, x3, x4
      Ea = 0.0d0
      x0 = mu**2
      x1 = 1d0/x0
      x2 = 4.60115111447049d0
      x3 = 1d0/x2
      x4 = rho**0.666666666666667d0
      Ea = -0.785398163397448d0*rho**1.0d0*x1*(1.804d0 + 0.804d0/( 0.379
     &714494541392d0*rho**(-2.66666666666667d0)*sigma*x1*x3*( 0.08481465
     &72411181d0*rho**1.33333333333333d0*x1 - 0.115560212391772d0*x2*x4 
     &+ 3.60065747214973d0*rho**2.0d0/mu**4)* exp(-2.2835618196533969d0*
     &x0*x3/x4) - 1.0d0))
      end subroutine


C*****************************************************************************
      pure subroutine D1ESRX_PBE_GWS_ERF_case_1(rho, sigma, mu, Ea, d1Ea
     &)
C*****************************************************************************
C   Implemented by YingXing Cheng.
C
C   Subroutine generated using Sympy 1.4
C   Generated: January 16, 2022
C*****************************************************************************
      implicit none
      real*8, intent(in) :: rho, sigma, mu
      real*8, intent(out) :: Ea, d1Ea(4)
      real*8 :: x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x
     &13, x14, x15, x16, x17, x18
      Ea = 0.0d0
      d1Ea(:) = 0.0d0
      x0 = 0.682784063255296d0
      x1 = rho**0.333333333333333d0
      x2 = 0.826307487110758d0
      x3 = 0.0472353356922751d0
      x4 = rho**1.33333333333333d0
      x5 = 1d0/x4
      x6 = 0.217336917462899d0
      x7 = mu**2
      x8 = rho**(-0.666666666666667d0)*x6*x7
      x9 = 1d0/(12.4805029383114d0*mu**4*x3*x5 + 74.8830176298686d0*mu*x
     &2/x1 - 77.8814767966001d0*x8 - 81.0d0)
      x10 = x9*exp(-2.2835618196533969d0*x8)
      x11 = sigma*x10
      x12 = 8.65349742184445d0*x8 - 7.0d0
      x13 = x12*x6
      x14 = 0.379714494541392d0*rho**(-2.66666666666667d0)*x13
      x15 = x11*x14 + 1.0d0
      x16 = 1.804d0 - 0.804d0/x15
      x17 = x15**(-2)
      x18 = rho**(-4.33333333333333d0)*x3*x7
      Ea = -1.08168717773056d0*x0*x1*x16
      d1Ea(1) = -x0*(1.44224957030741d0*rho**0.333333333333333d0*x16 + 0
     &.869676490895367d0*x11*x17*x4*(mu*x14*x9*(16.6406705844152d0*mu **
     &3*rho**(-2.33333333333333d0)*x3 - 51.9209845310667d0*mu*rho**( -1.
     &66666666666667d0)*x6 + 24.9610058766229d0*x2*x5) - 1.0125719854437
     &1d0*rho**(-3.66666666666667d0)*x13 + 0.578067681402474d0*x12*x18 -
     & 2.19057226636727d0*x18))
      d1Ea(2) = -0.0490040286002001d0*x10*x12*x17*x5
      end subroutine


C*****************************************************************************
      pure subroutine D1ESRX_PBE_GWS_ERF_case_2_1(rho, sigma, mu, Ea, d1
     &Ea)
C*****************************************************************************
C   Implemented by YingXing Cheng.
C
C   Subroutine generated using Sympy 1.4
C   Generated: January 16, 2022
C*****************************************************************************
      implicit none
      real*8, intent(in) :: rho, sigma, mu
      real*8, intent(out) :: Ea, d1Ea(4)
      real*8 :: x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x
     &13, x14, x15, x16, x17, x18, x19, x20, x21, x22, x23, x24, x25, x2
     &6, x27, x28, x29, x30, x31, x32, x33, x34, x35, x36, x37, x38, x39
     &, x40, x41, x42, x43, x44
      Ea = 0.0d0
      d1Ea(:) = 0.0d0
      x0 = rho**0.333333333333333d0
      x1 = 2.14502939711103d0
      x2 = 1d0/x1
      x3 = 1d0/x0
      x4 = x2*x3
      x5 = 0.693361274350635d0*x4
      x6 = mu**2
      x7 = 0.0168868639403896d0
      x8 = 1d0/rho*x7
      x9 = x6*x8
      x10 = -x5 + x9
      x11 = 4.60115111447049d0
      x12 = rho**0.666666666666667d0
      x13 = x11*x12/x6
      x14 = exp(-2.0800838230519036d0*x13)
      x15 = mu*x14
      x16 = 1d0/mu
      x17 = x1*x16
      x18 = mu**3
      x19 = mu*x4
      x20 = x18*x8 - 1.04004191152595d0*x19 + 1.77245385090552d0*erf( 1.
     &4422495703074083d0*x0*x17)
      x21 = -x10*x15 + x20
      x22 = 0.346680637175317d0*x19
      x23 = x21*x22 - 0.375d0
      x24 = 0.682784063255296d0
      x25 = 0.826307487110758d0
      x26 = 0.0472353356922751d0
      x27 = rho**1.33333333333333d0
      x28 = 1d0/x27
      x29 = 1d0/x11
      x30 = x29*x6/x12
      x31 = 1d0/(12.4805029383114d0*mu**4*x26*x28 + 74.8830176298686d0*m
     &u*x25*x3 - 77.8814767966001d0*x30 - 81.0d0)
      x32 = x31*exp(-2.2835618196533969d0*x30)
      x33 = sigma*x32
      x34 = 8.65349742184445d0*x30 - 7.0d0
      x35 = x29*x34
      x36 = 0.379714494541392d0*rho**(-2.66666666666667d0)*x35
      x37 = x33*x36 + 1.0d0
      x38 = 1.804d0 - 0.804d0/x37
      x39 = x24*x38
      x40 = x22*(x15*(x5 - x9) + x20) - 0.375d0
      x41 = x2*x28
      x42 = rho**(-2.0d0)*x7
      x43 = x37**(-2)
      x44 = rho**(-4.33333333333333d0)*x26*x6
      Ea = 2.88449914061482d0*x0*x23*x39
      d1Ea(1) = -0.918164593146344d0*mu*x27*x38*(0.115560212391772d0*x21
     &*x28 - 0.346680637175317d0*x3*(0.346680637175317d0*mu*x41 + 0.9614
     &99713538272d0*rho**(-0.666666666666667d0)*x17*exp( -2.080083823051
     &9041d0*x13) + 1.38672254870127d0*rho**( -0.333333333333333d0)*x10*
     &x11*x14*x16 + x15*(-0.231120424783545d0 *x41 + x42*x6) - x18*x42))
     & + 3.84599885415309d0*rho** 0.333333333333333d0*x39*x40 + 2.319137
     &30905431d0*x24*x27*x33*x40* x43*(mu*x31*x36*(-51.9209845310667d0*m
     &u*rho**(-1.66666666666667d0 )*x29 + 16.6406705844152d0*rho**(-2.33
     &333333333333d0)*x18*x26 + 24.9610058766229d0*x25*x28) - 1.01257198
     &544371d0*rho**( -3.66666666666667d0)*x35 + 0.578067681402474d0*x34
     &*x44 - 2.19057226636727d0*x44)
      d1Ea(2) = 0.130677409600534d0*x23*x28*x32*x34*x43
      end subroutine


C*****************************************************************************
      pure subroutine D1ESRX_PBE_GWS_ERF_case_2_2(rho, sigma, mu, Ea, d1
     &Ea)
C*****************************************************************************
C   Implemented by YingXing Cheng.
C
C   Subroutine generated using Sympy 1.4
C   Generated: January 16, 2022
C*****************************************************************************
      implicit none
      real*8, intent(in) :: rho, sigma, mu
      real*8, intent(out) :: Ea, d1Ea(4)
      real*8 :: x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x
     &13, x14, x15, x16, x17, x18, x19, x20, x21, x22, x23, x24, x25, x2
     &6, x27, x28, x29, x30, x31, x32, x33, x34, x35, x36, x37, x38, x39
     &, x40, x41, x42, x43, x44, x45, x46, x47, x48, x49, x50, x51, x52
      Ea = 0.0d0
      d1Ea(:) = 0.0d0
      x0 = 0.682784063255296d0
      x1 = rho**0.333333333333333d0
      x2 = 4.60115111447049d0
      x3 = rho**0.666666666666667d0
      x4 = x2*x3
      x5 = 0.115560212391772d0*x4
      x6 = rho**1.33333333333333d0
      x7 = 21.1705915781930d0
      x8 = mu**2
      x9 = 1d0/x8
      x10 = x7*x9
      x11 = 0.00400624880640947d0*x10*x6
      x12 = rho**2.0d0
      x13 = 97.4090910340024d0/mu**4
      x14 = 0.0369642857142857d0*x12*x13
      x15 = x11 + x14 - x5
      x16 = 1d0/x2
      x17 = x16*x9
      x18 = 0.379714494541392d0*rho**(-2.66666666666667d0)*x17
      x19 = exp(-2.2835618196533969d0*x16*x8/x3)
      x20 = sigma*x19
      x21 = x15*x18*x20
      x22 = x21 - 1.0d0
      x23 = 2.14502939711103d0
      x24 = 1d0/x23
      x25 = 1d0/x1
      x26 = x24*x25
      x27 = 0.693361274350635d0*x26
      x28 = rho**1.0d0
      x29 = 0.0168868639403896d0
      x30 = x29/x28
      x31 = x30*x8
      x32 = -x27 + x31
      x33 = x4*x9
      x34 = exp(-2.0800838230519036d0*x33)
      x35 = mu*x34
      x36 = 1d0/mu
      x37 = x23*x36
      x38 = mu**3
      x39 = mu*x26
      x40 = x30*x38 - 1.04004191152595d0*x39 + 1.77245385090552d0*erf( 1
     &.4422495703074083d0*x1*x37)
      x41 = -x32*x35 + x40
      x42 = 0.346680637175317d0*x39
      x43 = x41*x42 - 0.375d0
      x44 = rho**0.333333333333333d0
      x45 = 1.0d0 - x21
      x46 = 1.804d0 - 0.804d0/x45
      x47 = x0*(x42*(x35*(x27 - x31) + x40) - 0.375d0)
      x48 = 1d0/x6
      x49 = x24*x48
      x50 = x29/x12
      x51 = rho**(-0.333333333333333d0)*x2
      x52 = -x11 - x14 + x5
      Ea = 2.88449914061482d0*x0*x1*x43*(1.804d0 + 0.804d0/x22)
      d1Ea(1) = -0.918164593146344d0*mu*x46*x6*(-0.346680637175317d0*x25
     &*( 0.346680637175317d0*mu*x49 + 0.961499713538272d0*rho**( -0.6666
     &66666666667d0)*x37*exp(-2.0800838230519041d0*x33) + 1.386722548701
     &27d0*x32*x34*x36*x51 + x35*(-0.231120424783545d0* x49 + x50*x8) - 
     &x38*x50) + 0.115560212391772d0*x41*x48) + 2.31913730905431d0*x20*x
     &47*x6*(0.578067681402474d0*rho**( -4.33333333333333d0)*x52/x7 - 1.
     &01257198544371d0*rho**( -3.66666666666667d0)*x17*x52 + x18*(-0.005
     &34166507521262d0*x10* x44 - 0.0739285714285714d0*x13*x28 + 0.07704
     &01415945149d0*x51))/ x45**2 + 3.84599885415309d0*x44*x46*x47
      d1Ea(2) = -0.130677409600534d0*x15*x19*x43*x48*x9/x22**2
      end subroutine


C*****************************************************************************
      pure subroutine D1ESRX_PBE_GWS_ERF_case_2_3(rho, sigma, mu, Ea, d1
     &Ea)
C*****************************************************************************
C   Implemented by YingXing Cheng.
C
C   Subroutine generated using Sympy 1.4
C   Generated: January 16, 2022
C*****************************************************************************
      implicit none
      real*8, intent(in) :: rho, sigma, mu
      real*8, intent(out) :: Ea, d1Ea(4)
      real*8 :: x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x
     &13, x14, x15, x16, x17, x18, x19, x20, x21, x22, x23, x24, x25, x2
     &6, x27, x28, x29, x30, x31, x32, x33, x34, x35, x36, x37, x38, x39
     &, x40, x41, x42, x43, x44, x45, x46, x47, x48, x49, x50, x51, x52,
     & x53, x54, x55, x56, x57, x58, x59, x60, x61, x62, x63, x64, x65, 
     &x66
      Ea = 0.0d0
      d1Ea(:) = 0.0d0
      x0 = rho**0.333333333333333d0
      x1 = 2.14502939711103d0
      x2 = 1d0/x1
      x3 = 1d0/x0
      x4 = x2*x3
      x5 = 0.693361274350635d0*x4
      x6 = mu**2
      x7 = 1d0/rho
      x8 = 0.0168868639403896d0
      x9 = x7*x8
      x10 = x6*x9
      x11 = x10 - x5
      x12 = rho**0.666666666666667d0
      x13 = 4.60115111447049d0
      x14 = 1d0/x6
      x15 = x13*x14
      x16 = x12*x15
      x17 = 2.0800838230519d0*x16
      x18 = exp(-x17)
      x19 = mu*x18
      x20 = 1d0/mu
      x21 = x1*x20
      x22 = erf(1.4422495703074083d0*x0*x21)
      x23 = mu**3
      x24 = mu*x4
      x25 = 1.77245385090552d0*x22 + x23*x9 - 1.04004191152595d0*x24
      x26 = -x11*x19 + x25
      x27 = 0.346680637175317d0*x24
      x28 = x26*x27 - 0.375d0
      x29 = 0.682784063255296d0
      x30 = rho**1.33333333333333d0
      x31 = 1d0/x30
      x32 = exp(x17)
      x33 = 0.0472353356922751d0*mu**4*(x32 - 1.0d0)
      x34 = x31*x33
      x35 = 0.0385200707972575d0*x34
      x36 = 7.0d0*x32 + 11.0d0
      x37 = 1d0/x13
      x38 = x37*x6
      x39 = x38/x12
      x40 = 0.00445138756267719d0*x36*x39
      x41 = -x35 + x40 + 0.0185185185185185d0
      x42 = 3.0d0*x32
      x43 = x42 - 2.0d0
      x44 = x22*x32
      x45 = 1d0/(4.91580344316615d0*x24*x44 + 0.46224084956709d0*x34 - 0
     &.961499713538272d0*x39*x43 - x42)
      x46 = rho**(-2.0d0)
      x47 = 3.15935190989552d0*x14*x46
      x48 = x45*x47
      x49 = exp(-2.2835618196533969d0*x39)
      x50 = sigma*x49
      x51 = -x41*x48*x50 + 1.0d0
      x52 = 1.804d0 - 0.804d0/x51
      x53 = x29*x52
      x54 = x27*(x19*(-x10 + x5) + x25) - 0.375d0
      x55 = x2*x31
      x56 = mu*x55
      x57 = x46*x8
      x58 = rho**(-0.666666666666667d0)
      x59 = x21*x58
      x60 = rho**(-0.333333333333333d0)
      x61 = x35 - x40 - 0.0185185185185185d0
      x62 = x32*x7
      x63 = rho**(-1.66666666666667d0)*x38
      x64 = x32*x63
      x65 = rho**(-2.33333333333333d0)*x33
      x66 = x29*x45/x51**2
      Ea = 2.88449914061482d0*x0*x28*x53
      d1Ea(1) = -0.918164593146344d0*mu*x30*x52*(0.115560212391772d0*x26
     &*x31 - 0.346680637175317d0*x3*(1.38672254870127d0*x11*x13*x18*x20*
     &x60 + x19*(-0.231120424783545d0*x55 + x57*x6) - x23*x57 + 0.346680
     &637175317d0*x56 + 0.961499713538272d0*x59*exp( -2.0800838230519041
     &d0*x16))) + 3.84599885415309d0*rho** 0.333333333333333d0*x53*x54 +
     & 2.31913730905431d0*x30*x50*x54*x66* (4.80971693085764d0*rho**(-3.
     &66666666666667d0)*x37*x61 - 6.31870381979104d0*rho**(-3.0d0)*x14*x
     &61 + x47*( 0.00296759170845146d0*x36*x63 - 0.0432098765432099d0*x6
     &2 + 0.0534166507521262d0*x64 - 0.0513600943963433d0*x65) + x48*x61
     &*( 4.16016764610381d0*x15*x32*x60 - 0.640999809025515d0*x43*x63 + 
     &1.63860114772205d0*x44*x56 - 6.81685547962184d0*x44*x59 + 4.0d0* x
     &62 - 0.640999809025515d0*x64 + 0.61632113275612d0*x65 - 2.66666666
     &666667d0*x7*exp(-4.4408920985006262d-16*x16)))
      d1Ea(2) = -7.3269708866707d0*x14*x28*x41*x49*x58*x66
      end subroutine


C*****************************************************************************
      pure subroutine D1ESRX_PBE_GWS_ERF_case_3(rho, sigma, mu, Ea, d1Ea
     &)
C*****************************************************************************
C   Implemented by YingXing Cheng.
C
C   Subroutine generated using Sympy 1.4
C   Generated: January 16, 2022
C*****************************************************************************
      implicit none
      real*8, intent(in) :: rho, sigma, mu
      real*8, intent(out) :: Ea, d1Ea(4)
      real*8 :: x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x
     &13, x14, x15, x16, x17, x18, x19, x20, x21, x22, x23
      Ea = 0.0d0
      d1Ea(:) = 0.0d0
      x0 = rho**1.0d0
      x1 = 4.60115111447049d0
      x2 = rho**0.666666666666667d0
      x3 = 0.115560212391772d0*x1*x2
      x4 = mu**2
      x5 = 1d0/x4
      x6 = 21.1705915781930d0
      x7 = x5*x6
      x8 = 0.00400624880640947d0*rho**1.33333333333333d0*x7
      x9 = rho**2.0d0
      x10 = mu**(-4)
      x11 = 97.4090910340024d0*x10
      x12 = 0.0369642857142857d0*x11*x9
      x13 = x12 - x3 + x8
      x14 = 1d0/x1
      x15 = x14*x5
      x16 = 0.379714494541392d0*rho**(-2.66666666666667d0)*x15
      x17 = exp(-2.2835618196533969d0*x14*x4/x2)
      x18 = sigma*x17
      x19 = x13*x16*x18
      x20 = x19 - 1.0d0
      x21 = 3.14159265358979d0*x5
      x22 = 1.0d0 - x19
      x23 = -x12 + x3 - x8
      Ea = -0.25d0*x0*x21*(1.804d0 + 0.804d0/x20)
      d1Ea(1) = -x21*(0.5d0*x0*(1.804d0 - 0.804d0/x22) + 0.201d0*x18*x9*
     &( 0.578067681402474d0*rho**(-4.33333333333333d0)*x23/x6 - 1.012571
     &98544371d0*rho**(-3.66666666666667d0)*x15*x23 + x16*( 0.0770401415
     &945149d0*rho**(-0.333333333333333d0)*x1 - 0.00534166507521262d0*rh
     &o**0.333333333333333d0*x7 - 0.0739285714285714d0*x0*x11))/x22**2)
      d1Ea(2) = 0.0521118640974404d0*rho**(-0.666666666666667d0)*x10*x13
     &*x17/x20**2
      end subroutine


C*****************************************************************************
      pure subroutine D2ESRX_PBE_GWS_ERF_case_1(rho, sigma, mu, Ea, d1Ea
     &, d2Ea)
C*****************************************************************************
C   Implemented by YingXing Cheng.
C
C   Subroutine generated using Sympy 1.4
C   Generated: January 16, 2022
C*****************************************************************************
      implicit none
      real*8, intent(in) :: rho, sigma, mu
      real*8, intent(out) :: Ea, d1Ea(4), d2Ea(10)
      real*8 :: x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x
     &13, x14, x15, x16, x17, x18, x19, x20, x21, x22, x23, x24, x25, x2
     &6, x27, x28, x29, x30, x31, x32, x33, x34, x35, x36, x37, x38, x39
     &, x40, x41, x42, x43, x44, x45, x46, x47, x48, x49, x50, x51, x52,
     & x53, x54, x55, x56, x57
      Ea = 0.0d0
      d1Ea(:) = 0.0d0
      d2Ea(:) = 0.0d0
      x0 = 0.682784063255296d0
      x1 = rho**0.333333333333333d0
      x2 = 0.217336917462899d0
      x3 = mu**2
      x4 = x2*x3
      x5 = rho**(-0.666666666666667d0)*x4
      x6 = exp(-2.2835618196533969d0*x5)
      x7 = sigma*x6
      x8 = 0.826307487110758d0
      x9 = 0.0472353356922751d0
      x10 = mu**4
      x11 = rho**1.33333333333333d0
      x12 = 1d0/x11
      x13 = 74.8830176298686d0*mu*x8/x1 + 12.4805029383114d0*x10*x12*x9 
     &- 77.8814767966001d0*x5 - 81.0d0
      x14 = 1d0/x13
      x15 = rho**(-2.66666666666667d0)
      x16 = 8.65349742184445d0*x5 - 7.0d0
      x17 = x16*x2
      x18 = x15*x17
      x19 = 0.379714494541392d0*x18
      x20 = x14*x19
      x21 = x20*x7 + 1.0d0
      x22 = 1d0/x21
      x23 = 1.804d0 - 0.804d0*x22
      x24 = rho**0.333333333333333d0
      x25 = rho**(-4.33333333333333d0)
      x26 = x3*x9
      x27 = x25*x26
      x28 = rho**(-3.66666666666667d0)*x17
      x29 = x16*x27
      x30 = x12*x8
      x31 = mu*x2
      x32 = rho**(-1.66666666666667d0)*x31
      x33 = rho**(-2.33333333333333d0)
      x34 = mu**3*x9
      x35 = x33*x34
      x36 = 24.9610058766229d0*x30 - 51.9209845310667d0*x32 + 16.6406705
     &844152d0*x35
      x37 = x14*x36
      x38 = mu*x37
      x39 = x19*x38 - 2.19057226636727d0*x27 - 1.01257198544371d0*x28 + 
     &0.578067681402474d0*x29
      x40 = x14/x21**2
      x41 = x39*x40*x7
      x42 = 0.869676490895367d0*x11
      x43 = 0.148394183600699d0
      x44 = x16*x6
      x45 = x43*x44
      x46 = 0.330228769154866d0*x12
      x47 = x45*x46
      x48 = 2.02514397088743d0*x28
      x49 = 0.759428989082785d0*x18*x38 - 4.38114453273454d0*x27 + 1.156
     &13536280495d0*x29 - x48
      x50 = x13**(-2)
      x51 = exp(-4.5671236393067938d0*x5)
      x52 = x50*x51/x21**3
      x53 = 0.0102659822546843d0*rho**(-6.0d0)*x10
      x54 = rho**(-5.33333333333333d0)*x26
      x55 = x25*x34*x37
      x56 = 0.0322515344331995d0
      x57 = rho**(-3.0d0)*x3*x56
      Ea = -1.08168717773056d0*x0*x1*x23
      d1Ea(1) = -x0*(1.44224957030741d0*x23*x24 + x41*x42)
      d1Ea(2) = -x40*x47
      d2Ea(1) = x0*(-0.480749856769136d0*rho**(-0.666666666666667d0)*x23
     & + sigma**2*x39* x42*x49*x52 - 2.31913730905431d0*x24*x41 - x40*x4
     &2*x7*(mu*x20*( -38.8282313636356d0*rho**(-3.33333333333333d0)*x34 
     &+ 86.5349742184445d0*x15*x31 - 33.2813411688305d0*x33*x8) + 3.7127
     &6394662695d0*rho**(-4.66666666666667d0)*x17 + 0.379714494541392d0*
     &x15*x16*x36*x4*x50*(49.9220117532457d0*x30 - 103.841969062133d0*x3
     &2 + 33.2813411688305d0*x35) + 0.88003552428417d0*x16*x53 - 4.04647
     &376981732d0*x16*x54 + 1.15613536280495d0*x16*x55 - x38*x48 - 6.669
     &74292089055d0*x53 + 15.3340058645709d0*x54 - 4.38114453273454d0*x5
     &5))
      d2Ea(2) = x40*(sigma*x14*x16*x22*x43*x46*x49*x51 + 0.4403050255398
     &21d0*x33*x45 - x38*x47 - 0.502731872662125d0*x44*x57 + 1.905089201
     &667d0*x57*x6)
      d2Ea(3) = 0.250785300325332d0*rho**(-4.0d0)*x16**2*x52*x56
      end subroutine


C*****************************************************************************
      pure subroutine D2ESRX_PBE_GWS_ERF_case_2_1(rho, sigma, mu, Ea, d1
     &Ea, d2Ea)
C*****************************************************************************
C   Implemented by YingXing Cheng.
C
C   Subroutine generated using Sympy 1.4
C   Generated: January 16, 2022
C*****************************************************************************
      implicit none
      real*8, intent(in) :: rho, sigma, mu
      real*8, intent(out) :: Ea, d1Ea(4), d2Ea(10)
      real*8 :: x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x
     &13, x14, x15, x16, x17, x18, x19, x20, x21, x22, x23, x24, x25, x2
     &6, x27, x28, x29, x30, x31, x32, x33, x34, x35, x36, x37, x38, x39
     &, x40, x41, x42, x43, x44, x45, x46, x47, x48, x49, x50, x51, x52,
     & x53, x54, x55, x56, x57, x58, x59, x60, x61, x62, x63, x64, x65, 
     &x66, x67, x68, x69, x70, x71, x72, x73, x74, x75, x76, x77, x78, x
     &79, x80, x81, x82, x83, x84, x85, x86, x87, x88, x89, x90, x91, x9
     &2, x93, x94, x95, x96, x97, x98, x99, x100, x101, x102, x103, x104
     &, x105, x106, x107, x108, x109, x110, x111, x112
      Ea = 0.0d0
      d1Ea(:) = 0.0d0
      d2Ea(:) = 0.0d0
      x0 = rho**0.333333333333333d0
      x1 = 2.14502939711103d0
      x2 = 1d0/x1
      x3 = 1d0/x0
      x4 = x2*x3
      x5 = 0.693361274350635d0*x4
      x6 = mu**2
      x7 = 1d0/rho
      x8 = 9.86960440108936d0
      x9 = 1d0/x8
      x10 = 0.166666666666667d0*x9
      x11 = x10*x7
      x12 = x11*x6
      x13 = x12 - x5
      x14 = 4.60115111447049d0
      x15 = rho**0.666666666666667d0
      x16 = x14*x15/x6
      x17 = exp(-2.0800838230519036d0*x16)
      x18 = mu*x17
      x19 = 1d0/mu
      x20 = x1*x19
      x21 = mu**3
      x22 = mu*x4
      x23 = x11*x21 - 1.04004191152595d0*x22 + 1.77245385090552d0*erf( 1
     &.4422495703074083d0*x0*x20)
      x24 = -x13*x18 + x23
      x25 = 0.346680637175317d0*x22
      x26 = x24*x25 - 0.375d0
      x27 = 0.682784063255296d0
      x28 = 1d0/x14
      x29 = x28*x6
      x30 = x29/x15
      x31 = exp(-2.2835618196533969d0*x30)
      x32 = sigma*x31
      x33 = 0.826307487110758d0
      x34 = 21.1705915781930d0
      x35 = 1d0/x34
      x36 = mu**4
      x37 = rho**1.33333333333333d0
      x38 = 1d0/x37
      x39 = 74.8830176298686d0*mu*x3*x33 - 77.8814767966001d0*x30 + 12.4
     &805029383114d0*x35*x36*x38 - 81.0d0
      x40 = 1d0/x39
      x41 = rho**(-2.66666666666667d0)
      x42 = 8.65349742184445d0*x30 - 7.0d0
      x43 = x28*x42
      x44 = x41*x43
      x45 = 0.379714494541392d0*x44
      x46 = x40*x45
      x47 = x32*x46 + 1.0d0
      x48 = 1d0/x47
      x49 = 1.804d0 - 0.804d0*x48
      x50 = x27*x49
      x51 = x26*x50
      x52 = rho**0.333333333333333d0
      x53 = x25*(x18*(-x12 + x5) + x23) - 0.375d0
      x54 = 0.318309886183791d0
      x55 = mu*x38
      x56 = rho**(-2.0d0)*x10
      x57 = rho**(-0.666666666666667d0)
      x58 = exp(-2.0800838230519041d0*x16)
      x59 = x20*x58
      x60 = 0.231120424783545d0*x38
      x61 = -x2*x60 + x56*x6
      x62 = x13*x17
      x63 = rho**(-0.333333333333333d0)*x14*x19
      x64 = x18*x61 + 0.346680637175317d0*x2*x55 - x21*x56 + 0.961499713
     &538272d0*x57 *x59 + 1.38672254870127d0*x62*x63
      x65 = 0.346680637175317d0*x3
      x66 = 0.115560212391772d0*x24*x38 - x64*x65
      x67 = mu*x49*x54*x66
      x68 = 2.88449914061482d0*x37
      x69 = x40/x47**2
      x70 = x31*x53
      x71 = rho**(-4.33333333333333d0)
      x72 = x35*x6
      x73 = x71*x72
      x74 = rho**(-3.66666666666667d0)*x43
      x75 = x42*x73
      x76 = x33*x38
      x77 = mu*x28
      x78 = rho**(-1.66666666666667d0)*x77
      x79 = rho**(-2.33333333333333d0)
      x80 = x21*x35
      x81 = x79*x80
      x82 = 24.9610058766229d0*x76 - 51.9209845310667d0*x78 + 16.6406705
     &844152d0*x81
      x83 = x40*x82
      x84 = mu*x83
      x85 = x45*x84 - 2.19057226636727d0*x73 - 1.01257198544371d0*x74 + 
     &0.578067681402474d0*x75
      x86 = x27*x85
      x87 = 2.31913730905431d0*x37
      x88 = x86*x87
      x89 = x31*x42
      x90 = x26*x69
      x91 = 0.148394183600699d0
      x92 = 0.880610051079643d0*x38*x91
      x93 = x32*x90
      x94 = mu*x54
      x95 = 2.02514397088743d0*x74
      x96 = 0.759428989082785d0*x44*x84 - 4.38114453273454d0*x73 + 1.156
     &13536280495d0*x75 - x95
      x97 = x39**(-2)
      x98 = exp(-4.5671236393067938d0*x30)
      x99 = x26*x97*x98/x47**3
      x100 = x2*x79
      x101 = rho**(-3.0d0)
      x102 = 0.333333333333333d0*x9
      x103 = 1d0/x21
      x104 = x101*x6
      x105 = 0.0102659822546843d0*rho**(-6.0d0)*x36
      x106 = rho**(-5.33333333333333d0)*x72
      x107 = x71*x80*x83
      x108 = 0.0322515344331995d0
      x109 = x104*x108
      x110 = x42*x70
      x111 = x110*x91
      x112 = 0.880610051079643d0*x55
      Ea = 2.88449914061482d0*x0*x51
      d1Ea(1) = sigma*x69*x70*x88 + 3.84599885415309d0*x50*x52*x53 - x67
     &*x68
      d1Ea(2) = x89*x90*x92
      d2Ea(1) = -sigma**2*x88*x96*x99 + x27*x87*x93*(-mu*x46*(38.8282313
     &636356d0*rho**( -3.33333333333333d0)*x80 + 33.2813411688305d0*x33*
     &x79 - 86.5349742184445d0*x41*x77) + 3.71276394662695d0*rho**( -4.6
     &6666666666667d0)*x43 + 0.88003552428417d0*x105*x42 - 6.66974292089
     &055d0*x105 - 4.04647376981732d0*x106*x42 + 15.3340058645709d0*x106
     & + 1.15613536280495d0*x107*x42 - 4.38114453273454d0*x107 + 0.37971
     &4494541392d0*x29*x41*x42*x82*x97 *(49.9220117532457d0*x76 - 103.84
     &1969062133d0*x78 + 33.2813411688305d0*x81) - x84*x95) - 4.63827461
     &810863d0*x32*x37* x66*x69*x85*x94 + x49*x68*x94*(0.15408028318903d
     &0*x24*x79 - x60* x64 + x65*(-0.46224084956709d0*mu*x100 - 0.640999
     &809025515d0*rho **(-1.66666666666667d0)*x59 - 0.46224084956709d0*r
     &ho**( -1.33333333333333d0)*x14*x19*x62 + x101*x102*x21 - 1.9229994
     &2707654d0*x103*x34*x57*x62 - 1.33333333333333d0*x103*x58 *x7*x8 - 
     &2.77344509740254d0*x17*x61*x63 - x18*( -0.30816056637806d0*x100 + 
     &x102*x104))) + 1.28199961805103d0*x51* x57 - 7.69199770830618d0*x5
     &2*x67 + 6.18436615747817d0*x52*x86*x93
      d2Ea(2) = x69*(-sigma*x40*x42*x48*x53*x92*x96*x98 + 1.340618327099
     &d0*x109*x110 - 5.080237871112d0*x109*x70 + x111*x112*x83 - 1.17414
     &673477286d0* x111*x79 - 0.0691804894611514d0*x112*x66*x89)
      d2Ea(3) = -0.668760800867553d0*rho**(-4.0d0)*x108*x42**2*x99
      end subroutine


C*****************************************************************************
      pure subroutine D2ESRX_PBE_GWS_ERF_case_2_2(rho, sigma, mu, Ea, d1
     &Ea, d2Ea)
C*****************************************************************************
C   Implemented by YingXing Cheng.
C
C   Subroutine generated using Sympy 1.4
C   Generated: January 16, 2022
C*****************************************************************************
      implicit none
      real*8, intent(in) :: rho, sigma, mu
      real*8, intent(out) :: Ea, d1Ea(4), d2Ea(10)
      real*8 :: x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x
     &13, x14, x15, x16, x17, x18, x19, x20, x21, x22, x23, x24, x25, x2
     &6, x27, x28, x29, x30, x31, x32, x33, x34, x35, x36, x37, x38, x39
     &, x40, x41, x42, x43, x44, x45, x46, x47, x48, x49, x50, x51, x52,
     & x53, x54, x55, x56, x57, x58, x59, x60, x61, x62, x63, x64, x65, 
     &x66, x67, x68, x69, x70, x71, x72, x73, x74, x75, x76, x77, x78, x
     &79, x80, x81, x82, x83, x84, x85, x86, x87, x88, x89, x90, x91, x9
     &2, x93, x94, x95, x96, x97, x98, x99, x100, x101, x102, x103, x104
     &, x105, x106, x107, x108, x109, x110, x111, x112
      Ea = 0.0d0
      d1Ea(:) = 0.0d0
      d2Ea(:) = 0.0d0
      x0 = rho**0.333333333333333d0
      x1 = mu**2
      x2 = 1d0/x1
      x3 = 4.60115111447049d0
      x4 = 1d0/x3
      x5 = x2*x4
      x6 = rho**(-2.66666666666667d0)*x5
      x7 = 0.379714494541392d0*x6
      x8 = rho**0.666666666666667d0
      x9 = x3*x8
      x10 = 0.115560212391772d0*x9
      x11 = rho**1.33333333333333d0
      x12 = 21.1705915781930d0
      x13 = x12*x2
      x14 = 0.00400624880640947d0*x11*x13
      x15 = rho**2.0d0
      x16 = 97.4090910340024d0
      x17 = mu**(-4)
      x18 = x16*x17
      x19 = 0.0369642857142857d0*x15*x18
      x20 = -x10 + x14 + x19
      x21 = x1*x4/x8
      x22 = exp(-2.2835618196533969d0*x21)
      x23 = x20*x22
      x24 = sigma*x23*x7
      x25 = x24 - 1.0d0
      x26 = 1.804d0 + 0.804d0/x25
      x27 = 2.88449914061482d0*x26
      x28 = 0.682784063255296d0
      x29 = 2.14502939711103d0
      x30 = 1d0/x29
      x31 = 1d0/x0
      x32 = x30*x31
      x33 = 0.693361274350635d0*x32
      x34 = rho**1.0d0
      x35 = 1d0/x34
      x36 = 9.86960440108936d0
      x37 = 1d0/x36
      x38 = 0.166666666666667d0*x37
      x39 = x35*x38
      x40 = x1*x39
      x41 = -x33 + x40
      x42 = x2*x9
      x43 = exp(-2.0800838230519036d0*x42)
      x44 = mu*x43
      x45 = 1d0/mu
      x46 = x29*x45
      x47 = mu**3
      x48 = mu*x32
      x49 = x39*x47 - 1.04004191152595d0*x48 + 1.77245385090552d0*erf( 1
     &.4422495703074083d0*x0*x46)
      x50 = -x41*x44 + x49
      x51 = 0.346680637175317d0*x48
      x52 = x50*x51 - 0.375d0
      x53 = x28*x52
      x54 = rho**0.333333333333333d0
      x55 = 1.0d0 - x24
      x56 = 1d0/x55
      x57 = 1.804d0 - 0.804d0*x56
      x58 = x51*(x44*(x33 - x40) + x49) - 0.375d0
      x59 = x28*x58
      x60 = 1d0/x11
      x61 = x38/x15
      x62 = rho**(-0.666666666666667d0)
      x63 = exp(-2.0800838230519041d0*x42)
      x64 = x46*x63
      x65 = 0.231120424783545d0*x60
      x66 = x1*x61 - x30*x65
      x67 = x41*x43
      x68 = rho**(-0.333333333333333d0)*x3
      x69 = x45*x68
      x70 = 0.346680637175317d0*mu*x30*x60 + x44*x66 - x47*x61 + 0.96149
     &9713538272d0 *x62*x64 + 1.38672254870127d0*x67*x69
      x71 = 0.346680637175317d0*x31
      x72 = 0.115560212391772d0*x50*x60 - x70*x71
      x73 = 0.318309886183791d0
      x74 = mu*x11*x73
      x75 = x72*x74
      x76 = x55**(-2)
      x77 = x10 - x14 - x19
      x78 = 1d0/x12
      x79 = rho**(-4.33333333333333d0)*x78
      x80 = 0.578067681402474d0*x79
      x81 = rho**(-3.66666666666667d0)*x5
      x82 = 1.01257198544371d0*x81
      x83 = 0.0770401415945149d0*x68
      x84 = 0.00534166507521262d0*x13*x54
      x85 = 0.0739285714285714d0*x18
      x86 = x34*x85
      x87 = x83 - x84 - x86
      x88 = sigma*x22
      x89 = 2.31913730905431d0*x11
      x90 = x88*x89
      x91 = x25**(-2)
      x92 = 0.880610051079643d0*x60
      x93 = x23*x92
      x94 = 0.148394183600699d0*x2
      x95 = x53*x91
      x96 = -x83 + x84 + x86
      x97 = -x20*x80 + x20*x82 - x7*x96
      x98 = x88*x97
      x99 = 1.15613536280495d0*x79
      x100 = rho**(-1.33333333333333d0)*x3
      x101 = 2.02514397088743d0*x81
      x102 = 0.759428989082785d0*x6
      x103 = exp(-4.5671236393067938d0*x21)
      x104 = x103/x25**3
      x105 = rho**(-2.33333333333333d0)
      x106 = x105*x30
      x107 = rho**(-3.0d0)
      x108 = 0.333333333333333d0*x107*x37
      x109 = 1d0/x47
      x110 = 0.0322515344331995d0
      x111 = x23*x58
      x112 = x58*x92*x94
      Ea = x0*x27*x53
      d1Ea(1) = 3.84599885415309d0*x54*x57*x59 - 2.88449914061482d0*x57*
     &x75 + x59*x76* x90*(x7*x87 + x77*x80 - x77*x82)
      d1Ea(2) = -x52*x91*x93*x94
      d2Ea(1) = -7.69199770830618d0*mu*x26*x54*x72*x73 + sigma**2*x104*x
     &53*x89*x97*(x101 *x20 - x102*x96 - x20*x99) + 1.28199961805103d0*x
     &26*x53*x62 + x27 *x74*(0.15408028318903d0*x105*x50 - x65*x70 + x71
     &*( -0.46224084956709d0*mu*x106 - 0.640999809025515d0*rho**( -1.666
     &66666666667d0)*x64 - 0.46224084956709d0*x100*x45*x67 + x108 *x47 -
     & 1.92299942707654d0*x109*x12*x62*x67 - 1.33333333333333d0* x109*x3
     &5*x36*x63 - 2.77344509740254d0*x43*x66*x69 - x44*(x1*x108 - 0.3081
     &6056637806d0*x106))) + 6.18436615747817d0*x54*x95*x98 - 4.63827461
     &810863d0*x75*x91*x98 + x90*x95*(-0.88003552428417d0*rho **(-6.0d0)
     &*x1*x20/x16 + 4.04647376981732d0*rho**( -5.33333333333333d0)*x20*x
     &78 - 3.71276394662695d0*rho**( -4.66666666666667d0)*x20*x5 + x101*
     &x96 - x7*(0.0256800471981717d0 *x100 + 0.00178055502507087d0*x13*x
     &62 + x85) - x96*x99)
      d2Ea(2) = x76*(sigma*x103*x112*x20*x56*(-x101*x77 + x102*x87 + x77
     &*x99) + 1.17414673477286d0*x105*x111*x94 - 1.340618327099d0*x107*x
     &110* x111 - x112*x22*x96 + 0.0691804894611514d0*x45*x72*x93)
      d2Ea(3) = 0.668760800867553d0*rho**(-4.0d0)*x104*x110*x17*x20**2*x
     &52
      end subroutine


C*****************************************************************************
      pure subroutine D2ESRX_PBE_GWS_ERF_case_2_3(rho, sigma, mu, Ea, d1
     &Ea, d2Ea)
C*****************************************************************************
C   Implemented by YingXing Cheng.
C
C   Subroutine generated using Sympy 1.4
C   Generated: January 16, 2022
C*****************************************************************************
      implicit none
      real*8, intent(in) :: rho, sigma, mu
      real*8, intent(out) :: Ea, d1Ea(4), d2Ea(10)
      real*8 :: x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x
     &13, x14, x15, x16, x17, x18, x19, x20, x21, x22, x23, x24, x25, x2
     &6, x27, x28, x29, x30, x31, x32, x33, x34, x35, x36, x37, x38, x39
     &, x40, x41, x42, x43, x44, x45, x46, x47, x48, x49, x50, x51, x52,
     & x53, x54, x55, x56, x57, x58, x59, x60, x61, x62, x63, x64, x65, 
     &x66, x67, x68, x69, x70, x71, x72, x73, x74, x75, x76, x77, x78, x
     &79, x80, x81, x82, x83, x84, x85, x86, x87, x88, x89, x90, x91, x9
     &2, x93, x94, x95, x96, x97, x98, x99, x100, x101, x102, x103, x104
     &, x105, x106, x107, x108, x109, x110, x111, x112, x113, x114, x115
     &, x116, x117, x118, x119, x120, x121, x122, x123, x124, x125, x126
     &, x127, x128, x129, x130, x131, x132, x133, x134, x135, x136, x137
     &, x138, x139, x140, x141, x142, x143, x144, x145, x146, x147, x148
     &
      Ea = 0.0d0
      d1Ea(:) = 0.0d0
      d2Ea(:) = 0.0d0
      x0 = rho**0.333333333333333d0
      x1 = 2.14502939711103d0
      x2 = 1d0/x1
      x3 = 1d0/x0
      x4 = x2*x3
      x5 = 0.693361274350635d0*x4
      x6 = mu**2
      x7 = 1d0/rho
      x8 = 9.86960440108936d0
      x9 = 1d0/x8
      x10 = 0.166666666666667d0*x9
      x11 = x10*x7
      x12 = x11*x6
      x13 = x12 - x5
      x14 = rho**0.666666666666667d0
      x15 = 4.60115111447049d0
      x16 = 1d0/x6
      x17 = x15*x16
      x18 = x14*x17
      x19 = 2.0800838230519d0*x18
      x20 = exp(-x19)
      x21 = mu*x20
      x22 = 1d0/mu
      x23 = x1*x22
      x24 = erf(1.4422495703074083d0*x0*x23)
      x25 = mu**3
      x26 = mu*x4
      x27 = x11*x25 + 1.77245385090552d0*x24 - 1.04004191152595d0*x26
      x28 = -x13*x21 + x27
      x29 = 0.346680637175317d0*x26
      x30 = x28*x29 - 0.375d0
      x31 = 0.682784063255296d0
      x32 = exp(x19)
      x33 = 3.0d0*x32
      x34 = rho**1.33333333333333d0
      x35 = 1d0/x34
      x36 = 21.1705915781930d0
      x37 = 1d0/x36
      x38 = mu**4
      x39 = x37*x38*(x32 - 1.0d0)
      x40 = x35*x39
      x41 = x33 - 2.0d0
      x42 = 1d0/x15
      x43 = x42*x6
      x44 = x43/x14
      x45 = x24*x32
      x46 = 4.91580344316615d0*x26*x45 - x33 + 0.46224084956709d0*x40 - 
     &0.961499713538272d0*x41*x44
      x47 = 1d0/x46
      x48 = 0.0385200707972575d0*x40
      x49 = 7.0d0*x32 + 11.0d0
      x50 = 0.00445138756267719d0*x44*x49
      x51 = -x48 + x50 + 0.0185185185185185d0
      x52 = rho**(-2.0d0)
      x53 = x16*x52
      x54 = 3.15935190989552d0*x53
      x55 = x51*x54
      x56 = x47*x55
      x57 = exp(-2.2835618196533969d0*x44)
      x58 = sigma*x57
      x59 = -x56*x58 + 1.0d0
      x60 = 1d0/x59
      x61 = 1.804d0 - 0.804d0*x60
      x62 = x31*x61
      x63 = x30*x62
      x64 = rho**0.333333333333333d0
      x65 = x29*(x21*(-x12 + x5) + x27) - 0.375d0
      x66 = 0.318309886183791d0
      x67 = mu*x2*x35
      x68 = x10*x52
      x69 = rho**(-0.666666666666667d0)
      x70 = exp(-2.0800838230519041d0*x18)
      x71 = x23*x70
      x72 = 0.231120424783545d0*x35
      x73 = -x2*x72 + x6*x68
      x74 = x13*x20
      x75 = rho**(-0.333333333333333d0)
      x76 = x15*x22*x75
      x77 = x21*x73 - x25*x68 + 0.346680637175317d0*x67 + 0.961499713538
     &272d0*x69* x71 + 1.38672254870127d0*x74*x76
      x78 = 0.346680637175317d0*x3
      x79 = x66*(0.115560212391772d0*x28*x35 - x77*x78)
      x80 = mu*x61*x79
      x81 = 2.88449914061482d0*x34
      x82 = x48 - x50 - 0.0185185185185185d0
      x83 = rho**(-3.66666666666667d0)*x42
      x84 = 4.80971693085764d0*x83
      x85 = rho**(-3.0d0)
      x86 = x16*x85
      x87 = 6.31870381979104d0*x82
      x88 = x32*x7
      x89 = 0.0432098765432099d0*x88
      x90 = rho**(-1.66666666666667d0)
      x91 = x43*x90
      x92 = x32*x91
      x93 = 0.0534166507521262d0*x92
      x94 = rho**(-2.33333333333333d0)
      x95 = x39*x94
      x96 = 0.0513600943963433d0*x95
      x97 = 0.00296759170845146d0*x49*x91
      x98 = -x89 + x93 - x96 + x97
      x99 = exp(-4.4408920985006262d-16*x18)
      x100 = 0.564189583547756d0*x99
      x101 = x100*x7
      x102 = x17*x32
      x103 = 4.16016764610381d0*x102
      x104 = x41*x91
      x105 = x45*x67
      x106 = x32*x69
      x107 = x106*x23*x24
      x108 = -4.72654360241471d0*x101 + x103*x75 - 0.640999809025515d0*x
     &104 + 1.63860114772205d0*x105 - 6.81685547962184d0*x107 + 4.0d0*x8
     &8 - 0.640999809025515d0*x92 + 0.61632113275612d0*x95
      x109 = x108*x47
      x110 = x109*x54
      x111 = x31*x65
      x112 = x47/x59**2
      x113 = x112*x58
      x114 = 2.31913730905431d0*x34
      x115 = x113*x114
      x116 = x30*x31
      x117 = x16*x51
      x118 = 7.3269708866707d0*x69
      x119 = x117*x118
      x120 = x2*x94
      x121 = mu*x120
      x122 = 0.333333333333333d0*x85*x9
      x123 = rho**(-1.66666666666667d0)
      x124 = 1d0/x25
      x125 = x124*x8
      x126 = rho**(-1.33333333333333d0)
      x127 = x51*x86
      x128 = x89 - x93 + x96 - x97
      x129 = -x110*x51 + 6.31870381979104d0*x127 - x128*x54 - x51*x84
      x130 = x116*x129
      x131 = 9.61943386171527d0*x83
      x132 = x131*x51
      x133 = 12.6374076395821d0*x127
      x134 = 6.31870381979104d0*x53
      x135 = x128*x134
      x136 = x46**(-2)
      x137 = exp(-4.5671236393067938d0*x44)
      x138 = x136*x137/x59**3
      x139 = 12.6374076395821d0*x86
      x140 = x32*x52
      x141 = rho**(-2.66666666666667d0)*x43
      x142 = x141*x32
      x143 = rho**(-3.33333333333333d0)*x39
      x144 = 1d0/x38
      x145 = x23*x45
      x146 = x51*x57
      x147 = x111*x57
      x148 = x117*x147
      Ea = 2.88449914061482d0*x0*x63
      d1Ea(1) = x111*x115*(x110*x82 + x54*x98 + x82*x84 - x86*x87) + 3.8
     &4599885415309d0* x62*x64*x65 - x80*x81
      d1Ea(2) = -x112*x116*x119*x57
      d2Ea(1) = -4.63827461810863d0*mu*x113*x129*x34*x79 + mu*x61*x66*x8
     &1*( 0.15408028318903d0*x28*x94 - x72*x77 + x78*(-0.46224084956709d
     &0* x121 + x122*x25 - 0.640999809025515d0*x123*x71 - 1.922999427076
     &54d0*x124*x36*x69*x74 - 1.33333333333333d0*x125*x7* x70 - 0.462240
     &84956709d0*x126*x15*x22*x74 - 2.77344509740254d0* x20*x73*x76 - x2
     &1*(-0.30816056637806d0*x120 + x122*x6))) - sigma **2*x114*x130*x13
     &8*(-x109*x134*x51 - x132 + x133 - x135) + 6.18436615747817d0*x113*
     &x130*x64 + x115*x116*(-7.32219063109801d0 *rho**(-5.33333333333333
     &d0)*x37*x51*x6 + 27.2550626081933d0*rho** (-4.66666666666667d0)*x4
     &2*x51 - 18.9561114593731d0*rho**(-4.0d0)* x117 - x108*x136*x55*(-9
     &.45308720482942d0*x101 + 8.32033529220761d0*x102*x75 - 1.281999618
     &05103d0*x104 + 3.2772022954441d0*x105 - 13.6337109592437d0*x107 + 
     &8.0d0*x88 - 1.28199961805103d0*x92 + 1.23264226551224d0*x95) - x10
     &9*x132 + x109*x133 - x109*x135 - x128*x131 + x128*x139 - x54*( 0.0
     &599201101290672d0*x102*x126 - 0.146090534979424d0*x140 + 0.0049459
     &8618075243d0*x141*x49 + 0.160249952256379d0*x142 - 0.1198402202581
     &34d0*x143) - x56*(6.30205813655294d0*x100*x52 + x103*x126 + 5.7689
     &9828122963d0*x106*x144*x36 - 2.18480153029607d0 *x121*x45 + 4.5445
     &703197479d0*x123*x145 - 9.45308720482941d0*x125 *x24*x88 - 17.0147
     &200011152d0*x126*x16*x99 - 7.55555555555556d0* x140 + 1.0683330150
     &4252d0*x141*x41 + 1.92299942707654d0*x142 - 1.43808264309761d0*x14
     &3 + 2.27228515987395d0*x145*x90)) + 1.28199961805103d0*x63*x69 - 7
     &.69199770830618d0*x64*x80
      d2Ea(2) = x112*(sigma*x111*x119*x137*x47*x60*(x109*x53*x87 + x131*
     &x82 + x134*x98 - x139*x82) - x109*x118*x148 - x118*x128*x147*x16 +
     & x118*x146*x22* x79 + 4.88464725778047d0*x123*x148 - 1.65524718827
     &343d0*x146*x65* x94)
      d2Ea(3) = -46.296958929104d0*rho**(-2.66666666666667d0)*x116*x138*
     &x144*x51**2
      end subroutine


C*****************************************************************************
      pure subroutine D2ESRX_PBE_GWS_ERF_case_3(rho, sigma, mu, Ea, d1Ea
     &, d2Ea)
C*****************************************************************************
C   Implemented by YingXing Cheng.
C
C   Subroutine generated using Sympy 1.4
C   Generated: January 16, 2022
C*****************************************************************************
      implicit none
      real*8, intent(in) :: rho, sigma, mu
      real*8, intent(out) :: Ea, d1Ea(4), d2Ea(10)
      real*8 :: x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x
     &13, x14, x15, x16, x17, x18, x19, x20, x21, x22, x23, x24, x25, x2
     &6, x27, x28, x29, x30, x31, x32, x33, x34, x35, x36, x37, x38, x39
     &, x40, x41, x42, x43, x44, x45, x46, x47, x48, x49, x50, x51
      Ea = 0.0d0
      d1Ea(:) = 0.0d0
      d2Ea(:) = 0.0d0
      x0 = rho**1.0d0
      x1 = mu**2
      x2 = 1d0/x1
      x3 = 4.60115111447049d0
      x4 = 1d0/x3
      x5 = x2*x4
      x6 = rho**(-2.66666666666667d0)
      x7 = 0.379714494541392d0*x6
      x8 = x5*x7
      x9 = rho**0.666666666666667d0
      x10 = 0.115560212391772d0*x3*x9
      x11 = 21.1705915781930d0
      x12 = x11*x2
      x13 = 0.00400624880640947d0*rho**1.33333333333333d0*x12
      x14 = rho**2.0d0
      x15 = 97.4090910340024d0
      x16 = mu**(-4)
      x17 = x15*x16
      x18 = 0.0369642857142857d0*x14*x17
      x19 = -x10 + x13 + x18
      x20 = x1*x4/x9
      x21 = exp(-2.2835618196533969d0*x20)
      x22 = x19*x21
      x23 = sigma*x22*x8
      x24 = x23 - 1.0d0
      x25 = 3.14159265358979d0*x2
      x26 = 1.0d0 - x23
      x27 = 1d0/x26
      x28 = x10 - x13 - x18
      x29 = 1d0/x11
      x30 = rho**(-4.33333333333333d0)*x29
      x31 = x28*x30
      x32 = rho**(-3.66666666666667d0)
      x33 = x28*x5
      x34 = x32*x33
      x35 = 0.0770401415945149d0*rho**(-0.333333333333333d0)*x3
      x36 = 0.00534166507521262d0*rho**0.333333333333333d0*x12
      x37 = 0.0739285714285714d0*x17
      x38 = x0*x37
      x39 = x35 - x36 - x38
      x40 = x39*x5
      x41 = 0.578067681402474d0*x31 - 1.01257198544371d0*x34 + x40*x7
      x42 = 0.201d0*x14*x41
      x43 = x26**(-2)
      x44 = sigma*x21*x43
      x45 = 0.682784063255296d0
      x46 = 0.0763226134028198d0*rho**(-0.666666666666667d0)
      x47 = exp(-4.5671236393067938d0*x20)
      x48 = x47*(1.15613536280495d0*x31 - 2.02514397088743d0*x34 + 0.759
     &428989082785d0*x40*x6)
      x49 = 0.148394183600699d0
      x50 = x2*x45
      x51 = x46*x50
      Ea = -0.25d0*x0*x25*(1.804d0 + 0.804d0/x24)
      d1Ea(1) = -x25*(0.5d0*x0*(1.804d0 - 0.804d0*x27) + x42*x44)
      d1Ea(2) = x16*x22*x45*x46/x24**2
      d2Ea(1) = x25*(sigma**2*x42*x48/x26**3 - 0.804d0*x0*x41*x44 - 0.20
     &1d0*x14*x44*( 0.88003552428417d0*rho**(-6.0d0)*x1*x28/x15 - 4.0464
     &7376981732d0* rho**(-5.33333333333333d0)*x28*x29 + 3.7127639466269
     &5d0*rho**( -4.66666666666667d0)*x33 + 1.15613536280495d0*x30*x39 -
     & 2.02514397088743d0*x32*x40 - x8*(0.0256800471981717d0*rho**( -1.3
     &3333333333333d0)*x3 + 0.00178055502507087d0*rho**( -0.666666666666
     &667d0)*x12 + x37)) + 0.402d0*x27 - 0.902d0)
      d2Ea(2) = x2*x43*(0.116191603961897d0*rho**(-2.33333333333333d0)*x
     &22*x49 - 0.0508817422685465d0*rho**(-1.66666666666667d0)*x22*x50 -
     & sigma* x19*x27*x48*x51 + x21*x51*(-x35 + x36 + x38))
      d2Ea(3) = -0.0579616051406596d0*rho**(-3.33333333333333d0)*x19**2*
     &x47*x49/(mu**6* x24**3)
      end subroutine


C*****************************************************************************
      pure subroutine ESRX_SPIN_PBE_GWS_ERF_case_1(rho_a, rho_b, sigma_a
     &a, sigma_ab, sigma_bb, mu, E)
C*****************************************************************************
C   Implemented by YingXing Cheng.
C
C   Subroutine generated using Sympy 1.4
C   Generated: January 16, 2022
C*****************************************************************************
      implicit none
      real*8, intent(in) :: rho_a, rho_b, sigma_aa, sigma_ab, sigma_bb, 
     &mu
      real*8, intent(out) :: E
      real*8 :: x0, x1, x2, x3, x4, x5, x6, x7, x8
      E = 0.0d0
      x0 = rho_a**1.33333333333333d0
      x1 = 49.1113297378199d0*mu
      x2 = 0.233951463049512d0*mu**4
      x3 = 0.217336917462899d0
      x4 = mu**2*x3
      x5 = rho_a**(-0.666666666666667d0)*x4
      x6 = 0.239205142311446d0*x3
      x7 = rho_b**1.33333333333333d0
      x8 = rho_b**(-0.666666666666667d0)*x4
      E = -0.9305257363491d0*(x0*(1.804d0 - 0.804d0/(rho_a**(-2.66666666
     &666667d0)* sigma_aa*x6*(5.45136177849642d0*x5 - 7.0d0)*exp( -1.438
     &5538026587772d0*x5)/(rho_a**(-0.333333333333333d0)*x1 - 49.0622560
     &064678d0*x5 - 81.0d0 + x2/x0) + 1.0d0)) + x7*(1.804d0 - 0.804d0/(r
     &ho_b**(-2.66666666666667d0)*sigma_bb*x6*( 5.45136177849642d0*x8 - 
     &7.0d0)*exp(-1.4385538026587772d0*x8)/( rho_b**(-0.333333333333333d
     &0)*x1 + x2/x7 - 49.0622560064678d0*x8 - 81.0d0) + 1.0d0)))/(rho_a 
     &+ rho_b)
      end subroutine


C*****************************************************************************
      pure subroutine ESRX_SPIN_PBE_GWS_ERF_case_2_1(rho_a, rho_b, sigma
     &_aa, sigma_ab, sigma_bb, mu, E)
C*****************************************************************************
C   Implemented by YingXing Cheng.
C
C   Subroutine generated using Sympy 1.4
C   Generated: January 16, 2022
C*****************************************************************************
      implicit none
      real*8, intent(in) :: rho_a, rho_b, sigma_aa, sigma_ab, sigma_bb, 
     &mu
      real*8, intent(out) :: E
      real*8 :: x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x
     &13, x14, x15, x16, x17, x18, x19, x20, x21, x22, x23, x24, x25, x2
     &6, x27, x28, x29, x30
      E = 0.0d0
      x0 = rho_a**1.33333333333333d0
      x1 = rho_a**0.333333333333333d0
      x2 = 1d0/x1
      x3 = mu*x2
      x4 = 49.1113297378198d0
      x5 = 0.233951463049512d0*mu**4
      x6 = rho_a**0.666666666666667d0
      x7 = 4.60115111447049d0
      x8 = 1d0/x7
      x9 = mu**2
      x10 = x8*x9
      x11 = x10/x6
      x12 = 0.239205142311446d0*x8
      x13 = 2.14502939711103d0
      x14 = 1d0/x13
      x15 = 0.825481812223657d0*x14
      x16 = mu**3
      x17 = 0.00844343197019481d0
      x18 = 1d0/rho_a*x17
      x19 = 1.77245385090552d0
      x20 = 1.81712059283214d0*x13/mu
      x21 = 3.30192724889463d0*x7/x9
      x22 = 0.550321208149104d0*x14
      x23 = 0.275160604074552d0*x14
      x24 = rho_b**1.33333333333333d0
      x25 = rho_b**0.333333333333333d0
      x26 = 1d0/x25
      x27 = mu*x26
      x28 = rho_b**0.666666666666667d0
      x29 = x10/x28
      x30 = 1d0/rho_b*x17
      E = 2.4814019635976d0*(x0*(1.804d0 - 0.804d0/(rho_a**(-2.666666666
     &66667d0)* sigma_aa*x12*(5.45136177849642d0*x11 - 7.0d0)*exp( -1.43
     &85538026587772d0*x11)/(-49.0622560064678d0*x11 + x3*x4 - 81.0d0 + 
     &x5/x0) + 1.0d0))*(x23*x3*(mu*(-x18*x9 + x2*x22)*exp(-x21 *x6) - x1
     &5*x3 + x16*x18 + x19*erf(x1*x20)) - 0.375d0) + x24*( 1.804d0 - 0.8
     &04d0/(rho_b**(-2.66666666666667d0)*sigma_bb*x12*( 5.45136177849642
     &d0*x29 - 7.0d0)*exp(-1.4385538026587772d0*x29)/( x27*x4 - 49.06225
     &60064678d0*x29 - 81.0d0 + x5/x24) + 1.0d0))*(x23 *x27*(mu*(x22*x26
     & - x30*x9)*exp(-x21*x28) - x15*x27 + x16*x30 + x19*erf(x20*x25)) -
     & 0.375d0))/(rho_a + rho_b)
      end subroutine


C*****************************************************************************
      pure subroutine ESRX_SPIN_PBE_GWS_ERF_case_2_2(rho_a, rho_b, sigma
     &_aa, sigma_ab, sigma_bb, mu, E)
C*****************************************************************************
C   Implemented by YingXing Cheng.
C
C   Subroutine generated using Sympy 1.4
C   Generated: January 16, 2022
C*****************************************************************************
      implicit none
      real*8, intent(in) :: rho_a, rho_b, sigma_aa, sigma_ab, sigma_bb, 
     &mu
      real*8, intent(out) :: E
      real*8 :: x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x
     &13, x14, x15, x16, x17, x18, x19, x20, x21, x22, x23, x24, x25, x2
     &6, x27, x28, x29
      E = 0.0d0
      x0 = rho_a**1.33333333333333d0
      x1 = rho_a**0.666666666666667d0
      x2 = 4.60115111447049d0
      x3 = 0.183440402716368d0*x2
      x4 = mu**2
      x5 = 1d0/x4
      x6 = 0.213719543995407d0*x5
      x7 = 14.4026298885989d0/mu**4
      x8 = 1d0/x2
      x9 = 1.43855380265878d0*x4*x8
      x10 = 0.239205142311446d0*x5*x8
      x11 = rho_a**0.333333333333333d0
      x12 = 1d0/x11
      x13 = 2.14502939711103d0
      x14 = 1d0/x13
      x15 = mu*x14
      x16 = 0.825481812223657d0*x15
      x17 = mu**3
      x18 = 0.00844343197019481d0
      x19 = 1d0/rho_a*x18
      x20 = 1.77245385090552d0
      x21 = 1.81712059283214d0*x13/mu
      x22 = 3.30192724889463d0*x2*x5
      x23 = 0.550321208149104d0*x14
      x24 = 0.275160604074552d0*x15
      x25 = rho_b**1.33333333333333d0
      x26 = rho_b**0.666666666666667d0
      x27 = rho_b**0.333333333333333d0
      x28 = 1d0/x27
      x29 = 1d0/rho_b*x18
      E = 2.4814019635976d0*(x0*(1.804d0 - 0.804d0/(-rho_a**(-2.66666666
     &666667d0)* sigma_aa*x10*(rho_a**2.0d0*x7 + x0*x6 - x1*x3)*exp(-x9/
     &x1) + 1.0d0))*(x12*x24*(mu*(x12*x23 - x19*x4)*exp(-x1*x22) - x12*x
     &16 + x17*x19 + x20*erf(x11*x21)) - 0.375d0) + x25*(1.804d0 - 0.804
     &d0/( -rho_b**(-2.66666666666667d0)*sigma_bb*x10*(rho_b**2.0d0*x7 +
     & x25 *x6 - x26*x3)*exp(-x9/x26) + 1.0d0))*(x24*x28*(mu*(x23*x28 - 
     &x29* x4)*exp(-x22*x26) - x16*x28 + x17*x29 + x20*erf(x21*x27)) - 0
     &.375d0))/(rho_a + rho_b)
      end subroutine


C*****************************************************************************
      pure subroutine ESRX_SPIN_PBE_GWS_ERF_case_2_3(rho_a, rho_b, sigma
     &_aa, sigma_ab, sigma_bb, mu, E)
C*****************************************************************************
C   Implemented by YingXing Cheng.
C
C   Subroutine generated using Sympy 1.4
C   Generated: January 16, 2022
C*****************************************************************************
      implicit none
      real*8, intent(in) :: rho_a, rho_b, sigma_aa, sigma_ab, sigma_bb, 
     &mu
      real*8, intent(out) :: E
      real*8 :: x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x
     &13, x14, x15, x16, x17, x18, x19, x20, x21, x22, x23, x24, x25, x2
     &6, x27, x28, x29, x30, x31, x32, x33, x34, x35, x36, x37, x38, x39
     &, x40, x41, x42, x43, x44
      E = 0.0d0
      x0 = rho_a**1.33333333333333d0
      x1 = rho_a**0.333333333333333d0
      x2 = 1d0/x1
      x3 = 2.14502939711103d0
      x4 = 1d0/x3
      x5 = mu*x4
      x6 = 0.825481812223657d0*x5
      x7 = mu**3
      x8 = 0.00844343197019481d0
      x9 = 1d0/rho_a*x8
      x10 = 1.77245385090552d0
      x11 = 1.81712059283214d0*x3/mu
      x12 = erf(x1*x11)
      x13 = rho_a**0.666666666666667d0
      x14 = 4.60115111447049d0
      x15 = mu**2
      x16 = 1d0/x15
      x17 = 3.30192724889463d0*x14*x16
      x18 = x13*x17
      x19 = 0.550321208149104d0*x4
      x20 = 0.275160604074552d0*x5
      x21 = exp(x18)
      x22 = 3.0d0*x21
      x23 = 0.0472353356922751d0*mu**4
      x24 = 0.183440402716368d0*x23
      x25 = (x21 - 1.0d0)/x0
      x26 = 1d0/x13
      x27 = x15/x14
      x28 = x26*x27
      x29 = 3.90167577847542d0*x5
      x30 = 0.015286700226364d0*x23
      x31 = 1.43855380265878d0*x27
      x32 = 3.15935190989552d0*x16
      x33 = rho_b**1.33333333333333d0
      x34 = rho_b**0.333333333333333d0
      x35 = 1d0/x34
      x36 = 1d0/rho_b*x8
      x37 = erf(x11*x34)
      x38 = rho_b**0.666666666666667d0
      x39 = x17*x38
      x40 = exp(x39)
      x41 = 3.0d0*x40
      x42 = (x40 - 1.0d0)/x33
      x43 = 1d0/x38
      x44 = x27*x43
      E = 2.4814019635976d0*(x0*(1.804d0 - 0.804d0/(-rho_a**(-2.0d0)*sig
     &ma_aa*x32* (-x25*x30 + 0.00280419844572861d0*x28*(7.0d0*x21 + 11.0
     &d0) + 0.0185185185185185d0)*exp(-x26*x31)/(x12*x2*x21*x29 - x22 + 
     &x24* x25 - 0.60570686427738d0*x28*(x22 - 2.0d0)) + 1.0d0))*(x2*x20
     &*(mu *(-x15*x9 + x19*x2)*exp(-x18) + x10*x12 - x2*x6 + x7*x9) - 0.
     &375d0) + x33*(1.804d0 - 0.804d0/(-rho_b**(-2.0d0)*sigma_bb*x32* (-
     &x30*x42 + 0.00280419844572861d0*x44*(7.0d0*x40 + 11.0d0) + 0.01851
     &85185185185d0)*exp(-x31*x43)/(x24*x42 + x29*x35*x37*x40 - x41 - 0.
     &60570686427738d0*x44*(x41 - 2.0d0)) + 1.0d0))*(x20*x35*( mu*(-x15*
     &x36 + x19*x35)*exp(-x39) + x10*x37 - x35*x6 + x36*x7) - 0.375d0))/
     &(rho_a + rho_b)
      end subroutine


C*****************************************************************************
      pure subroutine ESRX_SPIN_PBE_GWS_ERF_case_3(rho_a, rho_b, sigma_a
     &a, sigma_ab, sigma_bb, mu, E)
C*****************************************************************************
C   Implemented by YingXing Cheng.
C
C   Subroutine generated using Sympy 1.4
C   Generated: January 16, 2022
C*****************************************************************************
      implicit none
      real*8, intent(in) :: rho_a, rho_b, sigma_aa, sigma_ab, sigma_bb, 
     &mu
      real*8, intent(out) :: E
      real*8 :: x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12
      E = 0.0d0
      x0 = mu**2
      x1 = 1d0/x0
      x2 = rho_a**2.0d0
      x3 = rho_a**0.666666666666667d0
      x4 = 4.60115111447049d0
      x5 = 0.183440402716368d0*x4
      x6 = 0.213719543995407d0*x1
      x7 = 14.4026298885989d0/mu**4
      x8 = 1d0/x4
      x9 = 1.43855380265878d0*x0*x8
      x10 = 0.239205142311446d0*x1*x8
      x11 = rho_b**2.0d0
      x12 = rho_b**0.666666666666667d0
      E = -1.5707963267949d0*x1*(x11*(1.804d0 - 0.804d0/(-rho_b**( -2.66
     &666666666667d0)*sigma_bb*x10*(rho_b**1.33333333333333d0*x6 + x11*x
     &7 - x12*x5)*exp(-x9/x12) + 1.0d0)) + x2*(1.804d0 - 0.804d0/( -rho_
     &a**(-2.66666666666667d0)*sigma_aa*x10*(rho_a** 1.33333333333333d0*
     &x6 + x2*x7 - x3*x5)*exp(-x9/x3) + 1.0d0)))/( rho_a + rho_b)
      end subroutine


C*****************************************************************************
      pure subroutine D1ESRX_SPIN_PBE_GWS_ERF_case_1(rho_a, rho_b, sigma
     &_aa, sigma_ab, sigma_bb, mu, E, d1E)
C*****************************************************************************
C   Implemented by YingXing Cheng.
C
C   Subroutine generated using Sympy 1.4
C   Generated: January 16, 2022
C*****************************************************************************
      implicit none
      real*8, intent(in) :: rho_a, rho_b, sigma_aa, sigma_ab, sigma_bb, 
     &mu
      real*8, intent(out) :: E, d1E(9)
      real*8 :: x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x
     &13, x14, x15, x16, x17, x18, x19, x20, x21, x22, x23, x24, x25, x2
     &6, x27, x28, x29, x30, x31, x32, x33, x34, x35, x36, x37, x38, x39
     &, x40, x41, x42
      E = 0.0d0
      d1E(:) = 0.0d0
      x0 = 0.682784063255296d0
      x1 = rho_a**1.33333333333333d0
      x2 = 0.217336917462899d0
      x3 = 0.239205142311446d0*x2
      x4 = 0.826307487110758d0
      x5 = 59.4346904801033d0*mu*x4
      x6 = 1d0/x1
      x7 = 0.0472353356922751d0
      x8 = 4.95289087334194d0*mu**4*x7
      x9 = mu**2
      x10 = x2*x9
      x11 = rho_a**(-0.666666666666667d0)*x10
      x12 = 1d0/(rho_a**(-0.333333333333333d0)*x5 - 49.0622560064678d0*x
     &11 + x6*x8 - 81.0d0)
      x13 = exp(-1.4385538026587772d0*x11)
      x14 = sigma_aa*x12*x13
      x15 = 5.45136177849642d0*x11 - 7.0d0
      x16 = rho_a**(-2.66666666666667d0)*x15
      x17 = x14*x16*x3 + 1.0d0
      x18 = 1.804d0 - 0.804d0/x17
      x19 = rho_b**1.33333333333333d0
      x20 = rho_b**(-0.666666666666667d0)*x10
      x21 = 5.45136177849642d0*x20 - 7.0d0
      x22 = 1d0/x19
      x23 = 1d0/(rho_b**(-0.333333333333333d0)*x5 - 49.0622560064678d0*x
     &20 + x22*x8 - 81.0d0)
      x24 = rho_b**(-2.66666666666667d0)*x21*x23
      x25 = exp(-1.4385538026587772d0*x20)
      x26 = sigma_bb*x25
      x27 = x24*x26*x3 + 1.0d0
      x28 = 1.804d0 - 0.804d0/x27
      x29 = x17**(-2)
      x30 = rho_a**(-4.33333333333333d0)
      x31 = x7*x9
      x32 = 0.869329180010942d0*x31
      x33 = 0.637880379497189d0*x2
      x34 = 0.229406311391776d0*x31
      x35 = 19.8115634933678d0*x4
      x36 = mu*x2
      x37 = 32.7081706709785d0*x36
      x38 = 6.60385449778925d0*mu**3*x7
      x39 = 0.239205142311446d0*x36
      x40 = rho_b**(-4.33333333333333d0)
      x41 = x23/x27**2
      x42 = 0.0388945232753187d0
      E = -1.3628404446241d0*x0*(x1*x18 + x19*x28)/(rho_a + rho_b)
      d1E(1) = -x0*(1.81712059283214d0*rho_a**0.333333333333333d0*x18 + 
     &1.09572371747778d0*x1*x14*x29*(-rho_a**(-3.66666666666667d0)*x15* 
     &x33 + x12*x16*x39*(rho_a**(-2.33333333333333d0)*x38 - rho_a**( -1.
     &66666666666667d0)*x37 + x35*x6) + x15*x30*x34 - x30*x32))
      d1E(2) = -x0*(1.81712059283214d0*rho_b**0.333333333333333d0*x28 + 
     &1.09572371747778d0*x19*x26*x41*(-rho_b**(-3.66666666666667d0)*x21 
     &*x33 + x21*x34*x40 + x24*x39*(rho_b**(-2.33333333333333d0)*x38 - r
     &ho_b**(-1.66666666666667d0)*x37 + x22*x35) - x32*x40))
      d1E(3) = -x12*x13*x15*x29*x42*x6
      d1E(4) = 0
      d1E(5) = -x21*x22*x25*x41*x42
      end subroutine


C*****************************************************************************
      pure subroutine D1ESRX_SPIN_PBE_GWS_ERF_case_2_1(rho_a, rho_b, sig
     &ma_aa, sigma_ab, sigma_bb, mu, E, d1E)
C*****************************************************************************
C   Implemented by YingXing Cheng.
C
C   Subroutine generated using Sympy 1.4
C   Generated: January 16, 2022
C*****************************************************************************
      implicit none
      real*8, intent(in) :: rho_a, rho_b, sigma_aa, sigma_ab, sigma_bb, 
     &mu
      real*8, intent(out) :: E, d1E(9)
      real*8 :: x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x
     &13, x14, x15, x16, x17, x18, x19, x20, x21, x22, x23, x24, x25, x2
     &6, x27, x28, x29, x30, x31, x32, x33, x34, x35, x36, x37, x38, x39
     &, x40, x41, x42, x43, x44, x45, x46, x47, x48, x49, x50, x51, x52,
     & x53, x54, x55, x56, x57, x58, x59, x60, x61, x62, x63, x64, x65, 
     &x66, x67, x68, x69, x70, x71, x72, x73, x74, x75, x76, x77, x78, x
     &79, x80, x81, x82, x83, x84, x85, x86, x87, x88, x89, x90, x91, x9
     &2, x93, x94, x95, x96
      E = 0.0d0
      d1E(:) = 0.0d0
      x0 = 0.682784063255296d0
      x1 = rho_a**1.33333333333333d0
      x2 = rho_a**(-2.66666666666667d0)
      x3 = 4.60115111447049d0
      x4 = 1d0/x3
      x5 = 0.239205142311446d0*x4
      x6 = rho_a**0.666666666666667d0
      x7 = mu**2
      x8 = x4*x7
      x9 = x8/x6
      x10 = 5.45136177849642d0*x9 - 7.0d0
      x11 = rho_a**0.333333333333333d0
      x12 = 1d0/x11
      x13 = mu*x12
      x14 = 0.826307487110758d0
      x15 = 59.4346904801033d0*x14
      x16 = 1d0/x1
      x17 = 0.0472353356922751d0
      x18 = 4.95289087334194d0*mu**4*x17
      x19 = 1d0/(x13*x15 + x16*x18 - 49.0622560064678d0*x9 - 81.0d0)
      x20 = exp(-1.4385538026587772d0*x9)
      x21 = x10*x19*x20
      x22 = sigma_aa*x2*x21*x5 + 1.0d0
      x23 = 1.804d0 - 0.804d0/x22
      x24 = 2.14502939711103d0
      x25 = 1d0/x24
      x26 = 0.550321208149104d0*x25
      x27 = x12*x26
      x28 = 0.00844343197019481d0
      x29 = 1d0/rho_a*x28
      x30 = x29*x7
      x31 = 3.30192724889463d0*x3/x7
      x32 = exp(-x31*x6)
      x33 = mu*x32
      x34 = 1.77245385090552d0
      x35 = 1d0/mu
      x36 = x24*x35
      x37 = 1.81712059283214d0*x36
      x38 = mu**3
      x39 = 0.825481812223657d0*x25
      x40 = -x13*x39 + x29*x38 + x34*erf(x11*x37)
      x41 = 0.275160604074552d0*x12
      x42 = mu*x25
      x43 = x41*x42
      x44 = x43*(x33*(x27 - x30) + x40) - 0.375d0
      x45 = x23*x44
      x46 = rho_b**1.33333333333333d0
      x47 = rho_b**0.666666666666667d0
      x48 = x8/x47
      x49 = 5.45136177849642d0*x48 - 7.0d0
      x50 = rho_b**0.333333333333333d0
      x51 = 1d0/x50
      x52 = mu*x51
      x53 = 1d0/x46
      x54 = 1d0/(x15*x52 + x18*x53 - 49.0622560064678d0*x48 - 81.0d0)
      x55 = rho_b**(-2.66666666666667d0)*x49*x54
      x56 = exp(-1.4385538026587772d0*x48)
      x57 = sigma_bb*x56
      x58 = x5*x55*x57 + 1.0d0
      x59 = 1.804d0 - 0.804d0/x58
      x60 = x26*x51
      x61 = 1d0/rho_b*x28
      x62 = x61*x7
      x63 = exp(-x31*x47)
      x64 = mu*x63
      x65 = x34*erf(x37*x50) + x38*x61 - x39*x52
      x66 = 0.275160604074552d0*x51
      x67 = x42*x66
      x68 = x67*(x64*(x60 - x62) + x65) - 0.375d0
      x69 = x59*x68
      x70 = 4.84565491421904d0*x0
      x71 = -x27 + x30
      x72 = -x33*x71 + x40
      x73 = 0.275160604074552d0*x42
      x74 = rho_a**(-2.0d0)*x28
      x75 = 1.21141372855476d0*x36
      x76 = 0.183440402716368d0*x25
      x77 = 2.20128483259642d0*x3*x35
      x78 = 1.15681489817324d0*mu
      x79 = x22**(-2)
      x80 = rho_a**(-4.33333333333333d0)
      x81 = x17*x7
      x82 = 0.869329180010942d0*x81
      x83 = 0.637880379497189d0*x4
      x84 = 0.229406311391776d0*x81
      x85 = 19.8115634933678d0*x14
      x86 = mu*x4
      x87 = 32.7081706709785d0*x86
      x88 = 6.60385449778925d0*x17*x38
      x89 = 0.239205142311446d0*x86
      x90 = 2.92192991327408d0*x0
      x91 = -x60 + x62
      x92 = -x64*x91 + x65
      x93 = rho_b**(-2.0d0)*x28
      x94 = rho_b**(-4.33333333333333d0)
      x95 = x54/x58**2
      x96 = 0.103718728734183d0
      E = 3.63424118566428d0*x0*(x1*x45 + x46*x69)/(rho_a + rho_b)
      d1E(1) = rho_a**0.333333333333333d0*x45*x70 + sigma_aa*x1*x19*x20*
     &x44*x79*x90*( -rho_a**(-3.66666666666667d0)*x10*x83 + x10*x19*x2*x
     &89*(rho_a**( -2.33333333333333d0)*x88 - rho_a**(-1.66666666666667d
     &0)*x87 + x16 *x85) + x10*x80*x84 - x80*x82) - x1*x23*x78*(0.091720
     &2013581841d0 *x16*x72 - x41*(rho_a**(-0.666666666666667d0)*x32*x75
     & + rho_a**( -0.333333333333333d0)*x32*x71*x77 + x16*x73 + x33*(-x1
     &6*x76 + x7* x74) - x38*x74))
      d1E(2) = rho_b**0.333333333333333d0*x69*x70 + x46*x57*x68*x90*x95*
     &(-rho_b**( -3.66666666666667d0)*x49*x83 + x49*x84*x94 + x55*x89*(r
     &ho_b**( -2.33333333333333d0)*x88 - rho_b**(-1.66666666666667d0)*x8
     &7 + x53 *x85) - x82*x94) - x46*x59*x78*(0.0917202013581841d0*x53*x
     &92 - x66*(rho_b**(-0.666666666666667d0)*x63*x75 + rho_b**( -0.3333
     &33333333333d0)*x63*x77*x91 - x38*x93 + x53*x73 + x64*(-x53 *x76 + 
     &x7*x93)))
      d1E(3) = x16*x21*x79*x96*(x43*x72 - 0.375d0)
      d1E(4) = 0
      d1E(5) = x49*x53*x56*x95*x96*(x67*x92 - 0.375d0)
      end subroutine


C*****************************************************************************
      pure subroutine D1ESRX_SPIN_PBE_GWS_ERF_case_2_2(rho_a, rho_b, sig
     &ma_aa, sigma_ab, sigma_bb, mu, E, d1E)
C*****************************************************************************
C   Implemented by YingXing Cheng.
C
C   Subroutine generated using Sympy 1.4
C   Generated: January 16, 2022
C*****************************************************************************
      implicit none
      real*8, intent(in) :: rho_a, rho_b, sigma_aa, sigma_ab, sigma_bb, 
     &mu
      real*8, intent(out) :: E, d1E(9)
      real*8 :: x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x
     &13, x14, x15, x16, x17, x18, x19, x20, x21, x22, x23, x24, x25, x2
     &6, x27, x28, x29, x30, x31, x32, x33, x34, x35, x36, x37, x38, x39
     &, x40, x41, x42, x43, x44, x45, x46, x47, x48, x49, x50, x51, x52,
     & x53, x54, x55, x56, x57, x58, x59, x60, x61, x62, x63, x64, x65, 
     &x66, x67, x68, x69, x70, x71, x72, x73, x74, x75, x76, x77, x78, x
     &79, x80, x81, x82, x83, x84, x85, x86, x87, x88, x89, x90, x91, x9
     &2, x93, x94, x95, x96, x97, x98, x99, x100, x101, x102, x103, x104
     &
      E = 0.0d0
      d1E(:) = 0.0d0
      x0 = 0.682784063255296d0
      x1 = rho_a**1.33333333333333d0
      x2 = rho_a**0.666666666666667d0
      x3 = 4.60115111447049d0
      x4 = 0.183440402716368d0*x3
      x5 = x2*x4
      x6 = 21.1705915781930d0
      x7 = mu**2
      x8 = 1d0/x7
      x9 = x6*x8
      x10 = 0.010095114404623d0*x9
      x11 = x1*x10
      x12 = rho_a**2.0d0
      x13 = 97.4090910340024d0/mu**4
      x14 = 0.147857142857143d0*x13
      x15 = x12*x14
      x16 = x11 + x15 - x5
      x17 = 1d0/x3
      x18 = x17*x8
      x19 = 0.239205142311446d0*x18
      x20 = rho_a**(-2.66666666666667d0)*x19
      x21 = 1.43855380265878d0*x17*x7
      x22 = exp(-x21/x2)
      x23 = sigma_aa*x22
      x24 = x16*x20*x23
      x25 = 1.0d0 - x24
      x26 = 1.804d0 - 0.804d0/x25
      x27 = rho_a**0.333333333333333d0
      x28 = 1d0/x27
      x29 = 2.14502939711103d0
      x30 = 1d0/x29
      x31 = 0.550321208149104d0*x30
      x32 = x28*x31
      x33 = rho_a**1.0d0
      x34 = 0.00844343197019481d0
      x35 = x34/x33
      x36 = x35*x7
      x37 = 3.30192724889463d0*x3*x8
      x38 = exp(-x2*x37)
      x39 = mu*x38
      x40 = 1.77245385090552d0
      x41 = 1d0/mu
      x42 = x29*x41
      x43 = 1.81712059283214d0*x42
      x44 = mu**3
      x45 = mu*x30
      x46 = 0.825481812223657d0*x45
      x47 = -x28*x46 + x35*x44 + x40*erf(x27*x43)
      x48 = 0.275160604074552d0*x28
      x49 = x45*x48
      x50 = x49*(x39*(x32 - x36) + x47) - 0.375d0
      x51 = x26*x50
      x52 = rho_b**1.33333333333333d0
      x53 = rho_b**0.666666666666667d0
      x54 = x4*x53
      x55 = x10*x52
      x56 = rho_b**2.0d0
      x57 = x14*x56
      x58 = -x54 + x55 + x57
      x59 = rho_b**(-2.66666666666667d0)*x19
      x60 = exp(-x21/x53)
      x61 = sigma_bb*x60
      x62 = x58*x59*x61
      x63 = 1.0d0 - x62
      x64 = 1.804d0 - 0.804d0/x63
      x65 = rho_b**0.333333333333333d0
      x66 = 1d0/x65
      x67 = x31*x66
      x68 = rho_b**1.0d0
      x69 = x34/x68
      x70 = x69*x7
      x71 = exp(-x37*x53)
      x72 = mu*x71
      x73 = x40*erf(x43*x65) + x44*x69 - x46*x66
      x74 = 0.275160604074552d0*x66
      x75 = x45*x74
      x76 = x75*(x72*(x67 - x70) + x73) - 0.375d0
      x77 = x64*x76
      x78 = rho_a**0.333333333333333d0
      x79 = 4.84565491421904d0*x0
      x80 = 1d0/x1
      x81 = -x32 + x36
      x82 = -x39*x81 + x47
      x83 = 0.275160604074552d0*x45
      x84 = x34/x12
      x85 = 1.21141372855476d0*x42
      x86 = 0.183440402716368d0*x30
      x87 = rho_a**(-0.333333333333333d0)
      x88 = 2.20128483259642d0*x3*x41
      x89 = 1.15681489817324d0*mu
      x90 = -x11 - x15 + x5
      x91 = 0.229406311391776d0/x6
      x92 = 0.637880379497189d0*x18
      x93 = 0.122293601810912d0*x3
      x94 = 0.0134601525394973d0*x9
      x95 = 0.295714285714286d0*x13
      x96 = 2.92192991327408d0*x0
      x97 = rho_b**0.333333333333333d0
      x98 = 1d0/x52
      x99 = -x67 + x70
      x100 = -x72*x99 + x73
      x101 = x34/x56
      x102 = rho_b**(-0.333333333333333d0)
      x103 = x54 - x55 - x57
      x104 = 0.103718728734183d0*x8
      E = 3.63424118566428d0*x0*(x1*x51 + x52*x77)/(rho_a + rho_b)
      d1E(1) = x1*x23*x50*x96*(rho_a**(-4.33333333333333d0)*x90*x91 - rh
     &o_a**( -3.66666666666667d0)*x90*x92 + x20*(-x33*x95 - x78*x94 + x8
     &7*x93 ))/x25**2 - x1*x26*x89*(-x48*(rho_a**(-0.666666666666667d0)*
     &x38* x85 + x38*x81*x87*x88 + x39*(x7*x84 - x80*x86) - x44*x84 + x8
     &0* x83) + 0.0917202013581841d0*x80*x82) + x51*x78*x79
      d1E(2) = x52*x61*x76*x96*(rho_b**(-4.33333333333333d0)*x103*x91 - 
     &rho_b**( -3.66666666666667d0)*x103*x92 + x59*(x102*x93 - x68*x95 -
     & x94*x97 ))/x63**2 - x52*x64*x89*(0.0917202013581841d0*x100*x98 - 
     &x74*( rho_b**(-0.666666666666667d0)*x71*x85 - x101*x44 + x102*x71*
     &x88* x99 + x72*(x101*x7 - x86*x98) + x83*x98)) + x77*x79*x97
      d1E(3) = -x104*x16*x22*x80*(x49*x82 - 0.375d0)/(x24 - 1.0d0)**2
      d1E(4) = 0
      d1E(5) = -x104*x58*x60*x98*(x100*x75 - 0.375d0)/(x62 - 1.0d0)**2
      end subroutine


C*****************************************************************************
      pure subroutine D1ESRX_SPIN_PBE_GWS_ERF_case_2_3(rho_a, rho_b, sig
     &ma_aa, sigma_ab, sigma_bb, mu, E, d1E)
C*****************************************************************************
C   Implemented by YingXing Cheng.
C
C   Subroutine generated using Sympy 1.4
C   Generated: January 16, 2022
C*****************************************************************************
      implicit none
      real*8, intent(in) :: rho_a, rho_b, sigma_aa, sigma_ab, sigma_bb, 
     &mu
      real*8, intent(out) :: E, d1E(9)
      real*8 :: x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x
     &13, x14, x15, x16, x17, x18, x19, x20, x21, x22, x23, x24, x25, x2
     &6, x27, x28, x29, x30, x31, x32, x33, x34, x35, x36, x37, x38, x39
     &, x40, x41, x42, x43, x44, x45, x46, x47, x48, x49, x50, x51, x52,
     & x53, x54, x55, x56, x57, x58, x59, x60, x61, x62, x63, x64, x65, 
     &x66, x67, x68, x69, x70, x71, x72, x73, x74, x75, x76, x77, x78, x
     &79, x80, x81, x82, x83, x84, x85, x86, x87, x88, x89, x90, x91, x9
     &2, x93, x94, x95, x96, x97, x98, x99, x100, x101, x102, x103, x104
     &, x105, x106, x107, x108, x109, x110, x111, x112, x113, x114, x115
     &, x116, x117, x118, x119, x120, x121, x122, x123, x124, x125, x126
     &, x127, x128, x129, x130, x131, x132, x133, x134, x135, x136, x137
     &, x138
      E = 0.0d0
      d1E(:) = 0.0d0
      x0 = 0.682784063255296d0
      x1 = rho_a**1.33333333333333d0
      x2 = 1d0/x1
      x3 = rho_a**0.666666666666667d0
      x4 = 4.60115111447049d0
      x5 = mu**2
      x6 = 1d0/x5
      x7 = x4*x6
      x8 = 3.30192724889463d0*x7
      x9 = x3*x8
      x10 = exp(x9)
      x11 = x10 - 1.0d0
      x12 = x11*x2
      x13 = 0.0472353356922751d0*mu**4
      x14 = 0.015286700226364d0*x13
      x15 = x12*x14
      x16 = 7.0d0*x10 + 11.0d0
      x17 = 1d0/x3
      x18 = 1d0/x4
      x19 = x18*x5
      x20 = x17*x19
      x21 = 0.00280419844572861d0*x16*x20
      x22 = -x15 + x21 + 0.0185185185185185d0
      x23 = 3.0d0*x10
      x24 = 0.183440402716368d0*x13
      x25 = x23 - 2.0d0
      x26 = rho_a**0.333333333333333d0
      x27 = 1d0/x26
      x28 = 2.14502939711103d0
      x29 = 1d0/x28
      x30 = mu*x29
      x31 = 3.90167577847542d0*x30
      x32 = 1d0/mu
      x33 = x28*x32
      x34 = 1.81712059283214d0*x33
      x35 = erf(x26*x34)
      x36 = x10*x35
      x37 = 1d0/(x12*x24 - 0.60570686427738d0*x20*x25 - x23 + x27*x31*x3
     &6)
      x38 = rho_a**(-2.0d0)
      x39 = 3.15935190989552d0*x6
      x40 = x38*x39
      x41 = x37*x40
      x42 = 1.43855380265878d0*x19
      x43 = exp(-x17*x42)
      x44 = sigma_aa*x43
      x45 = -x22*x41*x44 + 1.0d0
      x46 = 1.804d0 - 0.804d0/x45
      x47 = 0.550321208149104d0*x29
      x48 = x27*x47
      x49 = 1d0/rho_a
      x50 = 0.00844343197019481d0
      x51 = x49*x50
      x52 = x5*x51
      x53 = exp(-x9)
      x54 = mu*x53
      x55 = 1.77245385090552d0
      x56 = mu**3
      x57 = 0.825481812223657d0*x30
      x58 = -x27*x57 + x35*x55 + x51*x56
      x59 = 0.275160604074552d0*x27
      x60 = x30*x59
      x61 = x60*(x54*(x48 - x52) + x58) - 0.375d0
      x62 = x46*x61
      x63 = rho_b**1.33333333333333d0
      x64 = 1d0/x63
      x65 = rho_b**0.666666666666667d0
      x66 = x65*x8
      x67 = exp(x66)
      x68 = x67 - 1.0d0
      x69 = x64*x68
      x70 = x14*x69
      x71 = 7.0d0*x67 + 11.0d0
      x72 = 1d0/x65
      x73 = x19*x72
      x74 = 0.00280419844572861d0*x71*x73
      x75 = -x70 + x74 + 0.0185185185185185d0
      x76 = 3.0d0*x67
      x77 = x76 - 2.0d0
      x78 = rho_b**0.333333333333333d0
      x79 = 1d0/x78
      x80 = erf(x34*x78)
      x81 = x67*x80
      x82 = 1d0/(x24*x69 + x31*x79*x81 - 0.60570686427738d0*x73*x77 - x7
     &6)
      x83 = rho_b**(-2.0d0)
      x84 = x39*x83
      x85 = x82*x84
      x86 = exp(-x42*x72)
      x87 = sigma_bb*x86
      x88 = -x75*x85*x87 + 1.0d0
      x89 = 1.804d0 - 0.804d0/x88
      x90 = x47*x79
      x91 = 1d0/rho_b
      x92 = x50*x91
      x93 = x5*x92
      x94 = exp(-x66)
      x95 = mu*x94
      x96 = x55*x80 + x56*x92 - x57*x79
      x97 = 0.275160604074552d0*x79
      x98 = x30*x97
      x99 = x98*(x95*(x90 - x93) + x96) - 0.375d0
      x100 = x89*x99
      x101 = 4.84565491421904d0*x0
      x102 = -x48 + x52
      x103 = -x102*x54 + x58
      x104 = 0.275160604074552d0*x30
      x105 = x38*x50
      x106 = rho_a**(-0.666666666666667d0)
      x107 = 1.21141372855476d0*x33
      x108 = 0.183440402716368d0*x29
      x109 = rho_a**(-0.333333333333333d0)
      x110 = 2.20128483259642d0*x32*x4
      x111 = 1.15681489817324d0*mu
      x112 = x15 - x21 - 0.0185185185185185d0
      x113 = 3.02993180261165d0*x18
      x114 = 6.31870381979104d0*x6
      x115 = x10*x49
      x116 = rho_a**(-1.66666666666667d0)*x19
      x117 = x10*x116
      x118 = 0.0203822669684853d0*x13
      x119 = rho_a**(-2.33333333333333d0)*x11
      x120 = 2.66666666666667d0
      x121 = 6.60385449778925d0*x7
      x122 = 0.244587203621824d0*x13
      x123 = 1.30055859282514d0*x30
      x124 = 8.58869971286677d0*x33
      x125 = 2.92192991327408d0*x0
      x126 = x37/x45**2
      x127 = -x90 + x93
      x128 = -x127*x95 + x96
      x129 = x50*x83
      x130 = rho_b**(-0.666666666666667d0)
      x131 = rho_b**(-0.333333333333333d0)
      x132 = x70 - x74 - 0.0185185185185185d0
      x133 = x67*x91
      x134 = rho_b**(-1.66666666666667d0)*x19
      x135 = x134*x67
      x136 = rho_b**(-2.33333333333333d0)*x68
      x137 = x82/x88**2
      x138 = 9.23140485208332d0*x0*x6
      E = 3.63424118566428d0*x0*(x1*x62 + x100*x63)/(rho_a + rho_b)
      d1E(1) = rho_a**0.333333333333333d0*x101*x62 - x1*x111*x46*(0.0917
     &202013581841d0* x103*x2 - x59*(x102*x109*x110*x53 + x104*x2 - x105
     &*x56 + x106* x107*x53 + x54*(x105*x5 - x108*x2))) + x1*x125*x126*x
     &44*x61*( rho_a**(-3.66666666666667d0)*x112*x113 - rho_a**(-3.0d0)*
     &x112* x114 + x112*x41*(x10*x109*x121 - x106*x124*x36 + 4.0d0*x115 
     &- 0.40380457618492d0*x116*x25 - 0.40380457618492d0*x117 + x119*x12
     &2 - x120*x49 + x123*x2*x36) + x40*(-0.0432098765432099d0*x115 + 0.
     &00186946563048574d0*x116*x16 + 0.0336503813487433d0*x117 - x118 *x
     &119))
      d1E(2) = rho_b**0.333333333333333d0*x100*x101 - x111*x63*x89*( 0.0
     &917202013581841d0*x128*x64 - x97*(x104*x64 + x107*x130*x94 + x110*
     &x127*x131*x94 - x129*x56 + x95*(-x108*x64 + x129*x5))) + x125*x137
     &*x63*x87*x99*(rho_b**(-3.66666666666667d0)*x113*x132 - rho_b**(-3.
     &0d0)*x114*x132 + x132*x85*(-x120*x91 + x121*x131*x67 + x122*x136 +
     & x123*x64*x81 - x124*x130*x81 + 4.0d0*x133 - 0.40380457618492d0*x1
     &34*x77 - 0.40380457618492d0*x135) + x84*( -x118*x136 - 0.043209876
     &5432099d0*x133 + 0.00186946563048574d0* x134*x71 + 0.0336503813487
     &433d0*x135))
      d1E(3) = -x106*x126*x138*x22*x43*(x103*x60 - 0.375d0)
      d1E(4) = 0
      d1E(5) = -x130*x137*x138*x75*x86*(x128*x98 - 0.375d0)
      end subroutine


C*****************************************************************************
      pure subroutine D1ESRX_SPIN_PBE_GWS_ERF_case_3(rho_a, rho_b, sigma
     &_aa, sigma_ab, sigma_bb, mu, E, d1E)
C*****************************************************************************
C   Implemented by YingXing Cheng.
C
C   Subroutine generated using Sympy 1.4
C   Generated: January 16, 2022
C*****************************************************************************
      implicit none
      real*8, intent(in) :: rho_a, rho_b, sigma_aa, sigma_ab, sigma_bb, 
     &mu
      real*8, intent(out) :: E, d1E(9)
      real*8 :: x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x
     &13, x14, x15, x16, x17, x18, x19, x20, x21, x22, x23, x24, x25, x2
     &6, x27, x28, x29, x30, x31, x32, x33, x34, x35, x36, x37, x38, x39
     &, x40, x41, x42, x43, x44, x45, x46, x47, x48
      E = 0.0d0
      d1E(:) = 0.0d0
      x0 = rho_a**2.0d0
      x1 = rho_a**0.666666666666667d0
      x2 = 4.60115111447049d0
      x3 = 0.183440402716368d0*x2
      x4 = x1*x3
      x5 = mu**2
      x6 = 1d0/x5
      x7 = 21.1705915781930d0
      x8 = x6*x7
      x9 = 0.010095114404623d0*x8
      x10 = rho_a**1.33333333333333d0*x9
      x11 = mu**(-4)
      x12 = 97.4090910340024d0*x11
      x13 = 0.147857142857143d0*x12
      x14 = x0*x13
      x15 = x10 + x14 - x4
      x16 = 1d0/x2
      x17 = x16*x6
      x18 = 0.239205142311446d0*x17
      x19 = rho_a**(-2.66666666666667d0)*x18
      x20 = 1.43855380265878d0*x16*x5
      x21 = exp(-x20/x1)
      x22 = sigma_aa*x21
      x23 = x15*x19*x22
      x24 = 1.0d0 - x23
      x25 = 1.804d0 - 0.804d0/x24
      x26 = rho_b**2.0d0
      x27 = rho_b**0.666666666666667d0
      x28 = x27*x3
      x29 = rho_b**1.33333333333333d0*x9
      x30 = x13*x26
      x31 = -x28 + x29 + x30
      x32 = rho_b**(-2.66666666666667d0)*x18
      x33 = exp(-x20/x27)
      x34 = sigma_bb*x33
      x35 = x31*x32*x34
      x36 = 1.0d0 - x35
      x37 = 1.804d0 - 0.804d0/x36
      x38 = 3.14159265358979d0*x6
      x39 = rho_a**1.0d0
      x40 = -x10 - x14 + x4
      x41 = 0.229406311391776d0/x7
      x42 = 0.637880379497189d0*x17
      x43 = 0.122293601810912d0*x2
      x44 = 0.0134601525394973d0*x8
      x45 = 0.295714285714286d0*x12
      x46 = rho_b**1.0d0
      x47 = x28 - x29 - x30
      x48 = 0.0656568345256261d0*x11
      E = -0.5d0*x38*(x0*x25 + x26*x37)/(rho_a + rho_b)
      d1E(1) = -x38*(0.402d0*x0*x22*(rho_a**(-4.33333333333333d0)*x40*x4
     &1 - rho_a**( -3.66666666666667d0)*x40*x42 + x19*(rho_a**(-0.333333
     &333333333d0) *x43 - rho_a**0.333333333333333d0*x44 - x39*x45))/x24
     &**2 + 1.0d0* x25*x39)
      d1E(2) = -x38*(0.402d0*x26*x34*(rho_b**(-4.33333333333333d0)*x41*x
     &47 - rho_b**( -3.66666666666667d0)*x42*x47 + x32*(rho_b**(-0.33333
     &3333333333d0) *x43 - rho_b**0.333333333333333d0*x44 - x45*x46))/x3
     &6**2 + 1.0d0* x37*x46)
      d1E(3) = rho_a**(-0.666666666666667d0)*x15*x21*x48/(x23 - 1.0d0)**
     &2
      d1E(4) = 0
      d1E(5) = rho_b**(-0.666666666666667d0)*x31*x33*x48/(x35 - 1.0d0)**
     &2
      end subroutine


C*****************************************************************************
      pure subroutine D2ESRX_SPIN_PBE_GWS_ERF_case_1(rho_a, rho_b, sigma
     &_aa, sigma_ab, sigma_bb, mu, E, d1E, d2E)
C*****************************************************************************
C   Implemented by YingXing Cheng.
C
C   Subroutine generated using Sympy 1.4
C   Generated: January 16, 2022
C*****************************************************************************
      implicit none
      real*8, intent(in) :: rho_a, rho_b, sigma_aa, sigma_ab, sigma_bb, 
     &mu
      real*8, intent(out) :: E, d1E(9), d2E(45)
      real*8 :: x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x
     &13, x14, x15, x16, x17, x18, x19, x20, x21, x22, x23, x24, x25, x2
     &6, x27, x28, x29, x30, x31, x32, x33, x34, x35, x36, x37, x38, x39
     &, x40, x41, x42, x43, x44, x45, x46, x47, x48, x49, x50, x51, x52,
     & x53, x54, x55, x56, x57, x58, x59, x60, x61, x62, x63, x64, x65, 
     &x66, x67, x68, x69, x70, x71, x72, x73, x74, x75, x76, x77, x78, x
     &79, x80, x81, x82, x83, x84, x85, x86, x87, x88, x89, x90, x91, x9
     &2, x93, x94, x95, x96, x97, x98, x99, x100, x101, x102, x103, x104
     &, x105, x106, x107, x108, x109, x110, x111, x112, x113, x114, x115
     &, x116, x117, x118
      E = 0.0d0
      d1E(:) = 0.0d0
      d2E(:) = 0.0d0
      x0 = 0.682784063255296d0
      x1 = rho_a**1.33333333333333d0
      x2 = rho_a**(-2.66666666666667d0)
      x3 = 0.217336917462899d0
      x4 = mu**2
      x5 = x3*x4
      x6 = rho_a**(-0.666666666666667d0)*x5
      x7 = 5.45136177849642d0*x6 - 7.0d0
      x8 = exp(-1.4385538026587772d0*x6)
      x9 = x7*x8
      x10 = 0.239205142311446d0*x3
      x11 = 0.826307487110758d0
      x12 = 59.4346904801033d0*mu*x11
      x13 = 1d0/x1
      x14 = 0.0472353356922751d0
      x15 = mu**4
      x16 = 4.95289087334194d0*x14*x15
      x17 = rho_a**(-0.333333333333333d0)*x12 + x13*x16 - 49.06225600646
     &78d0*x6 - 81.0d0
      x18 = 1d0/x17
      x19 = sigma_aa*x18
      x20 = x10*x19*x2*x9 + 1.0d0
      x21 = 1d0/x20
      x22 = 1.804d0 - 0.804d0*x21
      x23 = rho_b**1.33333333333333d0
      x24 = rho_b**(-0.666666666666667d0)*x5
      x25 = 5.45136177849642d0*x24 - 7.0d0
      x26 = exp(-1.4385538026587772d0*x24)
      x27 = x25*x26
      x28 = 1d0/x23
      x29 = rho_b**(-0.333333333333333d0)*x12 + x16*x28 - 49.06225600646
     &78d0*x24 - 81.0d0
      x30 = 1d0/x29
      x31 = rho_b**(-2.66666666666667d0)
      x32 = x30*x31
      x33 = sigma_bb*x10*x27*x32 + 1.0d0
      x34 = 1d0/x33
      x35 = 1.804d0 - 0.804d0*x34
      x36 = rho_a**0.333333333333333d0
      x37 = rho_a**(-4.33333333333333d0)
      x38 = x14*x4
      x39 = 0.869329180010942d0*x38
      x40 = 0.637880379497189d0*x3
      x41 = rho_a**(-3.66666666666667d0)*x7
      x42 = 0.229406311391776d0*x38
      x43 = x37*x7
      x44 = 19.8115634933678d0*x11
      x45 = rho_a**(-1.66666666666667d0)
      x46 = mu*x3
      x47 = 32.7081706709785d0*x46
      x48 = rho_a**(-2.33333333333333d0)
      x49 = mu**3*x14
      x50 = 6.60385449778925d0*x49
      x51 = x13*x44 - x45*x47 + x48*x50
      x52 = x18*x51
      x53 = 0.239205142311446d0*x46
      x54 = x2*x7
      x55 = x53*x54
      x56 = -x37*x39 - x40*x41 + x42*x43 + x52*x55
      x57 = 1.09572371747778d0*x1*x56
      x58 = x18/x20**2
      x59 = sigma_aa*x58*x8
      x60 = rho_b**0.333333333333333d0
      x61 = rho_b**(-4.33333333333333d0)
      x62 = rho_b**(-3.66666666666667d0)*x25
      x63 = x25*x61
      x64 = x25*x53
      x65 = rho_b**(-1.66666666666667d0)
      x66 = rho_b**(-2.33333333333333d0)
      x67 = x28*x44 - x47*x65 + x50*x66
      x68 = x30*x67
      x69 = x31*x68
      x70 = -x39*x61 - x40*x62 + x42*x63 + x64*x69
      x71 = 1.09572371747778d0*x23*x70
      x72 = x30/x33**2
      x73 = sigma_bb*x26*x72
      x74 = 0.148394183600699d0
      x75 = 0.262102747773299d0*x74
      x76 = x13*x75
      x77 = x76*x9
      x78 = x28*x75
      x79 = x27*x78
      x80 = 1.73865836002188d0*x38
      x81 = 1.27576075899438d0*x3
      x82 = 0.458812622783553d0*x38
      x83 = x46*x52
      x84 = -x37*x80 - x41*x81 + x43*x82 + 0.478410284622892d0*x54*x83
      x85 = x17**(-2)
      x86 = exp(-2.8771076053175544d0*x6)
      x87 = x85*x86/x20**3
      x88 = rho_a**(-6.0d0)
      x89 = 0.0102659822546843d0*x15
      x90 = 1.66743573022264d0*x89
      x91 = rho_a**(-5.33333333333333d0)
      x92 = 6.08530426007659d0*x38
      x93 = 2.33889472482303d0*x3
      x94 = 0.220008881071042d0*x89
      x95 = 1.60584417974243d0*x38
      x96 = 1.73865836002188d0*x49
      x97 = 26.415417991157d0*x11
      x98 = 54.5136177849642d0*x46
      x99 = 15.4089938281749d0*x49
      x100 = 0.458812622783553d0*x49
      x101 = 39.6231269867355d0*x11
      x102 = 65.416341341957d0*x46
      x103 = 13.2077089955785d0*x49
      x104 = 0.239205142311446d0*x5
      x105 = 0.478410284622892d0*x25*x46*x69 - x61*x80 - x62*x81 + x63*x
     &82
      x106 = x29**(-2)
      x107 = exp(-2.8771076053175544d0*x24)
      x108 = x106*x107/x33**3
      x109 = rho_b**(-6.0d0)
      x110 = rho_b**(-5.33333333333333d0)
      x111 = rho_a**(-3.0d0)
      x112 = 0.0322515344331995d0
      x113 = x112*x4
      x114 = 0.9525446008335d0*x113
      x115 = 0.349470330364399d0*x74
      x116 = 0.251365936331062d0*x113
      x117 = 0.125392650162666d0*x112
      x118 = rho_b**(-3.0d0)
      E = -1.3628404446241d0*x0*(x1*x22 + x23*x35)/(rho_a + rho_b)
      d1E(1) = -x0*(1.81712059283214d0*x22*x36 + x57*x59)
      d1E(2) = -x0*(1.81712059283214d0*x35*x60 + x71*x73)
      d1E(3) = -x58*x77
      d1E(4) = 0
      d1E(5) = -x72*x79
      d2E(1) = x0*(-0.60570686427738d0*rho_a**(-0.666666666666667d0)*x22
     & + sigma_aa**2* x57*x84*x87 - 1.09572371747778d0*x1*x59*(rho_a**( 
     &-4.66666666666667d0)*x7*x93 + x100*x43*x52 + x104*x51*x54*x85*( x1
     &01*x13 - x102*x45 + x103*x48) + x18*x55*(-rho_a**( -3.333333333333
     &33d0)*x99 + x2*x98 - x48*x97) - x37*x52*x96 - 1.27576075899438d0*x
     &41*x83 + x7*x88*x94 - x7*x91*x95 - x88*x90 + x91*x92) - 2.92192991
     &327408d0*x36*x56*x59)
      d2E(2) = 0
      d2E(3) = x0*(-0.60570686427738d0*rho_b**(-0.666666666666667d0)*x35
     & + sigma_bb**2* x105*x108*x71 - 1.09572371747778d0*x23*x73*(rho_b*
     &*( -4.66666666666667d0)*x25*x93 + x100*x63*x68 + x104*x106*x25*x31
     &* x67*(x101*x28 - x102*x65 + x103*x66) + x109*x25*x94 - x109*x90 -
     & x110*x25*x95 + x110*x92 + x32*x64*(-rho_b**(-3.33333333333333d0)*
     & x99 + x31*x98 - x66*x97) - 1.27576075899438d0*x46*x62*x68 - x61* 
     &x68*x96) - 2.92192991327408d0*x60*x70*x73)
      d2E(4) = x58*(-mu*x52*x77 + x111*x114*x8 - x111*x116*x9 + x115*x48
     &*x9 + x19*x21* x7*x76*x84*x86)
      d2E(5) = 0
      d2E(6) = rho_a**(-4.0d0)*x117*x7**2*x87
      d2E(7) = 0
      d2E(8) = 0
      d2E(9) = 0
      d2E(10) = 0
      d2E(11) = 0
      d2E(12) = x72*(-mu*x68*x79 + sigma_bb*x105*x107*x25*x30*x34*x78 + 
     &x114*x118*x26 + x115*x27*x66 - x116*x118*x27)
      d2E(13) = 0
      d2E(14) = 0
      d2E(15) = rho_b**(-4.0d0)*x108*x117*x25**2
      end subroutine


C*****************************************************************************
      pure subroutine D2ESRX_SPIN_PBE_GWS_ERF_case_2_1(rho_a, rho_b, sig
     &ma_aa, sigma_ab, sigma_bb, mu, E, d1E, d2E)
C*****************************************************************************
C   Implemented by YingXing Cheng.
C
C   Subroutine generated using Sympy 1.4
C   Generated: January 16, 2022
C*****************************************************************************
      implicit none
      real*8, intent(in) :: rho_a, rho_b, sigma_aa, sigma_ab, sigma_bb, 
     &mu
      real*8, intent(out) :: E, d1E(9), d2E(45)
      real*8 :: x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x
     &13, x14, x15, x16, x17, x18, x19, x20, x21, x22, x23, x24, x25, x2
     &6, x27, x28, x29, x30, x31, x32, x33, x34, x35, x36, x37, x38, x39
     &, x40, x41, x42, x43, x44, x45, x46, x47, x48, x49, x50, x51, x52,
     & x53, x54, x55, x56, x57, x58, x59, x60, x61, x62, x63, x64, x65, 
     &x66, x67, x68, x69, x70, x71, x72, x73, x74, x75, x76, x77, x78, x
     &79, x80, x81, x82, x83, x84, x85, x86, x87, x88, x89, x90, x91, x9
     &2, x93, x94, x95, x96, x97, x98, x99, x100, x101, x102, x103, x104
     &, x105, x106, x107, x108, x109, x110, x111, x112, x113, x114, x115
     &, x116, x117, x118, x119, x120, x121, x122, x123, x124, x125, x126
     &, x127, x128, x129, x130, x131, x132, x133, x134, x135, x136, x137
     &, x138, x139, x140, x141, x142, x143, x144, x145, x146, x147, x148
     &, x149, x150, x151, x152, x153, x154, x155, x156, x157, x158, x159
     &, x160, x161, x162, x163, x164, x165, x166, x167, x168, x169, x170
     &, x171, x172, x173, x174, x175, x176, x177, x178, x179, x180, x181
     &, x182, x183, x184, x185, x186, x187, x188, x189, x190, x191, x192
     &, x193, x194, x195, x196, x197, x198, x199, x200, x201, x202, x203
     &, x204, x205, x206, x207, x208, x209, x210, x211, x212, x213, x214
     &, x215, x216, x217, x218, x219, x220, x221, x222, x223, x224, x225
     &, x226
      E = 0.0d0
      d1E(:) = 0.0d0
      d2E(:) = 0.0d0
      x0 = 0.682784063255296d0
      x1 = rho_a**1.33333333333333d0
      x2 = 4.60115111447049d0
      x3 = 1d0/x2
      x4 = 0.239205142311446d0*x3
      x5 = rho_a**0.666666666666667d0
      x6 = mu**2
      x7 = x3*x6
      x8 = x7/x5
      x9 = exp(-1.4385538026587772d0*x8)
      x10 = sigma_aa*x9
      x11 = rho_a**0.333333333333333d0
      x12 = 1d0/x11
      x13 = mu*x12
      x14 = 0.826307487110758d0
      x15 = 59.4346904801033d0*x14
      x16 = 1d0/x1
      x17 = 21.1705915781930d0
      x18 = 1d0/x17
      x19 = mu**4
      x20 = 4.95289087334194d0*x18*x19
      x21 = x13*x15 + x16*x20 - 49.0622560064678d0*x8 - 81.0d0
      x22 = 1d0/x21
      x23 = 5.45136177849642d0*x8 - 7.0d0
      x24 = rho_a**(-2.66666666666667d0)
      x25 = x23*x24
      x26 = x22*x25
      x27 = x10*x26*x4 + 1.0d0
      x28 = 1d0/x27
      x29 = 1.804d0 - 0.804d0*x28
      x30 = 2.14502939711103d0
      x31 = 1d0/x30
      x32 = 0.550321208149104d0*x31
      x33 = x12*x32
      x34 = 1d0/rho_a
      x35 = 9.86960440108936d0
      x36 = 1d0/x35
      x37 = 0.0833333333333333d0*x36
      x38 = x34*x37
      x39 = x38*x6
      x40 = 3.30192724889463d0*x2/x6
      x41 = exp(-x40*x5)
      x42 = mu*x41
      x43 = 1.77245385090552d0
      x44 = 1d0/mu
      x45 = x30*x44
      x46 = 1.81712059283214d0*x45
      x47 = mu**3
      x48 = 0.825481812223657d0*x31
      x49 = -x13*x48 + x38*x47 + x43*erf(x11*x46)
      x50 = 0.275160604074552d0*x12
      x51 = mu*x31
      x52 = x50*x51
      x53 = x52*(x42*(x33 - x39) + x49) - 0.375d0
      x54 = x29*x53
      x55 = rho_b**1.33333333333333d0
      x56 = rho_b**0.666666666666667d0
      x57 = x7/x56
      x58 = exp(-1.4385538026587772d0*x57)
      x59 = sigma_bb*x58
      x60 = rho_b**0.333333333333333d0
      x61 = 1d0/x60
      x62 = mu*x61
      x63 = 1d0/x55
      x64 = x15*x62 + x20*x63 - 49.0622560064678d0*x57 - 81.0d0
      x65 = 1d0/x64
      x66 = 5.45136177849642d0*x57 - 7.0d0
      x67 = rho_b**(-2.66666666666667d0)
      x68 = x66*x67
      x69 = x65*x68
      x70 = x4*x59*x69 + 1.0d0
      x71 = 1d0/x70
      x72 = 1.804d0 - 0.804d0*x71
      x73 = x32*x61
      x74 = 1d0/rho_b
      x75 = x37*x74
      x76 = x6*x75
      x77 = exp(-x40*x56)
      x78 = mu*x77
      x79 = x43*erf(x46*x60) + x47*x75 - x48*x62
      x80 = 0.275160604074552d0*x61
      x81 = x51*x80
      x82 = x81*(x78*(x73 - x76) + x79) - 0.375d0
      x83 = x72*x82
      x84 = rho_a**0.333333333333333d0
      x85 = 4.84565491421904d0*x0
      x86 = -x33 + x39
      x87 = -x42*x86 + x49
      x88 = 0.275160604074552d0*x51
      x89 = rho_a**(-2.0d0)*x37
      x90 = 1.21141372855476d0*x45
      x91 = rho_a**(-0.666666666666667d0)
      x92 = x41*x91
      x93 = 0.183440402716368d0*x31
      x94 = -x16*x93 + x6*x89
      x95 = x2*x44
      x96 = 2.20128483259642d0*x95
      x97 = rho_a**(-0.333333333333333d0)*x41
      x98 = x16*x88 + x42*x94 - x47*x89 + x86*x96*x97 + x90*x92
      x99 = 0.0917202013581841d0*x16*x87 - x50*x98
      x100 = x29*x99
      x101 = 0.318309886183791d0*mu
      x102 = 3.63424118566428d0*x101
      x103 = x1*x102
      x104 = x53*x9
      x105 = 2.92192991327408d0*x0
      x106 = x1*x105
      x107 = rho_a**(-4.33333333333333d0)
      x108 = x18*x6
      x109 = 0.869329180010942d0*x108
      x110 = 0.637880379497189d0*x3
      x111 = rho_a**(-3.66666666666667d0)*x23
      x112 = 0.229406311391776d0*x108
      x113 = x107*x23
      x114 = mu*x3
      x115 = 0.239205142311446d0*x114
      x116 = 19.8115634933678d0*x14
      x117 = rho_a**(-1.66666666666667d0)
      x118 = 32.7081706709785d0*x114
      x119 = rho_a**(-2.33333333333333d0)
      x120 = x18*x47
      x121 = 6.60385449778925d0*x120
      x122 = x116*x16 - x117*x118 + x119*x121
      x123 = x122*x22
      x124 = x123*x25
      x125 = -x107*x109 - x110*x111 + x112*x113 + x115*x124
      x126 = x22/x27**2
      x127 = x125*x126
      x128 = rho_b**0.333333333333333d0
      x129 = -x73 + x76
      x130 = -x129*x78 + x79
      x131 = rho_b**(-2.0d0)*x37
      x132 = rho_b**(-0.666666666666667d0)
      x133 = x132*x77
      x134 = x131*x6 - x63*x93
      x135 = rho_b**(-0.333333333333333d0)*x77
      x136 = x129*x135*x96 - x131*x47 + x133*x90 + x134*x78 + x63*x88
      x137 = 0.0917202013581841d0*x130*x63 - x136*x80
      x138 = x137*x72
      x139 = x102*x55
      x140 = x65/x70**2
      x141 = x58*x82
      x142 = rho_b**(-4.33333333333333d0)
      x143 = rho_b**(-3.66666666666667d0)*x66
      x144 = x142*x66
      x145 = rho_b**(-1.66666666666667d0)
      x146 = rho_b**(-2.33333333333333d0)
      x147 = x116*x63 - x118*x145 + x121*x146
      x148 = x147*x65
      x149 = x148*x68
      x150 = -x109*x142 - x110*x143 + x112*x144 + x115*x149
      x151 = x105*x55
      x152 = x150*x151
      x153 = x16*x23
      x154 = x153*x9
      x155 = 0.148394183600699d0
      x156 = 0.698940660728797d0*x155
      x157 = x52*x87 - 0.375d0
      x158 = x126*x157
      x159 = x63*x66
      x160 = x159*x58
      x161 = x130*x81 - 0.375d0
      x162 = x140*x161
      x163 = 1.61521830473968d0*x0
      x164 = 9.69130982843808d0*x101
      x165 = x10*x158
      x166 = 7.79181310206421d0*x0
      x167 = 5.84385982654816d0*x101
      x168 = 1.73865836002188d0*x108
      x169 = 1.27576075899438d0*x3
      x170 = 0.458812622783553d0*x108
      x171 = 0.478410284622892d0*x114
      x172 = -x107*x168 - x111*x169 + x113*x170 + x124*x171
      x173 = x21**(-2)
      x174 = exp(-2.8771076053175544d0*x8)
      x175 = x157*x173*x174/x27**3
      x176 = 0.366880805432736d0*x51
      x177 = rho_a**(-3.0d0)
      x178 = 0.166666666666667d0*x36
      x179 = x178*x47
      x180 = 0.80760915236984d0*x45
      x181 = 1d0/x47
      x182 = 2.66666666666667d0*x181*x35
      x183 = 0.244587203621824d0*x31
      x184 = x177*x6
      x185 = 0.733761610865473d0*x95
      x186 = 4.40256966519284d0*x95
      x187 = 4.84565491421904d0*x17*x181
      x188 = rho_a**(-6.0d0)
      x189 = 0.0102659822546843d0*x19
      x190 = 1.66743573022264d0*x189
      x191 = rho_a**(-5.33333333333333d0)
      x192 = 6.08530426007659d0*x108
      x193 = 2.33889472482303d0*x3
      x194 = 0.220008881071042d0*x189
      x195 = 1.60584417974243d0*x108
      x196 = 1.73865836002188d0*x120
      x197 = 1.27576075899438d0*x114
      x198 = 26.415417991157d0*x14
      x199 = 54.5136177849642d0*x114
      x200 = 15.4089938281749d0*x120
      x201 = 0.458812622783553d0*x120
      x202 = 39.6231269867355d0*x14
      x203 = 65.416341341957d0*x114
      x204 = 13.2077089955785d0*x120
      x205 = 0.239205142311446d0*x7
      x206 = x162*x59
      x207 = -x142*x168 - x143*x169 + x144*x170 + x149*x171
      x208 = x64**(-2)
      x209 = exp(-2.8771076053175544d0*x57)
      x210 = x161*x208*x209/x70**3
      x211 = rho_b**(-3.0d0)
      x212 = x211*x6
      x213 = rho_b**(-6.0d0)
      x214 = rho_b**(-5.33333333333333d0)
      x215 = 0.0322515344331995d0
      x216 = 2.540118935556d0*x215
      x217 = x104*x184
      x218 = 0.93192088097173d0*x155
      x219 = x104*x23
      x220 = 0.6703091635495d0*x215
      x221 = 0.698940660728797d0*mu
      x222 = x155*x221
      x223 = 0.0691804894611514d0*x221
      x224 = 0.334380400433776d0*x215
      x225 = x141*x212
      x226 = x141*x66
      E = 3.63424118566428d0*x0*(x1*x54 + x55*x83)/(rho_a + rho_b)
      d1E(1) = sigma_aa*x104*x106*x127 - x100*x103 + x54*x84*x85
      d1E(2) = sigma_bb*x140*x141*x152 + x128*x83*x85 - x138*x139
      d1E(3) = x154*x156*x158
      d1E(4) = 0
      d1E(5) = x156*x160*x162
      d2E(1) = -sigma_aa**2*x106*x125*x172*x175 - x1*x10*x127*x167*x99 -
     & x100*x164*x84 + x103*x29*(0.122293601810912d0*x119*x87 - 0.183440
     &402716368d0* x16*x98 + x50*(-rho_a**(-1.66666666666667d0)*x180*x41
     & - rho_a**( -1.33333333333333d0)*x185*x41*x86 - x119*x176 + x177*x
     &179 - x182* x34*x41 - x186*x94*x97 - x187*x86*x92 - x42*(-x119*x18
     &3 + x178* x184))) + x106*x165*(rho_a**(-4.66666666666667d0)*x193*x
     &23 - x107 *x123*x196 - x111*x123*x197 + x113*x123*x201 - x115*x26*
     &(rho_a**( -3.33333333333333d0)*x200 + x119*x198 - x199*x24) + x122
     &*x173* x205*x25*(-x117*x203 + x119*x204 + x16*x202) - x188*x190 + 
     &x188* x194*x23 + x191*x192 - x191*x195*x23) + x125*x165*x166*x84 +
     & x157 *x163*x29*x91
      d2E(2) = 0
      d2E(3) = -sigma_bb**2*x152*x207*x210 - x128*x138*x164 + x128*x150*
     &x166*x206 + x132*x161*x163*x72 - x137*x140*x150*x167*x55*x59 + x13
     &9*x72*( 0.122293601810912d0*x130*x146 - 0.183440402716368d0*x136*x
     &63 + x80*(-rho_b**(-1.66666666666667d0)*x180*x77 - rho_b**( -1.333
     &33333333333d0)*x129*x185*x77 - x129*x133*x187 - x134*x135* x186 - 
     &x146*x176 + x179*x211 - x182*x74*x77 - x78*(-x146*x183 + x178*x212
     &))) + x151*x206*(rho_b**(-4.66666666666667d0)*x193*x66 - x115*x69*
     &(rho_b**(-3.33333333333333d0)*x200 + x146*x198 - x199* x67) - x142
     &*x148*x196 - x143*x148*x197 + x144*x148*x201 + x147* x205*x208*x68
     &*(-x145*x203 + x146*x204 + x202*x63) - x190*x213 + x192*x214 + x19
     &4*x213*x66 - x195*x214*x66)
      d2E(4) = x126*(-sigma_aa*x153*x156*x172*x174*x22*x28*x53 - x119*x2
     &18*x219 + x123* x16*x219*x222 - x154*x223*x99 - x216*x217 + x217*x
     &220*x23)
      d2E(5) = 0
      d2E(6) = -rho_a**(-4.0d0)*x175*x224*x23**2
      d2E(7) = 0
      d2E(8) = 0
      d2E(9) = 0
      d2E(10) = 0
      d2E(11) = 0
      d2E(12) = x140*(-sigma_bb*x156*x159*x207*x209*x65*x71*x82 - x137*x
     &160*x223 - x146* x218*x226 + x148*x222*x226*x63 - x216*x225 + x220
     &*x225*x66)
      d2E(13) = 0
      d2E(14) = 0
      d2E(15) = -rho_b**(-4.0d0)*x210*x224*x66**2
      end subroutine


C*****************************************************************************
      pure subroutine D2ESRX_SPIN_PBE_GWS_ERF_case_2_2(rho_a, rho_b, sig
     &ma_aa, sigma_ab, sigma_bb, mu, E, d1E, d2E)
C*****************************************************************************
C   Implemented by YingXing Cheng.
C
C   Subroutine generated using Sympy 1.4
C   Generated: January 16, 2022
C*****************************************************************************
      implicit none
      real*8, intent(in) :: rho_a, rho_b, sigma_aa, sigma_ab, sigma_bb, 
     &mu
      real*8, intent(out) :: E, d1E(9), d2E(45)
      real*8 :: x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x
     &13, x14, x15, x16, x17, x18, x19, x20, x21, x22, x23, x24, x25, x2
     &6, x27, x28, x29, x30, x31, x32, x33, x34, x35, x36, x37, x38, x39
     &, x40, x41, x42, x43, x44, x45, x46, x47, x48, x49, x50, x51, x52,
     & x53, x54, x55, x56, x57, x58, x59, x60, x61, x62, x63, x64, x65, 
     &x66, x67, x68, x69, x70, x71, x72, x73, x74, x75, x76, x77, x78, x
     &79, x80, x81, x82, x83, x84, x85, x86, x87, x88, x89, x90, x91, x9
     &2, x93, x94, x95, x96, x97, x98, x99, x100, x101, x102, x103, x104
     &, x105, x106, x107, x108, x109, x110, x111, x112, x113, x114, x115
     &, x116, x117, x118, x119, x120, x121, x122, x123, x124, x125, x126
     &, x127, x128, x129, x130, x131, x132, x133, x134, x135, x136, x137
     &, x138, x139, x140, x141, x142, x143, x144, x145, x146, x147, x148
     &, x149, x150, x151, x152, x153, x154, x155, x156, x157, x158, x159
     &, x160, x161, x162, x163, x164, x165, x166, x167, x168, x169, x170
     &, x171, x172, x173, x174, x175, x176, x177, x178, x179, x180, x181
     &, x182, x183, x184, x185, x186, x187, x188, x189, x190, x191, x192
     &, x193, x194, x195, x196, x197, x198, x199, x200, x201, x202, x203
     &, x204, x205, x206, x207, x208, x209, x210, x211, x212, x213, x214
     &, x215, x216, x217, x218, x219, x220, x221, x222, x223, x224, x225
     &, x226, x227, x228, x229, x230, x231
      E = 0.0d0
      d1E(:) = 0.0d0
      d2E(:) = 0.0d0
      x0 = 0.682784063255296d0
      x1 = rho_a**1.33333333333333d0
      x2 = rho_a**(-2.66666666666667d0)
      x3 = mu**2
      x4 = 1d0/x3
      x5 = 4.60115111447049d0
      x6 = 1d0/x5
      x7 = x4*x6
      x8 = 0.239205142311446d0*x7
      x9 = x2*x8
      x10 = rho_a**0.666666666666667d0
      x11 = 0.183440402716368d0*x5
      x12 = x10*x11
      x13 = 21.1705915781930d0
      x14 = x13*x4
      x15 = 0.010095114404623d0*x14
      x16 = x1*x15
      x17 = rho_a**2.0d0
      x18 = 97.4090910340024d0
      x19 = mu**(-4)
      x20 = x18*x19
      x21 = 0.147857142857143d0*x20
      x22 = x17*x21
      x23 = -x12 + x16 + x22
      x24 = 1d0/x10
      x25 = x3*x6
      x26 = 1.43855380265878d0*x25
      x27 = exp(-x24*x26)
      x28 = x23*x27
      x29 = sigma_aa*x28*x9
      x30 = 1.0d0 - x29
      x31 = 1d0/x30
      x32 = 1.804d0 - 0.804d0*x31
      x33 = rho_a**0.333333333333333d0
      x34 = 1d0/x33
      x35 = 2.14502939711103d0
      x36 = 1d0/x35
      x37 = 0.550321208149104d0*x36
      x38 = x34*x37
      x39 = rho_a**1.0d0
      x40 = 1d0/x39
      x41 = 9.86960440108936d0
      x42 = 1d0/x41
      x43 = 0.0833333333333333d0*x42
      x44 = x40*x43
      x45 = x3*x44
      x46 = 3.30192724889463d0*x4*x5
      x47 = exp(-x10*x46)
      x48 = mu*x47
      x49 = 1.77245385090552d0
      x50 = 1d0/mu
      x51 = x35*x50
      x52 = 1.81712059283214d0*x51
      x53 = mu**3
      x54 = mu*x36
      x55 = 0.825481812223657d0*x54
      x56 = -x34*x55 + x44*x53 + x49*erf(x33*x52)
      x57 = 0.275160604074552d0*x34
      x58 = x54*x57
      x59 = x58*(x48*(x38 - x45) + x56) - 0.375d0
      x60 = x32*x59
      x61 = rho_b**1.33333333333333d0
      x62 = rho_b**(-2.66666666666667d0)
      x63 = x62*x8
      x64 = rho_b**0.666666666666667d0
      x65 = x11*x64
      x66 = x15*x61
      x67 = rho_b**2.0d0
      x68 = x21*x67
      x69 = -x65 + x66 + x68
      x70 = 1d0/x64
      x71 = exp(-x26*x70)
      x72 = x69*x71
      x73 = sigma_bb*x63*x72
      x74 = 1.0d0 - x73
      x75 = 1d0/x74
      x76 = 1.804d0 - 0.804d0*x75
      x77 = rho_b**0.333333333333333d0
      x78 = 1d0/x77
      x79 = x37*x78
      x80 = rho_b**1.0d0
      x81 = 1d0/x80
      x82 = x43*x81
      x83 = x3*x82
      x84 = exp(-x46*x64)
      x85 = mu*x84
      x86 = x49*erf(x52*x77) + x53*x82 - x55*x78
      x87 = 0.275160604074552d0*x78
      x88 = x54*x87
      x89 = x88*(x85*(x79 - x83) + x86) - 0.375d0
      x90 = x76*x89
      x91 = rho_a**0.333333333333333d0
      x92 = 4.84565491421904d0*x0
      x93 = 1d0/x1
      x94 = -x38 + x45
      x95 = -x48*x94 + x56
      x96 = 0.275160604074552d0*x54
      x97 = x43/x17
      x98 = 1.21141372855476d0*x51
      x99 = rho_a**(-0.666666666666667d0)
      x100 = x47*x99
      x101 = 0.183440402716368d0*x36
      x102 = -x101*x93 + x3*x97
      x103 = x5*x50
      x104 = 2.20128483259642d0*x103
      x105 = rho_a**(-0.333333333333333d0)
      x106 = x105*x47
      x107 = x100*x98 + x102*x48 + x104*x106*x94 - x53*x97 + x93*x96
      x108 = -x107*x57 + 0.0917202013581841d0*x93*x95
      x109 = 0.318309886183791d0*mu
      x110 = 3.63424118566428d0*x109
      x111 = x1*x110
      x112 = x30**(-2)
      x113 = x12 - x16 - x22
      x114 = rho_a**(-4.33333333333333d0)
      x115 = 1d0/x13
      x116 = 0.229406311391776d0*x115
      x117 = x114*x116
      x118 = rho_a**(-3.66666666666667d0)
      x119 = 0.637880379497189d0*x7
      x120 = x118*x119
      x121 = 0.122293601810912d0*x5
      x122 = x105*x121
      x123 = 0.0134601525394973d0*x14
      x124 = x123*x91
      x125 = 0.295714285714286d0*x20
      x126 = x125*x39
      x127 = x122 - x124 - x126
      x128 = x27*x59
      x129 = 2.92192991327408d0*x0
      x130 = sigma_aa*x1
      x131 = x129*x130
      x132 = rho_b**0.333333333333333d0
      x133 = 1d0/x61
      x134 = -x79 + x83
      x135 = -x134*x85 + x86
      x136 = x43/x67
      x137 = rho_b**(-0.666666666666667d0)
      x138 = x137*x84
      x139 = -x101*x133 + x136*x3
      x140 = rho_b**(-0.333333333333333d0)
      x141 = x140*x84
      x142 = x104*x134*x141 + x133*x96 - x136*x53 + x138*x98 + x139*x85
      x143 = 0.0917202013581841d0*x133*x135 - x142*x87
      x144 = x110*x61
      x145 = x74**(-2)
      x146 = x65 - x66 - x68
      x147 = rho_b**(-4.33333333333333d0)
      x148 = x116*x147
      x149 = rho_b**(-3.66666666666667d0)
      x150 = x119*x149
      x151 = x121*x140
      x152 = x123*x132
      x153 = x125*x80
      x154 = x151 - x152 - x153
      x155 = x71*x89
      x156 = x129*x61
      x157 = sigma_bb*x156
      x158 = 0.698940660728797d0*x93
      x159 = x158*x28
      x160 = 0.148394183600699d0*x4
      x161 = x58*x95 - 0.375d0
      x162 = x29 - 1.0d0
      x163 = x162**(-2)
      x164 = x161*x163
      x165 = 0.698940660728797d0*x133
      x166 = x165*x72
      x167 = x135*x88 - 0.375d0
      x168 = x73 - 1.0d0
      x169 = x168**(-2)
      x170 = x167*x169
      x171 = 1.804d0 + 0.804d0/x162
      x172 = 1.61521830473968d0*x0
      x173 = 9.69130982843808d0*x109
      x174 = -x122 + x124 + x126
      x175 = -x117*x23 + x120*x23 - x174*x9
      x176 = x164*x27
      x177 = 7.79181310206421d0*x0
      x178 = x115*x23
      x179 = 0.458812622783553d0*x114
      x180 = x115*x179
      x181 = rho_a**(-1.33333333333333d0)
      x182 = 0.0407645339369707d0*x5
      x183 = 0.00448671751316577d0*x14
      x184 = 0.220008881071042d0*x3/x18
      x185 = x23*x7
      x186 = x174*x7
      x187 = 1.27576075899438d0*x118
      x188 = 5.84385982654816d0*x109
      x189 = 0.478410284622892d0*x2
      x190 = 2.87710760531755d0*x25
      x191 = exp(-x190*x24)
      x192 = x161*x191/x162**3
      x193 = rho_a**(-2.33333333333333d0)
      x194 = 0.366880805432736d0*x54
      x195 = rho_a**(-3.0d0)
      x196 = 0.166666666666667d0*x42
      x197 = x195*x196
      x198 = 0.80760915236984d0*x51
      x199 = 1d0/x53
      x200 = 2.66666666666667d0*x199*x41
      x201 = 0.244587203621824d0*x36
      x202 = 0.733761610865473d0*x103
      x203 = 4.40256966519284d0*x103
      x204 = 4.84565491421904d0*x13*x199
      x205 = 1.804d0 + 0.804d0/x168
      x206 = x170*x71
      x207 = -x151 + x152 + x153
      x208 = -x148*x69 + x150*x69 - x207*x63
      x209 = sigma_bb*x208
      x210 = x115*x69
      x211 = 0.458812622783553d0*x147
      x212 = x115*x211
      x213 = rho_b**(-1.33333333333333d0)
      x214 = x69*x7
      x215 = x207*x7
      x216 = 1.27576075899438d0*x149
      x217 = 0.478410284622892d0*x62
      x218 = exp(-x190*x70)
      x219 = x167*x218/x168**3
      x220 = rho_b**(-2.33333333333333d0)
      x221 = rho_b**(-3.0d0)
      x222 = x196*x221
      x223 = 0.0322515344331995d0
      x224 = 0.6703091635495d0*x223
      x225 = x28*x59
      x226 = 0.93192088097173d0*x160
      x227 = x158*x160
      x228 = 0.0691804894611514d0*x50
      x229 = 0.334380400433776d0*x19*x223
      x230 = x72*x89
      x231 = x160*x165
      E = 3.63424118566428d0*x0*(x1*x60 + x61*x90)/(rho_a + rho_b)
      d1E(1) = -x108*x111*x32 + x112*x128*x131*(x113*x117 - x113*x120 + 
     &x127*x9) + x60* x91*x92
      d1E(2) = x132*x90*x92 - x143*x144*x76 + x145*x155*x157*(x146*x148 
     &- x146*x150 + x154*x63)
      d1E(3) = -x159*x160*x164
      d1E(4) = 0
      d1E(5) = -x160*x166*x170
      d2E(1) = sigma_aa**2*x1*x129*x175*x192*(-x178*x179 + x185*x187 - x
     &186*x189) + sigma_aa*x175*x176*x177*x91 - x108*x130*x163*x175*x188
     &*x27 - x108 *x171*x173*x91 + x111*x171*(-0.183440402716368d0*x107*
     &x93 + 0.122293601810912d0*x193*x95 + x57*(-rho_a**(-1.666666666666
     &67d0) *x198*x47 - x100*x204*x94 - x102*x106*x203 - x181*x202*x47*x
     &94 - x193*x194 + x197*x53 - x200*x40*x47 - x48*(-x193*x201 + x197*
     &x3 ))) + x131*x176*(-rho_a**(-6.0d0)*x184*x23 + 1.60584417974243d0
     &* rho_a**(-5.33333333333333d0)*x178 - 2.33889472482303d0*rho_a**( 
     &-4.66666666666667d0)*x185 - x174*x180 + x186*x187 - x9*(x125 + x18
     &1*x182 + x183*x99)) + x161*x171*x172*x99
      d2E(2) = 0
      d2E(3) = sigma_bb**2*x156*x208*x219*(-x210*x211 + x214*x216 - x215
     &*x217) - x132* x143*x173*x205 + x132*x177*x206*x209 + x137*x167*x1
     &72*x205 - x143 *x169*x188*x209*x61*x71 + x144*x205*(-0.18344040271
     &6368d0*x133* x142 + 0.122293601810912d0*x135*x220 + x87*(-rho_b**(
     & -1.66666666666667d0)*x198*x84 - x134*x138*x204 - x134*x202*x213* 
     &x84 - x139*x141*x203 - x194*x220 - x200*x81*x84 + x222*x53 - x85* 
     &(-x201*x220 + x222*x3))) + x157*x206*(-rho_b**(-6.0d0)*x184*x69 + 
     &1.60584417974243d0*rho_b**(-5.33333333333333d0)*x210 - 2.338894724
     &82303d0*rho_b**(-4.66666666666667d0)*x214 - x207*x212 + x215*x216 
     &- x63*(x125 + x137*x183 + x182*x213))
      d2E(4) = x112*(sigma_aa*x191*x227*x23*x31*x59*(x113*x180 - x113*x1
     &87*x7 + x127* x189*x7) + x108*x159*x228 - x128*x174*x227 + x193*x2
     &25*x226 - x195*x224*x225)
      d2E(5) = 0
      d2E(6) = rho_a**(-4.0d0)*x192*x229*x23**2
      d2E(7) = 0
      d2E(8) = 0
      d2E(9) = 0
      d2E(10) = 0
      d2E(11) = 0
      d2E(12) = x145*(sigma_bb*x218*x231*x69*x75*x89*(x146*x212 - x146*x
     &216*x7 + x154* x217*x7) + x143*x166*x228 - x155*x207*x231 + x220*x
     &226*x230 - x221*x224*x230)
      d2E(13) = 0
      d2E(14) = 0
      d2E(15) = rho_b**(-4.0d0)*x219*x229*x69**2
      end subroutine


C*****************************************************************************
      pure subroutine D2ESRX_SPIN_PBE_GWS_ERF_case_2_3(rho_a, rho_b, sig
     &ma_aa, sigma_ab, sigma_bb, mu, E, d1E, d2E)
C*****************************************************************************
C   Implemented by YingXing Cheng.
C
C   Subroutine generated using Sympy 1.4
C   Generated: January 16, 2022
C*****************************************************************************
      implicit none
      real*8, intent(in) :: rho_a, rho_b, sigma_aa, sigma_ab, sigma_bb, 
     &mu
      real*8, intent(out) :: E, d1E(9), d2E(45)
      real*8 :: x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x
     &13, x14, x15, x16, x17, x18, x19, x20, x21, x22, x23, x24, x25, x2
     &6, x27, x28, x29, x30, x31, x32, x33, x34, x35, x36, x37, x38, x39
     &, x40, x41, x42, x43, x44, x45, x46, x47, x48, x49, x50, x51, x52,
     & x53, x54, x55, x56, x57, x58, x59, x60, x61, x62, x63, x64, x65, 
     &x66, x67, x68, x69, x70, x71, x72, x73, x74, x75, x76, x77, x78, x
     &79, x80, x81, x82, x83, x84, x85, x86, x87, x88, x89, x90, x91, x9
     &2, x93, x94, x95, x96, x97, x98, x99, x100, x101, x102, x103, x104
     &, x105, x106, x107, x108, x109, x110, x111, x112, x113, x114, x115
     &, x116, x117, x118, x119, x120, x121, x122, x123, x124, x125, x126
     &, x127, x128, x129, x130, x131, x132, x133, x134, x135, x136, x137
     &, x138, x139, x140, x141, x142, x143, x144, x145, x146, x147, x148
     &, x149, x150, x151, x152, x153, x154, x155, x156, x157, x158, x159
     &, x160, x161, x162, x163, x164, x165, x166, x167, x168, x169, x170
     &, x171, x172, x173, x174, x175, x176, x177, x178, x179, x180, x181
     &, x182, x183, x184, x185, x186, x187, x188, x189, x190, x191, x192
     &, x193, x194, x195, x196, x197, x198, x199, x200, x201, x202, x203
     &, x204, x205, x206, x207, x208, x209, x210, x211, x212, x213, x214
     &, x215, x216, x217, x218, x219, x220, x221, x222, x223, x224, x225
     &, x226, x227, x228, x229, x230, x231, x232, x233, x234, x235, x236
     &, x237, x238, x239, x240, x241, x242, x243, x244, x245, x246, x247
     &, x248, x249, x250, x251, x252, x253, x254, x255, x256, x257, x258
     &, x259, x260, x261, x262, x263, x264, x265, x266, x267, x268, x269
     &, x270, x271, x272, x273, x274, x275, x276, x277, x278, x279, x280
     &, x281, x282, x283, x284, x285, x286, x287, x288, x289, x290, x291
     &, x292, x293, x294, x295, x296, x297, x298, x299, x300, x301, x302
     &, x303, x304, x305, x306, x307, x308, x309, x310
      E = 0.0d0
      d1E(:) = 0.0d0
      d2E(:) = 0.0d0
      x0 = 0.682784063255296d0
      x1 = rho_a**1.33333333333333d0
      x2 = rho_a**0.666666666666667d0
      x3 = 4.60115111447049d0
      x4 = mu**2
      x5 = 1d0/x4
      x6 = x3*x5
      x7 = 3.30192724889463d0*x6
      x8 = x2*x7
      x9 = exp(x8)
      x10 = 3.0d0*x9
      x11 = 21.1705915781930d0
      x12 = 1d0/x11
      x13 = mu**4
      x14 = x12*x13
      x15 = 0.183440402716368d0*x14
      x16 = 1d0/x1
      x17 = x9 - 1.0d0
      x18 = x16*x17
      x19 = x10 - 2.0d0
      x20 = 1d0/x2
      x21 = 1d0/x3
      x22 = x21*x4
      x23 = x20*x22
      x24 = rho_a**0.333333333333333d0
      x25 = 1d0/x24
      x26 = 2.14502939711103d0
      x27 = 1d0/x26
      x28 = mu*x27
      x29 = 3.90167577847542d0*x28
      x30 = 1d0/mu
      x31 = x26*x30
      x32 = 1.81712059283214d0*x31
      x33 = erf(x24*x32)
      x34 = x33*x9
      x35 = -x10 + x15*x18 - 0.60570686427738d0*x19*x23 + x25*x29*x34
      x36 = 1d0/x35
      x37 = 0.015286700226364d0*x14
      x38 = x18*x37
      x39 = 7.0d0*x9 + 11.0d0
      x40 = 0.00280419844572861d0*x23*x39
      x41 = -x38 + x40 + 0.0185185185185185d0
      x42 = rho_a**(-2.0d0)
      x43 = 3.15935190989552d0*x5
      x44 = x42*x43
      x45 = x41*x44
      x46 = x36*x45
      x47 = 1.43855380265878d0*x22
      x48 = exp(-x20*x47)
      x49 = sigma_aa*x48
      x50 = -x46*x49 + 1.0d0
      x51 = 1d0/x50
      x52 = 1.804d0 - 0.804d0*x51
      x53 = 0.550321208149104d0*x27
      x54 = x25*x53
      x55 = 1d0/rho_a
      x56 = 9.86960440108936d0
      x57 = 1d0/x56
      x58 = 0.0833333333333333d0*x57
      x59 = x55*x58
      x60 = x4*x59
      x61 = exp(-x8)
      x62 = mu*x61
      x63 = 1.77245385090552d0
      x64 = mu**3
      x65 = 0.825481812223657d0*x28
      x66 = -x25*x65 + x33*x63 + x59*x64
      x67 = 0.275160604074552d0*x25
      x68 = x28*x67
      x69 = x68*(x62*(x54 - x60) + x66) - 0.375d0
      x70 = x52*x69
      x71 = rho_b**1.33333333333333d0
      x72 = rho_b**0.666666666666667d0
      x73 = x7*x72
      x74 = exp(x73)
      x75 = 3.0d0*x74
      x76 = 1d0/x71
      x77 = x74 - 1.0d0
      x78 = x76*x77
      x79 = x75 - 2.0d0
      x80 = 1d0/x72
      x81 = x22*x80
      x82 = rho_b**0.333333333333333d0
      x83 = 1d0/x82
      x84 = erf(x32*x82)
      x85 = x74*x84
      x86 = x15*x78 + x29*x83*x85 - x75 - 0.60570686427738d0*x79*x81
      x87 = 1d0/x86
      x88 = x37*x78
      x89 = 7.0d0*x74 + 11.0d0
      x90 = 0.00280419844572861d0*x81*x89
      x91 = -x88 + x90 + 0.0185185185185185d0
      x92 = rho_b**(-2.0d0)
      x93 = x43*x92
      x94 = x91*x93
      x95 = x87*x94
      x96 = exp(-x47*x80)
      x97 = sigma_bb*x96
      x98 = -x95*x97 + 1.0d0
      x99 = 1d0/x98
      x100 = 1.804d0 - 0.804d0*x99
      x101 = x53*x83
      x102 = 1d0/rho_b
      x103 = x102*x58
      x104 = x103*x4
      x105 = exp(-x73)
      x106 = mu*x105
      x107 = x103*x64 + x63*x84 - x65*x83
      x108 = 0.275160604074552d0*x83
      x109 = x108*x28
      x110 = x109*(x106*(x101 - x104) + x107) - 0.375d0
      x111 = x100*x110
      x112 = rho_a**0.333333333333333d0
      x113 = 4.84565491421904d0*x0
      x114 = -x54 + x60
      x115 = -x114*x62 + x66
      x116 = 0.275160604074552d0*x28
      x117 = x42*x58
      x118 = 1.21141372855476d0*x31
      x119 = rho_a**(-0.666666666666667d0)
      x120 = x119*x61
      x121 = 0.183440402716368d0*x27
      x122 = x117*x4 - x121*x16
      x123 = x3*x30
      x124 = 2.20128483259642d0*x123
      x125 = rho_a**(-0.333333333333333d0)
      x126 = x125*x61
      x127 = x114*x124*x126 + x116*x16 - x117*x64 + x118*x120 + x122*x62
     &
      x128 = 0.0917202013581841d0*x115*x16 - x127*x67
      x129 = x128*x52
      x130 = 0.318309886183791d0
      x131 = mu*x130
      x132 = 3.63424118566428d0*x131
      x133 = x1*x132
      x134 = x38 - x40 - 0.0185185185185185d0
      x135 = rho_a**(-3.66666666666667d0)
      x136 = 3.02993180261165d0*x21
      x137 = x135*x136
      x138 = rho_a**(-3.0d0)
      x139 = 6.31870381979104d0*x5
      x140 = x138*x139
      x141 = x55*x9
      x142 = 0.0432098765432099d0*x141
      x143 = rho_a**(-1.66666666666667d0)
      x144 = x143*x22
      x145 = x144*x9
      x146 = 0.0336503813487433d0*x145
      x147 = 0.0203822669684853d0*x14
      x148 = rho_a**(-2.33333333333333d0)
      x149 = x148*x17
      x150 = x147*x149
      x151 = 0.00186946563048574d0*x144*x39
      x152 = -x142 + x146 - x150 + x151
      x153 = 0.564189583547756d0
      x154 = 4.72654360241471d0*x153
      x155 = 6.60385449778925d0*x6
      x156 = x155*x9
      x157 = 0.244587203621824d0*x14
      x158 = x144*x19
      x159 = 1.30055859282514d0*x28
      x160 = x16*x34
      x161 = 8.58869971286677d0*x31
      x162 = x119*x9
      x163 = x162*x33
      x164 = x125*x156 + 4.0d0*x141 - 0.40380457618492d0*x145 + x149*x15
     &7 - x154*x55 - 0.40380457618492d0*x158 + x159*x160 - x161*x163
      x165 = x164*x36
      x166 = x165*x44
      x167 = x36/x50**2
      x168 = x167*x49
      x169 = 2.92192991327408d0*x0
      x170 = x1*x169
      x171 = x168*x170
      x172 = rho_b**0.333333333333333d0
      x173 = -x101 + x104
      x174 = -x106*x173 + x107
      x175 = x58*x92
      x176 = rho_b**(-0.666666666666667d0)
      x177 = x105*x176
      x178 = -x121*x76 + x175*x4
      x179 = rho_b**(-0.333333333333333d0)
      x180 = x105*x179
      x181 = x106*x178 + x116*x76 + x118*x177 + x124*x173*x180 - x175*x6
     &4
      x182 = -x108*x181 + 0.0917202013581841d0*x174*x76
      x183 = x100*x182
      x184 = x132*x71
      x185 = x88 - x90 - 0.0185185185185185d0
      x186 = rho_b**(-3.66666666666667d0)
      x187 = x136*x186
      x188 = rho_b**(-3.0d0)
      x189 = x139*x188
      x190 = x102*x74
      x191 = 0.0432098765432099d0*x190
      x192 = rho_b**(-1.66666666666667d0)
      x193 = x192*x22
      x194 = x193*x74
      x195 = 0.0336503813487433d0*x194
      x196 = rho_b**(-2.33333333333333d0)
      x197 = x196*x77
      x198 = x147*x197
      x199 = 0.00186946563048574d0*x193*x89
      x200 = -x191 + x195 - x198 + x199
      x201 = x155*x74
      x202 = x193*x79
      x203 = x76*x85
      x204 = x176*x74
      x205 = x204*x84
      x206 = -x102*x154 + x157*x197 + x159*x203 - x161*x205 + x179*x201 
     &+ 4.0d0*x190 - 0.40380457618492d0*x194 - 0.40380457618492d0*x202
      x207 = x206*x87
      x208 = x207*x93
      x209 = x87/x98**2
      x210 = x209*x97
      x211 = x169*x71
      x212 = x210*x211
      x213 = x115*x68 - 0.375d0
      x214 = x119*x213
      x215 = x41*x48
      x216 = x0*x5
      x217 = 9.23140485208332d0*x216
      x218 = x109*x174 - 0.375d0
      x219 = x176*x218
      x220 = x91*x96
      x221 = 1.61521830473968d0*x0
      x222 = 9.69130982843808d0*x131
      x223 = 0.366880805432736d0*x28
      x224 = 0.166666666666667d0*x57
      x225 = x138*x224
      x226 = rho_a**(-1.66666666666667d0)
      x227 = 0.80760915236984d0*x31
      x228 = 1d0/x64
      x229 = x228*x56
      x230 = 2.66666666666667d0*x229
      x231 = 0.244587203621824d0*x27
      x232 = rho_a**(-1.33333333333333d0)
      x233 = 0.733761610865473d0*x123
      x234 = 4.40256966519284d0*x123
      x235 = 4.84565491421904d0*x11*x228
      x236 = 7.79181310206421d0*x0
      x237 = x142 - x146 + x150 - x151
      x238 = -x137*x41 + x140*x41 - x166*x41 - x237*x44
      x239 = x213*x238
      x240 = 5.84385982654816d0*x131
      x241 = x21*x41
      x242 = 6.0598636052233d0*x135
      x243 = x241*x242
      x244 = 12.6374076395821d0*x5
      x245 = x138*x244
      x246 = x245*x41
      x247 = x139*x42
      x248 = x237*x247
      x249 = x165*x247
      x250 = x35**(-2)
      x251 = 2.87710760531755d0*x22
      x252 = exp(-x20*x251)
      x253 = x250*x252/x50**3
      x254 = 18.9561114593731d0*x5
      x255 = 2.90581327762917d0*x12*x4
      x256 = x21*x242
      x257 = x42*x9
      x258 = rho_a**(-2.66666666666667d0)*x22
      x259 = x258*x9
      x260 = x6*x9
      x261 = 0.0475586229264658d0*x14
      x262 = rho_a**(-3.33333333333333d0)*x17
      x263 = 6.30205813655294d0*x153
      x264 = 27.0091844287146d0*x5
      x265 = 1d0/x13
      x266 = 14.5369647426571d0*x11*x265
      x267 = 0.57070347511759d0*x14
      x268 = 1.73407812376686d0*x28
      x269 = x31*x34
      x270 = 18.9061744096588d0*x229
      x271 = 9.45308720482942d0*x153
      x272 = 0.489174407243648d0*x14
      x273 = 2.60111718565028d0*x28
      x274 = 17.1773994257335d0*x31
      x275 = x188*x224
      x276 = rho_b**(-1.66666666666667d0)
      x277 = rho_b**(-1.33333333333333d0)
      x278 = x191 - x195 + x198 - x199
      x279 = -x187*x91 + x189*x91 - x208*x91 - x278*x93
      x280 = x218*x279
      x281 = x21*x91
      x282 = 6.0598636052233d0*x186
      x283 = x281*x282
      x284 = x188*x244
      x285 = x284*x91
      x286 = x139*x92
      x287 = x278*x286
      x288 = x207*x286
      x289 = x86**(-2)
      x290 = exp(-x251*x80)
      x291 = x289*x290/x98**3
      x292 = x21*x282
      x293 = x74*x92
      x294 = rho_b**(-2.66666666666667d0)*x22
      x295 = x294*x74
      x296 = x6*x74
      x297 = rho_b**(-3.33333333333333d0)*x77
      x298 = x31*x85
      x299 = 1.31377056396632d0
      x300 = x215*x69
      x301 = 6.15426990138888d0*x216
      x302 = 9.23140485208332d0*x119
      x303 = x216*x302
      x304 = x303*x69
      x305 = x130*x30
      x306 = 58.3305131008965d0*x0*x265
      x307 = x110*x220
      x308 = 9.23140485208332d0*x176
      x309 = x216*x308
      x310 = x110*x309
      E = 3.63424118566428d0*x0*(x1*x70 + x111*x71)/(rho_a + rho_b)
      d1E(1) = x112*x113*x70 - x129*x133 + x171*x69*(x134*x137 - x134*x1
     &40 + x134*x166 + x152*x44)
      d1E(2) = x110*x212*(x185*x187 - x185*x189 + x185*x208 + x200*x93) 
     &+ x111*x113* x172 - x183*x184
      d1E(3) = -x167*x214*x215*x217
      d1E(4) = 0
      d1E(5) = -x209*x217*x219*x220
      d2E(1) = -sigma_aa**2*x170*x239*x253*(-x243 + x246 - x248 - x249*x
     &41) - x1*x128* x168*x238*x240 - x112*x129*x222 + x112*x168*x236*x2
     &39 + x133*x52* (0.122293601810912d0*x115*x148 - 0.183440402716368d
     &0*x127*x16 + x67*(-x114*x120*x235 - x114*x232*x233*x61 - x122*x126
     &*x234 - x148 *x223 + x225*x64 - x226*x227*x61 - x230*x55*x61 - x62
     &*(-x148*x231 + x225*x4))) + x171*x213*(-rho_a**(-5.33333333333333d
     &0)*x255*x41 + 17.1696135481327d0*rho_a**(-4.66666666666667d0)*x241
     & - rho_a**( -4.0d0)*x254*x41 - x164*x250*x45*(13.2077089955785d0*x
     &125*x260 + 8.0d0*x141 - 0.80760915236984d0*x145 + x149*x272 - 0.80
     &760915236984d0*x158 + x160*x273 - x163*x274 - x271*x55) - x165*x24
     &3 + x165*x246 - x165*x248 + x237*x245 - x237*x256 - x44*( 0.095117
     &2458529316d0*x232*x260 - 0.146090534979424d0*x257 + 0.003115776050
     &80957d0*x258*x39 + 0.10095114404623d0*x259 - x261* x262) - x46*(-x
     &141*x270*x33 + 2.86289990428892d0*x143*x269 - x148 *x268*x34 + x15
     &6*x232 + x162*x266 + 0.673007626974866d0*x19*x258 + 5.725799808577
     &85d0*x226*x269 - x232*x264 - 7.55555555555556d0* x257 + 1.21141372
     &855476d0*x259 - x262*x267 + x263*x42)) + x214* x221*x52
      d2E(2) = 0
      d2E(3) = -sigma_bb**2*x211*x280*x291*(-x283 + x285 - x287 - x288*x
     &91) + x100*x184 *(x108*(-x102*x105*x230 - x105*x173*x233*x277 - x1
     &05*x227*x276 - x106*(-x196*x231 + x275*x4) - x173*x177*x235 - x178
     &*x180*x234 - x196*x223 + x275*x64) + 0.122293601810912d0*x174*x196
     & - 0.183440402716368d0*x181*x76) + x100*x219*x221 - x172*x183*x222
     & + x172*x210*x236*x280 - x182*x210*x240*x279*x71 + x212*x218*(-rho
     &_b **(-5.33333333333333d0)*x255*x91 + 17.1696135481327d0*rho_b**( 
     &-4.66666666666667d0)*x281 - rho_b**(-4.0d0)*x254*x91 - x206*x289* 
     &x94*(-x102*x271 + 13.2077089955785d0*x179*x296 + 8.0d0*x190 - 0.80
     &760915236984d0*x194 + x197*x272 - 0.80760915236984d0*x202 + x203*x
     &273 - x205*x274) - x207*x283 + x207*x285 - x207*x287 + x278 *x284 
     &- x278*x292 - x93*(-x261*x297 + 0.0951172458529316d0*x277* x296 - 
     &0.146090534979424d0*x293 + 0.00311577605080957d0*x294*x89 + 0.1009
     &5114404623d0*x295) - x95*(-x190*x270*x84 + 2.86289990428892d0*x192
     &*x298 - x196*x268*x85 + x201*x277 + x204* x266 + x263*x92 - x264*x
     &277 - x267*x297 + 5.72579980857785d0*x276 *x298 - 7.55555555555556
     &d0*x293 + 0.673007626974866d0*x294*x79 + 1.21141372855476d0*x295))
     &
      d2E(4) = x167*(sigma_aa*x252*x304*x36*x41*x51*(-x134*x245 + x134*x
     &249 + x134*x256 + x152*x247) + x128*x215*x302*x305 - x148*x299*x30
     &0 - x165*x300* x303 + x226*x300*x301 - x237*x304*x48)
      d2E(5) = 0
      d2E(6) = -rho_a**(-2.66666666666667d0)*x213*x253*x306*x41**2
      d2E(7) = 0
      d2E(8) = 0
      d2E(9) = 0
      d2E(10) = 0
      d2E(11) = 0
      d2E(12) = x209*(sigma_bb*x290*x310*x87*x91*x99*(-x185*x284 + x185*
     &x288 + x185*x292 + x200*x286) + x182*x220*x305*x308 - x196*x299*x3
     &07 - x207*x307* x309 + x276*x301*x307 - x278*x310*x96)
      d2E(13) = 0
      d2E(14) = 0
      d2E(15) = -rho_b**(-2.66666666666667d0)*x218*x291*x306*x91**2
      end subroutine


C*****************************************************************************
      pure subroutine D2ESRX_SPIN_PBE_GWS_ERF_case_3(rho_a, rho_b, sigma
     &_aa, sigma_ab, sigma_bb, mu, E, d1E, d2E)
C*****************************************************************************
C   Implemented by YingXing Cheng.
C
C   Subroutine generated using Sympy 1.4
C   Generated: January 16, 2022
C*****************************************************************************
      implicit none
      real*8, intent(in) :: rho_a, rho_b, sigma_aa, sigma_ab, sigma_bb, 
     &mu
      real*8, intent(out) :: E, d1E(9), d2E(45)
      real*8 :: x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x
     &13, x14, x15, x16, x17, x18, x19, x20, x21, x22, x23, x24, x25, x2
     &6, x27, x28, x29, x30, x31, x32, x33, x34, x35, x36, x37, x38, x39
     &, x40, x41, x42, x43, x44, x45, x46, x47, x48, x49, x50, x51, x52,
     & x53, x54, x55, x56, x57, x58, x59, x60, x61, x62, x63, x64, x65, 
     &x66, x67, x68, x69, x70, x71, x72, x73, x74, x75, x76, x77, x78, x
     &79, x80, x81, x82, x83, x84, x85, x86, x87, x88, x89, x90, x91, x9
     &2, x93, x94, x95, x96, x97, x98, x99, x100, x101, x102, x103, x104
     &, x105, x106, x107
      E = 0.0d0
      d1E(:) = 0.0d0
      d2E(:) = 0.0d0
      x0 = rho_a**2.0d0
      x1 = rho_a**(-2.66666666666667d0)
      x2 = mu**2
      x3 = 1d0/x2
      x4 = 4.60115111447049d0
      x5 = 1d0/x4
      x6 = x3*x5
      x7 = 0.239205142311446d0*x6
      x8 = x1*x7
      x9 = rho_a**0.666666666666667d0
      x10 = 0.183440402716368d0*x4
      x11 = x10*x9
      x12 = 21.1705915781930d0
      x13 = x12*x3
      x14 = 0.010095114404623d0*x13
      x15 = rho_a**1.33333333333333d0*x14
      x16 = 97.4090910340024d0
      x17 = mu**(-4)
      x18 = x16*x17
      x19 = 0.147857142857143d0*x18
      x20 = x0*x19
      x21 = -x11 + x15 + x20
      x22 = 1d0/x9
      x23 = x2*x5
      x24 = 1.43855380265878d0*x23
      x25 = exp(-x22*x24)
      x26 = x21*x25
      x27 = sigma_aa*x26*x8
      x28 = 1.0d0 - x27
      x29 = 1d0/x28
      x30 = 1.804d0 - 0.804d0*x29
      x31 = rho_b**2.0d0
      x32 = rho_b**(-2.66666666666667d0)
      x33 = x32*x7
      x34 = rho_b**0.666666666666667d0
      x35 = x10*x34
      x36 = rho_b**1.33333333333333d0*x14
      x37 = x19*x31
      x38 = -x35 + x36 + x37
      x39 = 1d0/x34
      x40 = exp(-x24*x39)
      x41 = x38*x40
      x42 = sigma_bb*x33*x41
      x43 = 1.0d0 - x42
      x44 = 1d0/x43
      x45 = 1.804d0 - 0.804d0*x44
      x46 = 3.14159265358979d0*x3
      x47 = rho_a**1.0d0
      x48 = 1d0/x12
      x49 = 0.229406311391776d0*x48
      x50 = rho_a**(-4.33333333333333d0)
      x51 = x11 - x15 - x20
      x52 = x50*x51
      x53 = 0.637880379497189d0*x6
      x54 = rho_a**(-3.66666666666667d0)
      x55 = x51*x54
      x56 = 0.122293601810912d0*x4
      x57 = rho_a**(-0.333333333333333d0)*x56
      x58 = 0.0134601525394973d0*x13
      x59 = rho_a**0.333333333333333d0*x58
      x60 = 0.295714285714286d0*x18
      x61 = x47*x60
      x62 = x57 - x59 - x61
      x63 = x49*x52 - x53*x55 + x62*x8
      x64 = 0.402d0*x0*x63
      x65 = x28**(-2)
      x66 = sigma_aa*x25*x65
      x67 = rho_b**1.0d0
      x68 = rho_b**(-4.33333333333333d0)
      x69 = x35 - x36 - x37
      x70 = x68*x69
      x71 = rho_b**(-3.66666666666667d0)
      x72 = x69*x71
      x73 = rho_b**(-0.333333333333333d0)*x56
      x74 = rho_b**0.333333333333333d0*x58
      x75 = x60*x67
      x76 = x73 - x74 - x75
      x77 = x33*x76 + x49*x70 - x53*x72
      x78 = 0.402d0*x31*x77
      x79 = x43**(-2)
      x80 = sigma_bb*x40*x79
      x81 = rho_a**(-0.666666666666667d0)
      x82 = x27 - 1.0d0
      x83 = 0.682784063255296d0
      x84 = 0.0961604672092013d0*x17*x83
      x85 = rho_b**(-0.666666666666667d0)
      x86 = x42 - 1.0d0
      x87 = 1.60584417974243d0*x48
      x88 = 0.458812622783553d0*x48
      x89 = 0.0407645339369707d0*x4
      x90 = 0.00448671751316577d0*x13
      x91 = 0.220008881071042d0*x2/x16
      x92 = 2.33889472482303d0*x6
      x93 = x6*x62
      x94 = 1.27576075899438d0*x6
      x95 = 2.87710760531755d0*x23
      x96 = exp(-x22*x95)
      x97 = x96*(0.478410284622892d0*x1*x93 + x52*x88 - x55*x94)
      x98 = exp(-x39*x95)
      x99 = x98*(0.478410284622892d0*x32*x6*x76 + x70*x88 - x72*x94)
      x100 = 0.148394183600699d0
      x101 = 0.0922213371794941d0*x100
      x102 = x3*x83
      x103 = 0.0641069781394675d0*x102
      x104 = 0.0961604672092013d0*x102
      x105 = x104*x81
      x106 = 0.0460041564870242d0*x100/mu**6
      x107 = x104*x85
      E = -0.5d0*x46*(x0*x30 + x31*x45)/(rho_a + rho_b)
      d1E(1) = -x46*(1.0d0*x30*x47 + x64*x66)
      d1E(2) = -x46*(1.0d0*x45*x67 + x78*x80)
      d1E(3) = x26*x81*x84/x82**2
      d1E(4) = 0
      d1E(5) = x41*x84*x85/x86**2
      d2E(1) = x46*(sigma_aa**2*x64*x97/x28**3 - 0.402d0*x0*x66*(rho_a**
     &(-6.0d0)*x51* x91 - rho_a**(-5.33333333333333d0)*x51*x87 + rho_a**
     &( -4.66666666666667d0)*x51*x92 + x50*x62*x88 - 1.27576075899438d0*
     & x54*x93 - x8*(rho_a**(-1.33333333333333d0)*x89 + rho_a**( -0.6666
     &66666666667d0)*x90 + x60)) + 0.804d0*x29 - 1.608d0*x47*x63 *x66 - 
     &1.804d0)
      d2E(2) = 0
      d2E(3) = x46*(sigma_bb**2*x78*x99/x43**3 - 0.402d0*x31*x80*(rho_b*
     &*(-6.0d0)*x69* x91 - rho_b**(-5.33333333333333d0)*x69*x87 + rho_b*
     &*( -4.66666666666667d0)*x69*x92 - x33*(rho_b**(-1.33333333333333d0
     &)* x89 + rho_b**(-0.666666666666667d0)*x90 + x60) + x68*x76*x88 - 
     &x71*x76*x94) + 0.804d0*x44 - 1.608d0*x67*x77*x80 - 1.804d0)
      d2E(4) = x3*x65*(rho_a**(-2.33333333333333d0)*x101*x26 - rho_a**( 
     &-1.66666666666667d0)*x103*x26 - sigma_aa*x105*x21*x29*x97 + x105* 
     &x25*(-x57 + x59 + x61))
      d2E(5) = 0
      d2E(6) = -rho_a**(-3.33333333333333d0)*x106*x21**2*x96/x82**3
      d2E(7) = 0
      d2E(8) = 0
      d2E(9) = 0
      d2E(10) = 0
      d2E(11) = 0
      d2E(12) = x3*x79*(rho_b**(-2.33333333333333d0)*x101*x41 - rho_b**(
     & -1.66666666666667d0)*x103*x41 - sigma_bb*x107*x38*x44*x99 + x107*
     & x40*(-x73 + x74 + x75))
      d2E(13) = 0
      d2E(14) = 0
      d2E(15) = -rho_b**(-3.33333333333333d0)*x106*x38**2*x98/x86**3
      end subroutine
